- name: Deploy to Server
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            # Create temp directory
            mkdir -p ~/temp_deploy
            
      - name: Copy files
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          source: "dist/*"
          target: "~/temp_deploy/"
          strip_components: 1
          
      - name: Deploy and Set Permissions
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            # Remove old files
            rm -rf ${{ secrets.DEPLOY_PATH }}/*
            
            # Copy new files
            cp -r ~/temp_deploy/* ${{ secrets.DEPLOY_PATH }}/
            
            # Set permissions
            cd ${{ secrets.DEPLOY_PATH }}
            chown -R thafheem:thafheem .
            find . -type d -exec chmod 755 {} \;
            find . -type f -exec chmod 644 {} \;
            
            # Cleanup
            rm -rf ~/temp_deploy
