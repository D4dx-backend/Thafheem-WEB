import{g as Ht,r as f,v as Yt,ae as Kt,j as g,N as qt,t as Jt,af as F,K as D,J as vt,y as Nt,A as Gt}from"./index-DwV6Sgdl.js";import{W as Qt,A as Xt}from"./WordByWord-Bt_DhbBw.js";import{I as Zt}from"./InterpretationNavbar-CR1WEWqw.js";import bt from"./hindiTranslationService-BzIxfkHD.js";import kt from"./urduTranslationService-BOrLzMVt.js";import wt from"./englishTranslationService-DXza466L.js";const se=({surahId:U,range:z,interpretationNo:H=1,language:Y="en",footnoteId:K=null,onClose:St})=>{const{user:$t}=Ht?.()||{user:null},[rt,at]=f.useState(!0),[q,J]=f.useState(null),[R,_]=f.useState([]),[ot,st]=f.useState(""),[G,it]=f.useState(!1),[ct,P]=f.useState({id:"",content:null}),[Q,T]=f.useState(!1),[W,M]=f.useState({surahId:null,verseId:null}),lt=f.useRef([]),[Et,dt]=f.useState(!1),[At,Ct]=f.useState([]),[C,pt]=f.useState([]),[p,ut]=f.useState(U),[l,j]=f.useState(z),[u,$]=f.useState(H),[a,Bt]=f.useState(Y),[k,X]=f.useState(K),[A,ft]=f.useState([]),[Z,jt]=f.useState(!1),ht=f.useRef(!1);f.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),f.useEffect(()=>{ut(U),j(z),$(H),Bt(Y),X(K)},[U,z,H,Y,K]);const tt=e=>{e&&(e.preventDefault(),e.stopPropagation()),!ht.current&&(ht.current=!0,jt(!0),setTimeout(()=>{St()},200))};f.useEffect(()=>{p&&(async()=>{try{const n=await Jt();Ct(n.map(c=>({value:c.id,label:`${c.id}- ${c.english||"Surah"}`})));const t=n.find(c=>c.id===Number(p));st(`${p}- ${t?.english||"Surah"}`)}catch{st(`${p}- Surah`)}})()},[p]),f.useEffect(()=>{let e=!0;return(async()=>{try{const n=await Yt();if(!e)return;const c=n.find(o=>o.number===Number(p))?.ayahs||286,I=Array.from({length:c},(o,r)=>String(r+1));pt(I)}catch{e&&pt(Array.from({length:50},(t,c)=>String(c+1)))}})(),()=>{e=!1}},[p]),f.useEffect(()=>{(async()=>{if(!(!p||!l))try{at(!0),J(null),_([]);let n;if(a==="mal")if(/^\d+$/.test(l)){const r=await F(p,parseInt(l,10),"mal");if(u&&r.length>0){const i=r.filter(d=>d.InterpretationNo===String(u)||d.interptn_no===u);n=i.length>0?i:[r[0]]}else n=r}else n=await D(p,l,u,"mal");else if(a==="hi")if(/^\d+$/.test(l)){const r=await bt.getExplanation(p,parseInt(l,10));n=r&&r!=="N/A"?[{Interpretation:r,AudioIntrerptn:r,text:r,content:r,InterpretationNo:u}]:[]}else{const[r,i]=l.split("-").map(s=>parseInt(s.trim(),10));n=(await bt.fetchBlockwiseHindi(p,r,i)).map(s=>({Interpretation:s.explanation,AudioIntrerptn:s.explanation,text:s.explanation,content:s.explanation,InterpretationNo:u,ayah:s.ayah}))}else if(a==="ur")if(/^\d+$/.test(l)){const r=await kt.getExplanation(p,parseInt(l,10));n=r&&r!=="N/A"?[{Interpretation:r,AudioIntrerptn:r,text:r,content:r,InterpretationNo:u}]:[]}else{const[r,i]=l.split("-").map(s=>parseInt(s.trim(),10));n=(await kt.fetchBlockwiseUrdu(p,r,i)).map(s=>({Interpretation:s.translation,AudioIntrerptn:s.translation,text:s.translation,content:s.translation,InterpretationNo:u,ayah:s.ayah}))}else if(a==="E"||a==="en")if(k)try{const o=await wt.getExplanation(parseInt(k,10));n=o&&o!=="N/A"?[{Interpretation:o,AudioIntrerptn:o,text:o,content:o,InterpretationNo:String(u),footnoteId:k}]:[]}catch(o){throw console.error("[BlockInterpretationModal] ❌ Error fetching English footnote:",{error:o,message:o?.message,footnoteId:k}),o}else{const o=/^\d+$/.test(l),r="E";try{o?n=await vt(p,parseInt(l,10),u,r):n=await D(p,l,u,r)}catch(i){throw console.error("[BlockInterpretationModal] ❌ Error fetching interpretation:",{error:i,message:i?.message,surahId:p,range:l,interpretationNo:u,langCode:r}),i}}else{const o=/^\d+$/.test(l),r=a;try{o?n=await vt(p,parseInt(l,10),u,r):n=await D(p,l,u,r)}catch(i){throw console.error("[BlockInterpretationModal] ❌ Error fetching interpretation:",i),i}}const t=Array.isArray(n)?n:n?[n]:[];if(!(t.length>0&&t[0]&&(t[0].Interpretation&&t[0].Interpretation!==""&&t[0].Interpretation!==null&&t[0].Interpretation!==void 0||t[0].InterpretationText&&t[0].InterpretationText!==""&&t[0].InterpretationText!==null&&t[0].InterpretationText!==void 0||t[0].interpret_text&&t[0].interpret_text!==""&&t[0].interpret_text!==null&&t[0].interpret_text!==void 0||t[0].text&&t[0].text!==""&&t[0].text!==null&&t[0].text!==void 0))){console.warn(`[BlockInterpretationModal] ⚠️ No interpretation ${u} available for range ${l}`,{language:a,items:t});const o=l.match(/^(\d+)(?:-(\d+))?$/),r=o?parseInt(o[1],10):null,i=o&&o[2]?parseInt(o[2],10):r,d=r===i;let s=!1;if(r&&(a==="mal"||a==="E"||a==="en"))try{if(d){const h=await F(p,r,a==="E"||a==="en"?"E":"mal");if(h&&h.length>0){const b=(S,N)=>{const x=[S.InterpretationNo,S.interpretationNo,S.interptn_no,S.resolvedInterpretationNo,N+1];for(const B of x){const E=parseInt(String(B),10);if(!isNaN(E)&&E>=1&&E<=20)return E}return N+1<=20?N+1:1};let y=h.find((S,N)=>b(S,N)===u);y||(y=h[0]);const v=h.indexOf(y),w=b(y,v);$(w),_([y]),s=!0;return}}else{const h=await F(p,r,a==="E"||a==="en"?"E":"mal");if(h&&h.length>0){const b=(y,v)=>{const w=[y.InterpretationNo,y.interpretationNo,y.interptn_no,y.resolvedInterpretationNo,v+1];for(const S of w){const N=parseInt(String(S),10);if(!isNaN(N)&&N>=1&&N<=20)return N}return v+1<=20?v+1:1};for(let y=0;y<h.length;y++){const v=h[y],w=b(v,y);try{const N=await D(p,l,w,a==="E"||a==="en"?"E":"mal"),x=Array.isArray(N)?N:[N];if(x.length>0&&x[0]&&Object.keys(x[0]).length>0&&(x[0].Interpretation||x[0].interpret_text||x[0].text||"").trim()!==""){$(w),_(x),s=!0;return}}catch{continue}}}}}catch(m){console.warn("Failed to check available interpretations:",m)}if(!s)if(u!==1){$(1);return}else J(`No interpretation available for verses ${l}.`),_([])}else _(t)}catch(n){console.error(`[BlockInterpretationModal] ❌ Failed to load interpretation ${u}:`,{error:n,message:n?.message,stack:n?.stack,surahId:p,range:l,interpretationNo:u,language:a});let t="Failed to load interpretation";n.message?.includes("500")?t=`Server error loading interpretation ${u}. Please try again later.`:n.message?.includes("404")?t=`Interpretation ${u} not found for this selection.`:n.message?.includes("network")||n.message?.includes("fetch")?t="Network error. Please check your connection.":t=`Interpretation ${u} is not available.`,J(t)}finally{at(!1)}})()},[p,l,u,a,k]);const V=()=>{lt.current.forEach(e=>{if(!e)return;e.querySelectorAll("sup, a").forEach(t=>{const c=(t.innerText||t.textContent||"").trim();c&&(t.style.removeProperty("color"),t.style.removeProperty("text-decoration"),t.style.removeProperty("cursor"),t.style.removeProperty("font-weight"),/^N\d+$/.test(c)?(t.setAttribute("data-type","note"),t.setAttribute("data-value",c),t.onclick=nt):(/^\(?\d+\s*[:：]\s*\d+\)?$/.test(c)||/^\d+\s*[:：]\s*\d+$/.test(c)||/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*\d+\s+\d+:\d+/.test(c)||/സൂക്തം:\s*\d+\s+\d+:\d+/.test(c))&&(t.setAttribute("data-type","verse"),t.setAttribute("data-value",c),t.onclick=nt))})})};f.useEffect(()=>{R.length>0&&(V(),setTimeout(V,100))},[R]),f.useEffect(()=>{!G&&!Q&&R.length>0&&(V(),setTimeout(V,100))},[G,Q]);const Tt=e=>({N895:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N895</h3>
          <p>ലാത്ത് - ഇത് ഒരു പ്രാചീന അറബ് ദേവതയുടെ പേരാണ്. ഇസ്ലാമിന് മുമ്പുള്ള അറേബ്യയിൽ ഈ ദേവതയെ ആരാധിച്ചിരുന്നു.</p>
          <p>ഖുർആനിൽ ഈ ദേവതയെ പരാമർശിക്കുന്നത് ബഹുദൈവവാദത്തിന്റെ തെറ്റിനെ വിശദീകരിക്കാനാണ്.</p>
        </div>
      `,N189:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N189</h3>
          <p>ഉസ്സ - ഇതും ഒരു പ്രാചീന അറബ് ദേവതയാണ്. ലാത്ത്, ഉസ്സ, മനാത് എന്നിവ മക്കയിലെ പ്രധാന ദേവതകളായിരുന്നു.</p>
          <p>ഇവയെ "അല്ലാഹുവിന്റെ പുത്രിമാർ" എന്ന് അവർ വിളിച്ചിരുന്നു.</p>
        </div>
      `})[e]||null,et=async e=>{P({id:e,content:"Loading..."}),it(!0);const n=Tt(e);n&&P({id:e,content:n});try{const t=await Gt(e),c=t?.NoteText||t?.content||t?.html||t?.text||t?.body||t?.description||t?.note||(typeof t=="string"?t:null);c&&c!=="Note content not available"&&P({id:e,content:c})}catch(t){!t.message?.includes("500")&&!t.message?.includes("Network error")&&console.warn(`Failed to fetch note ${e}:`,t.message),n||P({id:e,content:`
            <div class="note-content">
              <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note ${e}</h3>
              <p style="color: #666;">Note content is temporarily unavailable. Please try again later.</p>
            </div>
          `})}},nt=e=>{e.preventDefault(),e.stopPropagation();const n=e.target,t=n.getAttribute("data-type"),c=n.getAttribute("data-value"),I=n.innerText||n.textContent||"";if(!I)return;if(t==="verse"||t==="range"){const i=c||I,d=i.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||i.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(d){const[,m,h]=d;M({surahId:parseInt(m,10),verseId:parseInt(h,10)}),T(!0);return}const s=i.match(/^\(?(\d+)\s*[:：]\s*(\d+)\)?$/);if(s){const[,m,h]=s;M({surahId:parseInt(m,10),verseId:parseInt(h,10)}),T(!0);return}}else if(t==="note"){et(c||I);return}const o=I.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||I.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(o){const[,i,d]=o;M({surahId:parseInt(i,10),verseId:parseInt(d,10)}),T(!0);return}const r=I.match(/^\(?(\d+)\s*[:：]\s*(\d+)\)?$/);if(r){const[,i,d]=r;M({surahId:parseInt(i,10),verseId:parseInt(d,10)}),T(!0);return}et(I)},Ft=e=>{const n=e.target;if(n.tagName==="SUP"||n.tagName==="A"){nt(e);return}const t=n.innerText||n.textContent||"",c=t.match(/N(\d+)/);if(c){const r=`N${c[1]}`;et(r);return}const I=t.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||t.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(I){const[,r,i]=I;M({surahId:parseInt(r,10),verseId:parseInt(i,10)}),T(!0);return}const o=t.match(/\(?(\d+)\s*[:：]\s*(\d+)\)?/);if(o){const[,r,i]=o;M({surahId:parseInt(r,10),verseId:parseInt(i,10)}),T(!0);return}},Mt=e=>{ut(parseInt(e,10))},Dt=e=>{j(String(e))},mt=f.useCallback(async(e,n)=>{try{const[t,c]=n.includes("-")?n.split("-").map(o=>parseInt(o.trim(),10)):[parseInt(n,10),parseInt(n,10)],I=[];for(let o=t;o<=c;o++)try{const r=await wt.getAyahTranslation(e,o);if(r){const i=/<sup[^>]*foot_note="([^"]+)"[^>]*>(\d+)<\/sup>/g;let d;for(;(d=i.exec(r))!==null;){const s=d[1],m=parseInt(d[2],10);I.push({footnoteId:s,footnoteNumber:m,ayah:o})}}}catch(r){console.warn(`[BlockInterpretationModal] Failed to fetch translation for ayah ${o}:`,r)}return I.sort((o,r)=>o.ayah!==r.ayah?o.ayah-r.ayah:o.footnoteNumber-r.footnoteNumber),I}catch(t){return console.error("[BlockInterpretationModal] ❌ Error extracting footnotes from range:",t),[]}},[]);f.useEffect(()=>{(a==="E"||a==="en")&&k&&l?(async()=>{const n=await mt(p,l);ft(n)})():ft([])},[p,l,a,k,mt]);const gt=async()=>{if((a==="E"||a==="en")&&k){if(A.length===0){console.warn("[BlockInterpretationModal] ⚠️ No footnotes loaded for range:",l);return}const n=A.findIndex(t=>t.footnoteId===k);if(n>0){const t=A[n-1];X(t.footnoteId),$(t.footnoteNumber);return}return}if(u>1){$(u-1);return}const e=String(l);if(/^\d+$/.test(e)){const n=parseInt(e,10);if(n<=1){alert("Already at the first verse");return}const t=n-1;if(j(String(t)),a==="mal")try{const c=await F(p,t,"mal");if(c&&c.length>0){const I=c[c.length-1],o=(d,s)=>{const m=[d.InterpretationNo,d.interpretationNo,d.interptn_no,d.resolvedInterpretationNo,s+1];for(const h of m){const b=parseInt(String(h),10);if(!isNaN(b)&&b>=1&&b<=20)return b}return s+1<=20?s+1:1},r=c.length-1,i=o(I,r);$(i)}}catch(c){console.warn("Failed to fetch available interpretations for previous verse:",c)}}else if(/^(\d+)-(\d+)$/.test(e)){const n=e.match(/^(\d+)-(\d+)$/);if(n){const[,t,c]=n,I=parseInt(t,10),r=parseInt(c,10)-I+1;if(I<=1){alert("Already at the first block");return}const i=Math.max(1,I-r),d=i+r-1;if(j(`${i}-${d}`),a==="mal")try{const s=await F(p,i,"mal");if(s&&s.length>0){const m=s[s.length-1],h=(v,w)=>{const S=[v.InterpretationNo,v.interpretationNo,v.interptn_no,v.resolvedInterpretationNo,w+1];for(const N of S){const x=parseInt(String(N),10);if(!isNaN(x)&&x>=1&&x<=20)return x}return w+1<=20?w+1:1},b=s.length-1,y=h(m,b);$(y)}}catch(s){console.warn("Failed to fetch available interpretations for previous block:",s)}}}},It=async()=>{if((a==="E"||a==="en")&&k){if(A.length===0){console.warn("[BlockInterpretationModal] ⚠️ No footnotes loaded for range:",l);return}const r=A.findIndex(i=>i.footnoteId===k);if(r>=0&&r<A.length-1){const i=A[r+1];X(i.footnoteId),$(i.footnoteNumber);return}return}const e=u+1,n=l.match(/^(\d+)(?:-(\d+))?$/),t=n?parseInt(n[1],10):null,c=n&&n[2]?parseInt(n[2],10):t,I=t===c;if(t&&a==="mal")try{let r=!1;if(I){const d=await F(p,t,"mal");if(d&&d.length>0){const s=(m,h)=>{const b=[m.InterpretationNo,m.interpretationNo,m.interptn_no,m.resolvedInterpretationNo,h+1];for(const y of b){const v=parseInt(String(y),10);if(!isNaN(v)&&v>=1&&v<=20)return v}return h+1<=20?h+1:1};for(let m=0;m<d.length;m++)if(s(d[m],m)===e){r=!0;break}}}else try{const d=await D(p,l,e,"mal"),s=Array.isArray(d)?d:[d];s.length>0&&s[0]&&Object.keys(s[0]).length>0&&(s[0].Interpretation||s[0].interpret_text||s[0].text||"").trim()!==""&&(r=!0)}catch{r=!1}if(r){$(e);return}const i=String(l);if(/^(\d+)-(\d+)$/.test(i)){const d=i.match(/^(\d+)-(\d+)$/);if(d){const[,s,m]=d,h=parseInt(s,10),b=parseInt(m,10),y=b-h+1,v=C.length>0?parseInt(C[C.length-1],10):286;if(b<v){const w=h+y,S=Math.min(v,w+y-1),N=`${w}-${S}`;try{if(w===S){const x=await F(p,w,"mal");if(x&&x.length>0){const B=(E,O)=>{const Ut=[E.InterpretationNo,E.interpretationNo,E.interptn_no,E.resolvedInterpretationNo,O+1];for(const zt of Ut){const L=parseInt(String(zt),10);if(!isNaN(L)&&L>=1&&L<=20)return L}return O+1<=20?O+1:1};for(let E=0;E<x.length;E++)if(B(x[E],E)===e){j(N),$(e);return}}}else{const x=await D(p,N,e,"mal"),B=Array.isArray(x)?x:[x];if(B.length>0&&B[0]&&Object.keys(B[0]).length>0&&(B[0].Interpretation||B[0].interpret_text||B[0].text||"").trim()!==""){j(N),$(e);return}}}catch{}}}}}catch(r){console.warn("Failed to fetch available interpretations for next:",r)}const o=String(l);if(/^\d+$/.test(o)){const r=parseInt(o,10),i=C.length>0?parseInt(C[C.length-1],10):286;if(r>=i){alert("Already at the last verse of this surah");return}const d=r+1;j(String(d)),$(1)}else if(/^(\d+)-(\d+)$/.test(o)){const r=o.match(/^(\d+)-(\d+)$/);if(r){const[,i,d]=r,s=parseInt(i,10),m=parseInt(d,10),h=m-s+1,b=C.length>0?parseInt(C[C.length-1],10):286;if(m>=b){alert("Already at the last block of this surah");return}const y=s+h,v=Math.min(b,y+h-1);j(`${y}-${v}`),$(1)}}},Rt=async()=>{try{dt(!0);const e=Nt.getEffectiveUserId($t);await Nt.addBlockInterpretationBookmark(e,p,l,ot,u,a),alert(`Saved interpretation for Surah ${p}, verses ${l}`)}catch(e){console.error("Failed to bookmark interpretation",e),alert("Failed to save interpretation bookmark")}finally{setTimeout(()=>dt(!1),300)}},_t=async()=>{const e=`Interpretation ${u} — Surah ${p} • Range ${l}`,n=`${window.location.origin}/interpretation-blockwise?surahId=${p}&range=${l}&ipt=${u}&lang=${a}`;try{navigator.share?await navigator.share({title:document.title||"Thafheem",text:e,url:n}):(await navigator.clipboard.writeText(`${e}
${n}`),alert("Link copied to clipboard"))}catch(t){console.error("Share failed",t),alert("Share failed: "+t.message)}},[Pt,yt]=f.useState(!1),[Wt,xt]=f.useState(1),Vt=()=>{const e=/^\d+/.exec(String(l))?.[0]||"1";xt(parseInt(e)),yt(!0)},Ot=e=>{if(e==null)return"";if(typeof e=="string")return e;const n=["interpret_text","InterpretText","Interpret_Text","interpretation","Interpretation","text","Text","content","Content","meaning","Meaning","body","Body","desc","Desc","description","Description"];for(const t of n)if(typeof e[t]=="string"&&e[t].trim().length>0)return e[t];for(const[t,c]of Object.entries(e))if(typeof c=="string"&&c.trim().length>20)return c;return console.warn("⚠️ No valid interpretation text found in item:",e),`<p class="text-gray-500 italic">No interpretation content available for interpretation ${u}</p>`},Lt=document.getElementById("modal-root")||document.body;return Kt.createPortal(g.jsxs(g.Fragment,{children:[g.jsx("style",{children:`
        /* Entry animations */
        @keyframes backdropFadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }
        @keyframes modalSlideUp {
          from {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }
        @keyframes modalSlideDown {
          from {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
          to {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
          }
        }
        .animate-backdrop-fade-in {
          animation: backdropFadeIn 0.2s ease-out;
        }
        .animate-modal-slide-up {
          animation: modalSlideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .animate-modal-slide-down {
          animation: modalSlideDown 0.2s ease-in;
        }
        
        /* Specific styling for note and verse markers in interpretation content */
        .interpretation-content sup[data-type="note"], 
        .interpretation-content a[data-type="note"],
        .interpretation-content sup[data-type="verse"], 
        .interpretation-content a[data-type="verse"] {
          transition: all 0.2s ease !important;
          color: #2AA0BF !important;
          font-weight: 600 !important;
          cursor: pointer !important;
          text-decoration: none !important;
        }
        
        .interpretation-content sup[data-type="note"]:hover, 
        .interpretation-content a[data-type="note"]:hover,
        .interpretation-content sup[data-type="verse"]:hover, 
        .interpretation-content a[data-type="verse"]:hover {
          color: #1e7a8c !important;
          text-decoration: underline !important;
          transform: scale(1.05) !important;
        }
        
        /* Fallback for elements without data-type but with note/verse patterns */
        .interpretation-content sup:not([data-type]), 
        .interpretation-content a:not([data-type]) {
          color: #2AA0BF !important;
          font-weight: 600 !important;
          cursor: pointer !important;
          text-decoration: none !important;
          transition: all 0.2s ease !important;
        }
        
        .interpretation-content sup:not([data-type]):hover, 
        .interpretation-content a:not([data-type]):hover {
          color: #1e7a8c !important;
          text-decoration: underline !important;
          transform: scale(1.05) !important;
        }
        `}),g.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center",children:[g.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm transition-opacity",onClick:tt,style:{pointerEvents:Z?"none":"auto"}}),g.jsxs("div",{className:`relative w-full ${a==="E"||a==="en"?"sm:w-auto sm:max-w-2xl":"sm:w-auto sm:max-w-4xl xl:max-w-[1073px]"} ${a==="E"||a==="en"?"sm:max-h-[95vh]":"max-h-[85vh] sm:max-h-[90vh]"} bg-white dark:bg-gray-900 rounded-t-2xl sm:rounded-2xl shadow-2xl flex flex-col animate-slideUp sm:animate-fadeIn ${a==="E"||a==="en"?"":"overflow-hidden"} ${Z?"animate-slideDown sm:animate-fadeOut":""}`,onClick:e=>e.stopPropagation(),style:{...a==="E"||a==="en"?{maxWidth:"42rem",minWidth:"min(90vw, 20rem)",height:"auto",maxHeight:"95vh"}:{}},children:[g.jsx("div",{className:"w-full flex justify-center pt-3 pb-1 sm:hidden cursor-grab active:cursor-grabbing",onClick:tt,style:{pointerEvents:Z?"none":"auto"},children:g.jsx("div",{className:"w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full"})}),g.jsx("div",{className:"flex-shrink-0 z-10 bg-white dark:bg-gray-900",children:g.jsx(Zt,{interpretationNumber:u,surahName:ot,verseRange:l.replace(/-/g," - "),language:a,onClose:tt,onBookmark:Rt,onShare:_t,onWordByWord:Vt,bookmarking:Et,surahOptions:At,rangeOptions:C,onPickSurah:Mt,onPickRange:Dt,onPrev:(a==="E"||a==="en")&&k&&A.length>0?A.findIndex(e=>e.footnoteId===k)>0?gt:null:gt,onNext:(a==="E"||a==="en")&&k&&A.length>0?A.findIndex(e=>e.footnoteId===k)<A.length-1?It:null:It,isModal:!0,hideTitle:!!k},`navbar-${p}-${l}-${u}`)}),g.jsxs("div",{className:`${a==="E"||a==="en"?"overflow-y-auto":"flex-1 overflow-y-auto"} px-4 sm:px-6 py-6 sm:py-8 ${a==="E"||a==="en"?"":"min-h-0"}`,style:{...a==="E"||a==="en"?{maxHeight:"calc(95vh - 120px)"}:{}},children:[rt&&g.jsx("div",{className:"flex items-center justify-center py-8",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),g.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading interpretation..."})]})}),q&&g.jsxs("div",{className:"text-center py-8",children:[g.jsx("p",{className:"text-red-500 dark:text-red-400 text-lg mb-2",children:"Failed to load interpretation"}),g.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:q}),g.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Try Again"})]}),!rt&&!q&&R.length===0&&g.jsx("div",{className:"text-center py-10 text-gray-600 dark:text-gray-300",children:"No interpretation found for this selection."}),g.jsx("div",{className:"font-poppins space-y-6 sm:space-y-8",children:R.map((e,n)=>g.jsx("div",{className:"mb-6 sm:mb-8",children:g.jsx("div",{className:"interpretation-content text-gray-700 leading-relaxed dark:text-gray-300 text-sm sm:text-base prose dark:prose-invert max-w-none",ref:t=>lt.current[n]=t,onClick:Ft,style:{pointerEvents:"auto",position:"relative",zIndex:1},dangerouslySetInnerHTML:{__html:Ot(e)}})},`${p}-${l}-${u}-${e?.ID||e?.id||n}`))},`block-${p}-${l}-${u}`)]}),Pt&&g.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-start justify-center z-[100000] pt-24 sm:pt-28 lg:pt-32 p-4 overflow-hidden",children:g.jsx(Qt,{selectedVerse:Wt,surahId:p,onClose:()=>yt(!1),onNavigate:xt,onSurahChange:()=>{}})})]})]}),g.jsx(qt,{isOpen:G,onClose:()=>it(!1),noteId:ct.id,noteContent:ct.content}),Q&&W.surahId&&W.verseId&&g.jsx(Xt,{surahId:W.surahId,verseId:W.verseId,onClose:()=>T(!1),interpretationNo:u,language:a})]}),Lt)};export{se as B};
