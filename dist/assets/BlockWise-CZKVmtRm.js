import{r as n,a as it,b as lt,g as ct,u as dt,d as ut,c as mt,j as e,C as xt,z as ht,P as pt,B as gt,F as ft,n as yt,x as ce,o as bt,p as De,A as wt,v as vt,D as Le}from"./index-pxHnjHjD.js";import{u as kt,T as de}from"./Toast-B6q433qJ.js";import{W as jt}from"./WordByWord-CXIsVNSw.js";import We from"./InterpretationBlockwise-QNcn_kyB.js";import{D as St,B as At,A as ue}from"./darkmode-bismi-Dgb0MGm6.js";import{B as Nt,C as Tt,t as Re}from"./LoadingSkeleton-BEx0oGtV.js";import Et from"./StickyAudioPlayer-D23gumu9.js";import{C as Me}from"./chevron-left-BDDzhXoa.js";import"./tamilWordByWordService-CbdEWK98.js";import"./hindiWordByWordService-C4orOXOT.js";import"./banglaWordByWordService-CbmHEzxM.js";import"./banglaTranslationService-DREVDw9v.js";import"./apiService-uFQGO9bv.js";import"./tamilTranslationService-BXq1lve9.js";import"./hindiTranslationService-TIz5d7Jr.js";import"./urduTranslationService-Devikl1b.js";import"./englishTranslationService-DbBUmdrl.js";import"./NotePopup-DbvEEH89.js";import"./WordByWordIcon-B1kDBx-G.js";import"./volume-x-BJnJqqFB.js";import"./volume-2-O1mrhZ5G.js";import"./skip-forward-DQYe2sNq.js";const la=()=>{const[Ct,Bt]=n.useState("Translation"),[It,$t]=n.useState("Block wise"),[_e,qe]=n.useState(!1),[te,Ue]=n.useState(null),[O,Ve]=n.useState("al-hudaify"),[q,ae]=n.useState(["quran"]),[K,Qe]=n.useState(1),[h,j]=n.useState(null),[Ft,B]=n.useState(null),[b,k]=n.useState(null),[Pt,f]=n.useState(1),[N,w]=n.useState(!1),[U,y]=n.useState(!1),i=n.useRef(null),[me,ze]=n.useState(null),[xe,he]=n.useState(!0),[pe,ge]=n.useState(null),[Dt,Lt]=n.useState([]),[fe,He]=n.useState([]),[re,ye]=n.useState({}),[x,be]=n.useState([]),[Oe,we]=n.useState({}),[V,ve]=n.useState(null),[Ke,se]=n.useState(!1),[ke,X]=n.useState(null),[Xe,G]=n.useState(new Set),Q=n.useRef(!1),[Ge,je]=n.useState(!1),[Wt,Se]=n.useState(!1),[Rt,Mt]=n.useState(!1),I=it(),Ae=lt(),{pathname:Ne}=Ae,{user:z}=ct(),{toasts:ne,removeToast:oe,showSuccess:$,showError:T,showWarning:Te}=kt(),{quranFont:Ye,translationLanguage:u,theme:Je,translationFontSize:Ze,viewType:Y,setViewType:J}=dt(),{surahId:l}=ut();n.useEffect(()=>{if(!(u==="mal"||u==="E")){Y!=="Ayah Wise"&&J("Ayah Wise");return}if(Y==="Ayah Wise"){const a=`/surah/${l}`;Ne!==a&&I(a)}else Y!=="Block Wise"&&J("Block Wise")},[Y,u,l,I,Ne,J]);const Ee=()=>{J("Ayah Wise")},{surahs:ie}=mt(),et=t=>{const a=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];return t.toString().split("").map(r=>a[r]||r).join("")};n.useEffect(()=>(i.current||(i.current=new Audio),()=>{i.current&&(i.current.pause(),i.current.src="",i.current.currentTime=0),j(null),B(null),k(null),w(!1),y(!1)}),[]);const tt={"al-hudaify":"QH","al-afasy":"QA","al-ghamidi":"QG"},Ce=t=>({E:"English",mal:"Malayalam",ur:"Urdu",bn:"Bangla",ta:"Tamil",hi:"Hindi"})[t]||t,Z=(t,a=!1)=>{if(!i.current)return;if(!a&&u!=="mal"&&q.some(g=>g==="translation"||g==="interpretation")){const g=Ce(u);Te(`${g} translation and explanation audio is coming soon. Currently, only Malayalam translation and explanation audio is available.`);const c=q.filter(v=>v!=="translation"&&v!=="interpretation");c.length>0?ae(c):ae(["quran"]);return}i.current&&i.current.pause();const r=x.find(o=>(o.ID||o.id)===t);if(!r){console.error("Block not found:",t);return}const s=r.AyaFrom||r.ayafrom||r.from||1;w(!0),j(t),k(s),f(1),y(!1),window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!0}})),W(t,s,0)},at=(t,a,r)=>{const s=String(t).padStart(3,"0"),o=String(a).padStart(3,"0");return r==="quran"?`https://old.thafheem.net/audio/qirath/${O}/${tt[O]}${s}_${o}.ogg`:r==="translation"?`https://old.thafheem.net/audio/translation/T${s}_${o}.ogg`:r==="interpretation"?`https://old.thafheem.net/audio/interpretation/I${s}_${o}.ogg`:null},L=(t,a,r=0,s=null)=>{if(!i.current)return;const o=s||q;if(r>=o.length){Be();return}i.current.pause();const g=o[r],c=at(l,a,g);if(!c){L(t,a,r+1,s);return}const d={quran:"qirath",translation:"translation",interpretation:"interpretation"}[g]||"qirath";B(d),k(a),f(1),i.current.onended=()=>{L(t,a,r+1,s)},i.current.onerror=()=>{console.error("Error playing audio:",c),L(t,a,r+1,s)},i.current.src=c,i.current.playbackRate=K,i.current.load(),i.current.play().catch(m=>{console.error("Error playing audio:",m.name,m.message,c),L(t,a,r+1,s)})},W=(t,a,r=0)=>{L(t,a,r,null)},Be=()=>{if(!h||!b)return;const t=x.find(s=>(s.ID||s.id)===h);if(!t)return;const a=t.AyaTo||t.ayato||t.to,r=b+1;r<=a?(f(1),W(h,r,0)):N?(f(1),nt()):(j(null),B(null),k(null),f(1),y(!1),window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!1}})))},rt=()=>{if(!h||!b)return;const t=x.find(s=>(s.ID||s.id)===h);if(!t)return;const a=t.AyaFrom||t.ayafrom||t.from||1,r=b-1;r>=a?(f(1),W(h,r,0)):N?(f(1),st()):(j(null),B(null),k(null),f(1),y(!1))},st=()=>{if(!N||!x||x.length===0)return;const t=x.findIndex(a=>(a.ID||a.id)===h);if(t>0){const a=x[t-1],r=a.ID||a.id,s=a.AyaTo||a.ayato||a.to||1;w(!0),j(r),k(s),f(1),y(!1),W(r,s)}else{const a=x[0],r=a.ID||a.id,s=a.AyaFrom||a.ayafrom||a.from||1;j(r),k(s),f(1),W(r,s)}},nt=()=>{if(!N||!x||x.length===0)return;const t=x.findIndex(a=>(a.ID||a.id)===h);if(t!==-1&&t<x.length-1){const a=x[t+1],r=a.ID||a.id;Z(r,!0)}else j(null),B(null),k(null),f(1),w(!1),y(!1),window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!1}}))},Ie=()=>{if(!x||x.length===0){T("No blocks available to play");return}if(u!=="mal"){const t=Ce(u);Te(`${t} translation and explanation audio is coming soon. Currently, only Malayalam translation and explanation audio is available.`);return}try{if(N)i.current&&i.current.pause(),w(!1),y(!0),window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!1}}));else if(h&&b)w(!0),y(!1),i.current&&i.current.play().then(()=>{window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!0}}))}).catch(t=>{console.error("Error resuming audio:",t)});else{w(!0),y(!1);const t=x[0].ID||x[0].id;Z(t)}}catch(t){console.error("Error in handlePlayAudio:",t),w(!1),j(null),k(null),window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!1}}))}},le=n.useRef(null);le.current=Ie,n.useEffect(()=>{const t=()=>{le.current&&le.current()};return window.addEventListener("playAudio",t),()=>{window.removeEventListener("playAudio",t)}},[]),n.useEffect(()=>{const t=N&&!U&&h!==null;window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:t}}))},[N,U,h]),n.useEffect(()=>{const t=a=>{const{type:r,message:s}=a.detail;r==="success"?$(s):r==="error"&&T(s)};return window.addEventListener("showToast",t),()=>{window.removeEventListener("showToast",t)}},[$,T]);const ee=()=>{i.current&&(i.current.pause(),i.current.currentTime=0),w(!1),j(null),B(null),k(null),window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!1}})),f(1),y(!1)};n.useEffect(()=>()=>{try{ee()}catch{}},[]),n.useEffect(()=>()=>{i.current&&(i.current.pause(),j(null),B(null),k(null),f(1),w(!1),y(!1))},[l]),n.useEffect(()=>{h&&b&&i.current&&N&&W(h,b,0)},[O,q]),n.useEffect(()=>{i.current&&(i.current.playbackRate=K)},[K]),n.useEffect(()=>((async()=>{if(!(!l||Q.current||ie.length===0)){Q.current=!0;try{he(!0),ge(null);const[a,r]=await Promise.all([wt(parseInt(l),u||"mal"),vt(parseInt(l))]),s=ie.find(o=>o.number===parseInt(l));if(ze({surahInfo:s||{number:parseInt(l),arabic:"القرآن",type:"Makki"}}),He(r||[]),be(a||[]),a&&a.length>0){const o=async(p,A)=>{const E=p.AyaFrom||p.ayafrom||p.from,R=p.AyaTo||p.ayato||p.to,M=p.ID||p.id;if(!E||!R)return;const _=`${E}-${R}`;try{G(D=>new Set([...D,M]));let C;u==="E"?(C=await Re.getCachedTranslation(parseInt(l),_,"E"),C||(C=await Le(parseInt(l),_,"E"),await Re.setCachedTranslation(parseInt(l),_,C,"E"))):C=await Le(parseInt(l),_,u||"mal"),we(D=>({...D,[M]:{range:_,ayaFrom:E,ayaTo:R,data:C}})),G(D=>{const H=new Set(D);return H.delete(M),H})}catch(C){C.message?.includes("timeout")||console.error(`❌ BlockWise: Failed to load block ${_}:`,C.message),G(D=>{const H=new Set(D);return H.delete(M),H})}},c=[];let v=0;const d=async(p,A)=>new Promise(E=>{const R=async()=>{v++;try{await o(p,A)}catch{}finally{v--,c.length>0&&c.shift()(),E()}};v<3?R():c.push(R)}),m=p=>{const A=p.slice(0,2),E=p.slice(2);return{visibleBlocks:A,backgroundBlocks:E}},{visibleBlocks:S,backgroundBlocks:F}=m(a),P=S.map((p,A)=>o(p,A));setTimeout(()=>{F.forEach((p,A)=>{setTimeout(()=>{d(p,A+S.length)},200*Math.floor(A/3))})},500),Promise.allSettled(P).then(p=>{const A=p.filter(E=>E.status==="fulfilled").length})}}catch(a){ge(a.message),console.error("Error fetching block-wise data:",a),Q.current=!1}finally{he(!1)}}})(),()=>{Q.current=!1}),[l,ie,u]),n.useEffect(()=>{we({}),be([]),G(new Set),Q.current=!1},[u]),n.useEffect(()=>{(async()=>{if(!z||!l){Se(!1);return}try{const a=await ce.isFavorited(z.uid,l);Se(a)}catch(a){console.error("Error loading favorite status:",a)}})()},[z,l]);const ot=(t,a)=>{ve({range:t,interpretationNumber:a})},$e=(t,a)=>{if(!t)return"";const r=document.createElement("div");return r.innerHTML=t,r.querySelectorAll("sup").forEach(o=>{const g=o.textContent.trim();/^\d+$/.test(g)&&(o.style.cssText=`
          cursor: pointer !important;
          background-color: #19B5DD !important;
          color: #ffffff !important;
          font-weight: 500 !important;
          text-decoration: none !important;
          border: none !important;
          padding: 4px 8px !important;
          margin: 0 4px !important;
          display: inline-flex !important;
          align-items: center !important;
          justify-content: center !important;
          font-size: 12px !important;
          vertical-align: middle !important;
          line-height: 1 !important;
          border-radius: 8px !important;
          position: relative !important;
          top: 0 !important;
          min-width: 20px !important;
          min-height: 20px !important;
          text-align: center !important;
          transition: all 0.2s ease-in-out !important;
        `,o.setAttribute("data-interpretation",g),o.setAttribute("data-range",a),o.setAttribute("data-lang",u==="E"?"en":"mal"),o.setAttribute("title",`Click to view interpretation ${g}`),o.className="interpretation-link")}),r.innerHTML};n.useEffect(()=>{const t=r=>{const s=r.target.closest(".interpretation-link");if(s){r.preventDefault(),r.stopPropagation();const o=s.getAttribute("data-interpretation"),g=s.getAttribute("data-range");s.getAttribute("data-lang"),o&&g&&requestAnimationFrame(()=>{ot(g,parseInt(o))})}},a=document.createElement("style");return a.textContent=`
      .interpretation-link:hover {
        background-color: #0891b2 !important;
        transform: scale(1.05) !important;
      }
      .interpretation-link:active {
        background-color: #0e7490 !important;
        transform: scale(0.95) !important;
      }
    `,document.head.appendChild(a),document.addEventListener("click",t,!0),()=>{document.removeEventListener("click",t,!0),document.head.removeChild(a)}},[]);const Fe=()=>{const t=parseInt(l)-1;t>=1&&I(`/blockwise/${t}`)},Pe=()=>{const t=parseInt(l)+1;t<=114&&I(`/blockwise/${t}`)};return n.useEffect(()=>{const t=()=>{window.scrollY>300?je(!0):je(!1)};return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[]),xe&&x.length===0?e.jsxs(e.Fragment,{children:[e.jsx(de,{toasts:ne,removeToast:oe}),e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-cyan-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading Block-wise data..."})]})})]}):pe?e.jsxs(e.Fragment,{children:[e.jsx(de,{toasts:ne,removeToast:oe}),e.jsx("div",{className:"min-h-screen bg-white dark:bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 dark:text-red-400 text-lg mb-2",children:"Failed to load Block-wise data"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:pe}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Try Again"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{toasts:ne,removeToast:oe}),e.jsx("div",{className:"mx-auto min-h-screen bg-white dark:bg-gray-900",children:e.jsxs("div",{className:"sticky top-0 z-40 bg-white dark:bg-gray-900 shadow-md",children:[e.jsx("div",{className:"mx-auto px-3 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"py-3 sm:py-4",children:[e.jsx("div",{className:"text-center mb-3 sm:mb-4",children:e.jsx("h1",{className:"text-3xl sm:text-4xl font-arabic dark:text-white text-gray-900",children:me?.surahInfo?.arabic||"Loading..."})}),e.jsxs("div",{className:"mb-3 sm:mb-4 relative",children:[parseInt(l)!==1&&parseInt(l)!==9?e.jsx("div",{className:"flex flex-col items-center px-2 sm:px-4",children:e.jsx("img",{src:Je==="dark"?St:At,alt:"Bismi",className:"w-[236px] h-[52.9px] mb-2"})}):e.jsx("div",{className:"h-[52.9px] mb-2"}),(u==="mal"||u==="E")&&e.jsx("div",{className:"flex justify-end mb-4 sm:hidden",children:e.jsxs("div",{className:"flex gap-1 bg-gray-100 dark:bg-[#323A3F] rounded-full p-1 shadow-sm w-[115px]",children:[e.jsx("button",{className:"px-2 sm:px-3 py-1.5 w-[55px] text-gray-500 rounded-full dark:hover:bg-gray-800 dark:text-white text-xs font-medium hover:text-gray-700 transition-colors",onClick:Ee,children:"Ayah"}),e.jsx("button",{className:"px-2 sm:px-3 py-1.5 bg-white w-[55px] dark:bg-gray-900 dark:text-white text-gray-900 rounded-full text-xs font-medium shadow transition-colors",children:"Block"})]})}),(u==="mal"||u==="E")&&e.jsx("div",{className:"absolute top-0 right-4 sm:right-6 lg:right-42 hidden sm:block",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 bg-gray-100 dark:bg-[#323A3F] rounded-full p-1 shadow-sm",children:[e.jsx("button",{className:"flex items-center px-2 sm:px-3 lg:px-4 py-1.5 text-gray-500 rounded-full dark:text-white hover:text-cyan-600 dark:hover:text-cyan-400 hover:bg-cyan-50 dark:hover:bg-cyan-900/40 text-xs sm:text-sm font-medium transition-colors min-h-[40px] sm:min-h-[44px]",onClick:Ee,children:"Ayah wise"}),e.jsx("button",{className:"flex items-center px-2 sm:px-3 lg:px-4 py-1.5 bg-white dark:bg-gray-900 text-gray-900 dark:text-white rounded-full text-xs sm:text-sm font-medium shadow-sm transition-colors min-h-[40px] sm:min-h-[44px]",children:"Block wise"})]})})]})]})}),e.jsxs("div",{className:"mx-auto px-3 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"max-w-full sm:max-w-[1290px] mx-auto pb-6 sm:pb-8",children:[xe&&x.length===0?e.jsx(Nt,{count:5}):x&&x.length>0?x.map((t,a)=>{const r=t.ID||t.id,s=t.AyaFrom||t.ayafrom||t.from||1,o=t.AyaTo||t.ayato||t.to||s,c=(Oe[r]||null)?.data,v=Array.isArray(fe)?fe.slice(s-1,o):[];return e.jsxs("div",{className:"rounded-xl mb-3 sm:mb-4 border border-gray-200 dark:border-gray-700 dark:hover:bg-gray-800 hover:bg-[#e8f2f6] active:bg-[#e8f2f6] transition-colors",children:[e.jsx("div",{className:"px-4 sm:px-6 md:px-8 pt-3 sm:pt-4 pb-2 sm:pb-3",children:e.jsx("p",{className:"text-lg sm:text-lg md:text-xl lg:text-2xl xl:text-xl leading-relaxed text-right text-gray-900 dark:text-white",style:{fontFamily:`'${Ye}', serif`,direction:"rtl"},children:v.length>0?v.map((d,m)=>`${d.text_uthmani} ﴿${et(s+m)}﴾`).join(" "):"Loading Arabic text..."})}),e.jsxs("div",{className:"px-4 sm:px-6 md:px-8 pb-2 sm:pb-3",children:[c?e.jsx("div",{className:`text-gray-700 dark:text-white leading-relaxed text-left ${u==="hi"?"font-hindi":u==="ur"?"font-urdu":u==="bn"?"font-bengali":u==="ta"?"font-tamil":u==="mal"?"font-malayalam":"font-poppins"}`,style:{fontSize:`${Ze}px`},children:Array.isArray(c)&&c.length>0?c.map((d,m)=>{const S=d.TranslationText||d.translationText||d.text||"",F=$e(S,`${s}-${o}`);return e.jsx("div",{className:"leading-relaxed",dangerouslySetInnerHTML:{__html:F}},`translation-${r}-${m}`)}):c.TranslationText||c.translationText||c.text?e.jsx("div",{className:"leading-relaxed",dangerouslySetInnerHTML:{__html:$e(c.TranslationText||c.translationText||c.text,`${s}-${o}`)}}):e.jsx("p",{children:"Translation not available"})}):Xe.has(r)?e.jsx(Tt,{message:"Loading translation..."}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Translation not available"}),e.jsxs("div",{className:"flex flex-wrap justify-start gap-1 sm:gap-2 pt-2 sm:pt-3",children:[e.jsx("button",{className:"p-1.5 sm:p-2 text-[#2AA0BF] hover:text-black hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors min-h-[40px] sm:min-h-[44px] min-w-[40px] sm:min-w-[44px] flex items-center justify-center",onClick:async()=>{try{const d=v.length>0?v.map((F,P)=>`${F.text_uthmani} ﴿${s+P}﴾`).join(" "):"Loading Arabic text...";let m="Loading translation...";if(c){const F=Array.isArray(c)&&c.length>0?c[0].TranslationText||c[0].translationText||c[0].text||"":c.TranslationText||c.translationText||c.text||"",P=document.createElement("div");P.innerHTML=F,m=P.textContent||P.innerText||""}const S=`${d}

${m}`;await navigator.clipboard.writeText(S),$("Text copied to clipboard!")}catch(d){console.error("Copy failed",d),T("Failed to copy text")}},title:"Copy text",children:e.jsx(xt,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("button",{className:`p-1.5 sm:p-2 hover:text-black hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors min-h-[40px] sm:min-h-[44px] min-w-[40px] sm:min-w-[44px] flex items-center justify-center ${h===r?"text-cyan-500 dark:text-cyan-400":"text-[#2AA0BF]"}`,onClick:()=>{h===r?U?(y(!1),w(!0),i.current&&i.current.play().then(()=>{window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!0}}))}).catch(d=>{console.error("Error resuming audio:",d)})):(i.current&&i.current.pause(),y(!0),w(!1),window.dispatchEvent(new CustomEvent("audioStateChange",{detail:{isPlaying:!1}}))):Z(r)},title:h===r?U?"Resume audio":"Pause audio":"Play audio",children:h===r&&!U?e.jsx(ht,{className:"w-4 h-4 sm:w-5 sm:h-5"}):e.jsx(pt,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),u!=="ta"&&u!=="E"&&u!=="mal"&&e.jsx("button",{className:"p-1.5 sm:p-2 text-[#2AA0BF] hover:text-black hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors min-h-[40px] sm:min-h-[44px] min-w-[40px] sm:min-w-[44px] flex items-center justify-center",onClick:d=>{const m=`/surah/${l}#verse-${s}`;d?.ctrlKey||d?.metaKey?(d.preventDefault(),window.open(m,"_blank","noopener,noreferrer")):I(m)},title:"View ayah details",children:e.jsx(gt,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("button",{className:"p-1.5 sm:p-2 text-[#2AA0BF] hover:text-black hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors min-h-[40px] sm:min-h-[44px] min-w-[40px] sm:min-w-[44px] flex items-center justify-center",onClick:d=>{const m=`/word-by-word/${l}/${s}`;if(d?.ctrlKey||d?.metaKey){d.preventDefault(),window.open(m,"_blank","noopener,noreferrer");return}se(!0),X(s)},title:"Word by word",children:e.jsx(ft,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("button",{className:`p-1.5 sm:p-2 text-[#2AA0BF] hover:text-black hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors min-h-[40px] sm:min-h-[44px] min-w-[40px] sm:min-w-[44px] flex items-center justify-center ${re[`${s}-${o}`]?"opacity-50 cursor-not-allowed":""}`,onClick:async()=>{if(!z){T("Please sign in to bookmark blocks"),I("/sign",{state:{from:Ae.pathname,message:"Sign in to bookmark blocks"}});return}const d=`${s}-${o}`;try{ye(S=>({...S,[d]:!0}));const m=ce.getEffectiveUserId(z);await ce.addBlockBookmark(m,l,s,o),$(`Saved block ${s}-${o}`)}catch(m){console.error("Failed to bookmark block:",m),T("Failed to save block")}finally{ye(m=>({...m,[d]:!1}))}},title:"Bookmark block",disabled:re[`${s}-${o}`],children:re[`${s}-${o}`]?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b border-current"}):e.jsx(yt,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("button",{className:"p-1.5 sm:p-2 text-[#2AA0BF] hover:text-black hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors min-h-[40px] sm:min-h-[44px] min-w-[40px] sm:min-w-[44px] flex items-center justify-center",onClick:async()=>{try{const d=`Surah ${l} • Verses ${s}-${o}`,m=window.location.href;navigator.share?await navigator.share({title:"Thafheem - Quran Study",text:d,url:m}):(await navigator.clipboard.writeText(`${d}
${m}`),$("Link copied to clipboard!"))}catch(d){console.error("Share failed",d),T("Failed to share")}},title:"Share block",children:e.jsx(bt,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]})]},`block-${r}-${s}-${o}`)}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No blocks available for this Surah"})}),e.jsxs("div",{className:"bg-white border-t dark:bg-gray-900 border-gray-200 dark:border-gray-700 px-3 sm:px-4 py-3 sm:py-4 mt-6 sm:mt-8 rounded-lg",children:[e.jsxs("div",{className:"sm:hidden space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:Fe,disabled:parseInt(l)<=1,className:`flex-1 flex items-center justify-center space-x-2 px-4 py-2 text-xs text-gray-600 
                               dark:bg-[#323A3F] dark:text-white hover:text-gray-900 dark:hover:text-gray-300 
                               border border-gray-300 dark:border-gray-600 rounded-lg w-[173.96px] min-h-[44px]
                               disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx(Me,{className:"w-3 h-3"}),e.jsx("span",{children:"Previous Surah"})]}),e.jsxs("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:`flex-1 flex items-center justify-center space-x-2 px-4 py-2 text-xs text-gray-600 
                               dark:bg-[#323A3F] dark:text-white hover:text-gray-900 dark:hover:text-gray-300 
                               border border-gray-300 dark:border-gray-600 rounded-lg min-h-[44px]`,children:[e.jsx(ue,{className:"w-3 h-3"}),e.jsx("span",{children:"Beginning of Surah"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:Pe,disabled:parseInt(l)>=114,className:`w-[173.96px] flex items-center justify-center space-x-2 px-4 py-2 text-xs text-gray-600 
                                 dark:bg-[#323A3F] dark:text-white hover:text-gray-900 dark:hover:text-gray-300 
                                 border border-gray-300 dark:border-gray-600 rounded-lg min-h-[44px]
                                 disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx("span",{children:"Next Surah"}),e.jsx(De,{className:"w-3 h-3"})]})})]}),e.jsxs("div",{className:"hidden sm:flex items-center justify-center space-x-2 sm:space-x-4 lg:space-x-6",children:[e.jsxs("button",{onClick:Fe,disabled:parseInt(l)<=1,className:"flex items-center space-x-2 px-3 sm:px-4 py-2 text-xs sm:text-sm bg-white border border-gray-300 rounded-full shadow-sm text-gray-600 dark:bg-[#323A3F] dark:text-white hover:text-gray-900 dark:hover:text-gray-300 transition-colors min-h-[44px] sm:min-h-[48px] disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Me,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:"Previous Surah"})]}),e.jsxs("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"flex items-center space-x-2 px-3 sm:px-4 py-2 text-xs sm:text-sm bg-white border border-gray-300 rounded-full shadow-sm text-gray-600 dark:bg-[#323A3F] dark:text-white hover:text-gray-900 dark:hover:text-gray-300 transition-colors min-h-[44px] sm:min-h-[48px]",children:[e.jsx(ue,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:"Beginning of Surah"})]}),e.jsxs("button",{onClick:Pe,disabled:parseInt(l)>=114,className:"flex items-center space-x-2 px-3 sm:px-4 py-2 text-xs sm:text-sm bg-white border border-gray-300 rounded-full shadow-sm text-gray-600 dark:bg-[#323A3F] dark:text-white hover:text-gray-900 dark:hover:text-gray-300 transition-colors min-h-[44px] sm:min-h-[48px] disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{children:"Next Surah"}),e.jsx(De,{className:"w-3 h-3 sm:w-4 sm:h-4"})]})]})]})]}),_e&&te&&e.jsx("div",{className:"fixed inset-0 bg-gray-500/70 bg-opacity-50 flex items-start justify-center z-[9999] pt-24 sm:pt-28 lg:pt-32 p-2 sm:p-4 lg:p-6 overflow-y-auto",children:e.jsx("div",{className:"bg-white dark:bg-[#2A2C38] rounded-lg max-w-xs sm:max-w-4xl max-h-[90vh] overflow-y-auto relative w-full",children:e.jsx(We,{surahId:parseInt(l),range:te.toString(),ipt:1,lang:u==="E"?"E":"mal",onClose:()=>{qe(!1),Ue(null)},showSuccess:$,showError:T},`interpretation-${l}-${te}`)})}),Ke&&ke&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-start justify-center z-[9999] pt-24 sm:pt-28 lg:pt-32 p-4 overflow-hidden",children:e.jsx(jt,{selectedVerse:ke,surahId:l,onClose:()=>{se(!1),X(null)},onNavigate:t=>X(t),onSurahChange:t=>{se(!1),X(null),I(`/surah/${t}?wordByWord=1`)}})}),V&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-start justify-center z-[9999] pt-24 sm:pt-28 lg:pt-32 p-2 sm:p-4 lg:p-6 overflow-y-auto",children:e.jsx("div",{className:"bg-white dark:bg-[#2A2C38] rounded-lg max-w-xs sm:max-w-4xl max-h-[90vh] overflow-y-auto relative w-full shadow-2xl",children:e.jsx(We,{surahId:parseInt(l),range:V.range,ipt:V.interpretationNumber,lang:u==="E"?"E":"mal",onClose:()=>ve(null),showSuccess:$,showError:T},`block-interpretation-${l}-${V.range}-${V.interpretationNumber}`)})}),Ge&&e.jsx("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:`fixed right-6 z-[60] bg-cyan-500 hover:bg-cyan-600 dark:bg-cyan-600 dark:hover:bg-cyan-700 text-white rounded-full p-3 shadow-lg transition-all duration-300 hover:scale-110 flex items-center justify-center ${b?"bottom-32 sm:bottom-36":"bottom-6"}`,title:"Beginning of Surah","aria-label":"Beginning of Surah",children:e.jsx(ue,{className:"w-6 h-6"})}),b&&e.jsx(Et,{audioElement:i.current,isPlaying:N&&i.current&&!i.current.paused,currentAyah:b,totalAyahs:x.reduce((t,a)=>{const r=a.AyaTo||a.ayato||a.to||0,s=a.AyaFrom||a.ayafrom||a.from||0;return t+(r-s+1)},0),surahInfo:me?.surahInfo,onPlayPause:Ie,onStop:ee,onSkipBack:()=>{rt()},onSkipForward:()=>{Be()},onClose:null,selectedQari:O,onQariChange:t=>{Ve(t),h&&b&&(ee(),setTimeout(()=>{Z(h)},100))},translationLanguage:u,audioTypes:q,onAudioTypesChange:t=>{const a=h,r=b;ae(t),a&&r&&(ee(),setTimeout(()=>{L(a,r,0,t)},100))},playbackSpeed:K,onPlaybackSpeedChange:t=>{Qe(t)}})]})]})})]})};export{la as default};
