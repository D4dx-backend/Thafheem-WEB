import{u as te,r as n,a as re,e as ae,j as e,l as ne,P as le,s as oe}from"./index-D2bCerlO.js";import{l as ie}from"./logo-BkkAvDQp.js";import{F as ce}from"./forward-CNrKefy6.js";import{g as L,L as de}from"./readingProgressService-DFoY0i0J.js";const xe="/assets/banner-3CoDmLuj.png",he=({className:i})=>e.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),W=({className:i})=>e.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),K=({className:i})=>e.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),M=({className:i})=>e.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),me=({className:i})=>e.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),ye=()=>{const{theme:i,setViewType:R}=te(),[v,p]=n.useState(!1),[k,T]=n.useState(""),[c,w]=n.useState([]),[f,x]=n.useState(!1),[j,A]=n.useState(!1),[N,D]=n.useState(null),[C,F]=n.useState([]),[S,$]=n.useState(!1),[_,I]=n.useState(null),[E,g]=n.useState(null),u=re(),o=n.useRef(null),m=n.useRef(!1),h=n.useRef(!1),y=n.useRef(0),b=n.useRef(0);n.useEffect(()=>{B()},[]),n.useEffect(()=>(v||f?(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"):(document.body.style.overflow="",document.body.style.paddingRight=""),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[v,f]),n.useEffect(()=>{g(L());const s=r=>{r.key&&r.key!==de||g(L())};return typeof window<"u"&&window.addEventListener("storage",s),()=>{typeof window<"u"&&window.removeEventListener("storage",s)}},[]);const z=s=>{m.current=!0,h.current=!1,y.current=s.pageX-o.current.offsetLeft,b.current=o.current.scrollLeft,o.current.style.cursor="grabbing",o.current.style.userSelect="none"},X=s=>{if(!m.current)return;s.preventDefault();const a=(s.pageX-o.current.offsetLeft-y.current)*2;Math.abs(a)>6&&(h.current=!0),o.current.scrollLeft=b.current-a},P=()=>{m.current=!1,o.current&&(o.current.style.cursor="grab",o.current.style.userSelect="")},U=s=>{m.current=!0,h.current=!1,y.current=s.touches[0].pageX-o.current.offsetLeft,b.current=o.current.scrollLeft},Q=s=>{if(!m.current)return;const a=(s.touches[0].pageX-o.current.offsetLeft-y.current)*2;Math.abs(a)>6&&(h.current=!0),o.current.scrollLeft=b.current-a},O=()=>{m.current=!1},B=async()=>{$(!0),I(null);try{const s=await ae("en");F(s)}catch(s){console.error("Error fetching popular data:",s),I("Failed to load popular content"),F([{id:67,name:"Al-Mulk",verses:"30 verses",type:"Makki"},{id:2,name:"Al-Baqarah",verses:"286 verses",type:"Madani"},{id:1,name:"Al-Fatiha",verses:"7 verses",type:"Makki"},{id:18,name:"Al-Kahf",verses:"110 verses",type:"Makki"},{id:36,name:"Ya-Sin",verses:"83 verses",type:"Makki"},{id:55,name:"Ar-Rahman",verses:"78 verses",type:"Makki"},{id:112,name:"Al-Ikhlas",verses:"4 verses",type:"Makki"},{id:114,name:"An-Nas",verses:"6 verses",type:"Makki"}])}finally{$(!1)}},q=async s=>{const r=s.target.value;if(T(r),r.trim().length<1){x(!1),w([]);return}A(!0),D(null);try{const a=await oe(r.trim(),"en"),l=[...a.surahs.map(t=>({type:"surah",data:t,displayText:`${t.number}. ${t.name}`,subText:`${t.ayahs} verses • ${t.type}`,arabicText:t.arabic})),...a.verses.slice(0,10).map(t=>({type:"verse",data:t,displayText:t.text||t.translated_text||"Verse text not available",subText:`Surah ${t.verse_key.split(":")[0]}:${t.verse_key.split(":")[1]}`,verse_key:t.verse_key,surahName:t.surahInfo?.name||t.chapter?.name_simple||`Surah ${t.verse_key.split(":")[0]}`,surahArabic:t.surahInfo?.arabic||"",verseNumber:t.verse_key.split(":")[1],surahNumber:t.verse_key.split(":")[0],surahType:t.surahInfo?.type||"",highlighted_text:t.highlighted_text}))];w(l.slice(0,12)),x(!0)}catch{D("Failed to search. Please try again."),w([])}finally{A(!1)}},V=(s,r)=>{const a=r?.ctrlKey||r?.metaKey;if(s.type==="surah"){let l=s.data?.number??s.data?.id??s.data?.chapter_id??s.data?.code??null;if(typeof l=="string"&&(l=l.replace(/^0+/,"")),!l){console.warn("Unable to determine surah number from search result:",s);return}const d=`/surah/${l.toString()}`;if(a){r?.preventDefault(),window.open(d,"_blank","noopener,noreferrer");return}u(d)}else if(s.type==="verse"||s.type==="verse_reference"){const[l,t]=s.verse_key.split(":"),d=`/surah/${l}#verse-${t}`;if(a){r?.preventDefault(),window.open(d,"_blank","noopener,noreferrer");return}u(d,{state:{highlightVerse:s.verse_key,scrollToVerse:t}})}x(!1),T("")},G=s=>{s.preventDefault(),k.trim()&&c.length>0&&V(c[0])},H=()=>{u("/bookmarkedverses")},Y=()=>{const s=L();if(!s){g(null);return}g(s),s.viewType==="blockwise"?R?.("Block Wise"):s.viewType==="surah"&&R?.("Ayah Wise");const r=s.path||(s.surahId?`/surah/${s.surahId}`:"/reading");u(r)},J=()=>{setTimeout(()=>{x(!1)},200)},Z=(s,r)=>{if(h.current){h.current=!1;return}const a=s?.id??s?.chapter_id;if(!a)return;const l=s?.verseKey||s?.verse_key,t=s?.verseNumber??s?.verse_number??(typeof l=="string"?l.split(":")[1]:void 0),d=`/surah/${a}`,ee=r?.ctrlKey||r?.metaKey,se=t||l?{...t?{scrollToVerse:t}:{},...l?{highlightVerse:l}:{}}:void 0;ee?(r?.preventDefault(),window.open(d,"_blank","noopener,noreferrer")):u(d,{state:se}),p(!1),h.current=!1};return e.jsxs("div",{className:"flex flex-col items-center justify-center bg-white dark:bg-gray-900 px-4 py-6 sm:py-8 lg:py-12",children:[e.jsx("div",{className:"w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-2xl xl:max-w-4xl mb-6 sm:mb-8 mx-auto",children:e.jsx("a",{href:"https://app.thafheem.net/",target:"_blank",rel:"noopener noreferrer",className:"block cursor-pointer hover:opacity-90 transition-opacity",children:e.jsx("img",{src:xe,alt:"Banner",className:"w-full h-auto object-contain rounded-xl"})})}),e.jsx("div",{className:"w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl mb-8 sm:mb-10 mx-auto",children:e.jsx("div",{className:"w-full h-20 sm:h-24 md:h-28 lg:h-32 rounded-lg flex items-center justify-center",children:e.jsx("img",{src:i==="dark"?ne:ie,alt:"Logo",className:"object-contain transition-transform h-16 sm:h-20 md:h-24 lg:h-28 max-w-[260px] sm:max-w-[300px] md:max-w-[360px] lg:max-w-[400px] w-auto"})})}),e.jsxs("div",{className:"w-full max-w-xl sm:max-w-2xl md:max-w-3xl mb-8 sm:mb-10 relative",children:[e.jsxs("form",{onSubmit:G,className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(he,{className:"h-5 w-5 text-gray-400 dark:text-white"})}),e.jsx("input",{type:"text",value:k,onChange:q,onBlur:J,onFocus:()=>{c.length>0&&x(!0)},placeholder:"Search surahs, verses, or try '2:255' for specific verses...",className:"w-full h-[49px] pl-12 pr-12 py-4 border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent bg-white dark:bg-[#2A2C38] dark:border-gray-600 dark:text-white shadow-sm text-gray-700 placeholder-gray-400 text-base"})]}),f&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/20 dark:bg-black/40 z-40 backdrop-blur-sm",onClick:()=>x(!1)}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-[#2A2C38] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-600 w-[95vw] max-w-xl sm:max-w-2xl md:max-w-3xl z-50 max-h-[85vh] flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium font-poppins text-gray-900 dark:text-white",children:"Search Results"}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-500 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 transition-colors p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(K,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-4",children:[j&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-cyan-500"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Searching..."})]}),N&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-red-500 dark:text-red-400",children:N})}),!j&&!N&&c.length===0&&k.length>=2&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No results found"})}),!j&&c.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:["Found ",c.filter(s=>s.type==="surah").length," surahs and ",c.filter(s=>s.type==="verse").length," verses"]}),c.map((s,r)=>e.jsx("div",{onClick:a=>V(s,a),className:"p-3 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg cursor-pointer transition-colors",children:s.type==="surah"?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-cyan-600 dark:text-cyan-400",children:"Surah"}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.subText})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.displayText}),e.jsx("p",{className:"text-lg text-gray-700 dark:text-gray-300 ml-4",dir:"rtl",children:s.arabicText})]})]}),e.jsx(M,{className:"h-4 w-4 text-gray-400 ml-2 flex-shrink-0"})]}):e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-cyan-600 dark:text-cyan-400",children:"Verse"}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.surahName}),s.surahType&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.surahType})]}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsxs("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-300",children:["Verse ",s.verseNumber]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1 pr-3",children:e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 line-clamp-3 leading-relaxed",children:s.displayText})}),s.surahArabic&&e.jsx("div",{className:"text-right",dir:"rtl",children:e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:s.surahArabic})})]})]}),e.jsx(M,{className:"h-4 w-4 text-gray-400 ml-2 flex-shrink-0"})]})},`${s.type}-${r}`))]})]})]})]}),v&&!f&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/20 dark:bg-black/40 z-40 backdrop-blur-sm",onClick:()=>p(!1)}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-[#2A2C38] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-600 w-[95vw] max-w-lg sm:max-w-xl md:max-w-2xl z-50 max-h-[85vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(W,{className:"h-5 w-5 text-cyan-500"}),e.jsx("h2",{className:"sm:text-[15px] font-semibold font-poppins text-gray-600 dark:text-[#95959b]",children:"Popular"})]}),e.jsx("button",{onClick:()=>p(!1),className:"text-[#323A3F] dark:text-white transition-colors hover:bg-gray-100 dark:hover:bg-gray-700 p-1 rounded-lg",children:e.jsx(K,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-3 sm:p-4 space-y-3",children:[e.jsx("h3",{className:"text-base font-medium font-poppins text-gray-900 dark:text-white",children:"Chapters and Verses"}),S&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-cyan-500"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Loading popular content..."})]}),_&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-red-500 dark:text-red-400",children:_})}),!S&&!_&&e.jsx(e.Fragment,{children:e.jsx("div",{ref:o,className:"flex gap-2.5 mb-3 overflow-x-auto scrollbar-hide pr-3 border-b border-gray-200 dark:border-gray-700 pb-2.5 cursor-grab",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},onMouseDown:z,onMouseMove:X,onMouseUp:P,onMouseLeave:P,onTouchStart:U,onTouchMove:Q,onTouchEnd:O,children:C.map((s,r)=>e.jsxs("button",{type:"button",onClick:a=>Z(s,a),className:"inline-flex font-poppins items-center space-x-2.5 px-3.5 py-2.5 bg-[#D8D8D8] dark:bg-gray-900 dark:text-white dark:hover:bg-gray-800 hover:bg-gray-200 rounded-lg transition-colors text-xs sm:text-sm text-gray-700 flex-shrink-0 min-w-fit shadow pointer-events-auto",style:r===C.length-1?{marginRight:"1rem"}:{},title:`${s.translated_name||s.name} - ${s.verses} (${s.type})`,children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("span",{className:"font-medium",children:[s.id,". ",s.name]}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.verses," • ",s.type]})]}),e.jsx(M,{className:"h-3.5 w-3.5 ml-1.5"})]},`${s.id??s.chapter_id}-${r}`))})}),e.jsx("div",{className:"flex flex-col items-center dark:bg-[#2A2C38] rounded-lg py-2.5 text-center",children:e.jsxs("div",{className:"flex items-center space-x-2.5",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-7 rounded-full",children:e.jsx("img",{src:ce,alt:"Forward",className:"w-[85px] h-[18px] object-contain"})}),e.jsx("h4",{className:"font-medium font-poppins text-black dark:text-white text-sm sm:text-base",children:"Listen to Quran Tajwid"})]})})]})]})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row justify-center gap-4 w-full max-w-4xl px-2",children:e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-3 sm:gap-4 w-full",children:[e.jsxs("button",{type:"button",onClick:Y,disabled:!E,title:E?"Jump back to your last reading session":"Start reading any Surah to enable this shortcut",className:"flex items-center space-x-2 px-6 py-3 bg-white dark:bg-[#2A2C38] text-[#62C3DC] dark:text-cyan-200 rounded-full shadow-md transition-all duration-200 text-sm hover:bg-[#62C3DC] hover:text-white hover:shadow-lg disabled:opacity-60 disabled:cursor-not-allowed disabled:pointer-events-none dark:hover:bg-[#3FA6C0] dark:hover:text-white [&_svg]:transition-colors [&_svg]:duration-200 [&:hover_svg]:text-white",children:[e.jsx(le,{className:"h-4 w-4 text-[#3FA6C0]"}),e.jsx("span",{className:"font-medium whitespace-nowrap font-poppins",children:"Continue Reading"})]}),e.jsxs("button",{onClick:H,className:"flex items-center space-x-2 px-6 py-3 bg-white dark:bg-[#2A2C38] text-[#62C3DC] dark:text-cyan-200 rounded-full shadow-md transition-all duration-200 text-sm hover:bg-[#62C3DC] hover:text-white hover:shadow-lg flex-shrink-0 dark:hover:bg-[#3FA6C0] dark:hover:text-white [&_svg]:transition-colors [&_svg]:duration-200 [&:hover_svg]:text-white",children:[e.jsx(me,{className:"h-4 w-4 text-[#3FA6C0]"}),e.jsx("span",{className:"font-medium whitespace-nowrap font-poppins",children:"Bookmarks"})]}),e.jsxs("button",{onClick:()=>{p(!0),C.length===0&&!S&&B()},className:"flex items-center space-x-2 px-6 py-3 bg-white dark:bg-[#2A2C38] text-[#62C3DC] dark:text-cyan-200 rounded-full shadow-md transition-all duration-200 text-sm hover:bg-[#62C3DC] hover:text-white hover:shadow-lg flex-shrink-0 dark:hover:bg-[#3FA6C0] dark:hover:text-white [&_svg]:transition-colors [&_svg]:duration-200 [&:hover_svg]:text-white",children:[e.jsx(W,{className:"h-4 w-4 text-[#3FA6C0]"}),e.jsx("span",{className:"font-medium whitespace-nowrap font-poppins",children:"Popular"})]})]})})]})};export{ye as H};
