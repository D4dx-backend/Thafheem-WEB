import{u as ne,b as le,j as e,l as oe,P as ie,s as ce}from"./index-CYmUdfUH.js";import{b as l,u as de}from"./react-vendor-v5ei6ytj.js";import{l as xe}from"./logo-BkkAvDQp.js";import{g as A,L as he}from"./readingProgressService-DFoY0i0J.js";const ue="/assets/banner-3CoDmLuj.png",me=({className:o})=>e.jsx("svg",{className:o,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),W=({className:o})=>e.jsx("svg",{className:o,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),K=({className:o})=>e.jsx("svg",{className:o,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),D=({className:o})=>e.jsx("svg",{className:o,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),fe=({className:o})=>e.jsx("svg",{className:o,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),$=(o="")=>o.replace(/\s*:\s*/g,":").replace(/\s+/g," ").trim(),Q=(o="")=>{const h=/^(\d{1,3}):(\d{1,3})$/.exec(o);if(!h)return null;const p=h[1].replace(/^0+/,"")||"0",u=h[2].replace(/^0+/,"")||"0";return{surah:p,verse:u}},be=()=>{const{theme:o,setViewType:h}=ne(),[p,u]=l.useState(!1),[C,g]=l.useState(""),[m,y]=l.useState([]),[k,c]=l.useState(!1),[S,E]=l.useState(!1),[_,v]=l.useState(null),[R,I]=l.useState([]),[L,F]=l.useState(!1),[M,P]=l.useState(null),[B,w]=l.useState(null),b=de(),i=l.useRef(null),f=l.useRef(!1),x=l.useRef(!1),j=l.useRef(0),N=l.useRef(0);l.useEffect(()=>{z()},[]),l.useEffect(()=>(p||k?(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"):(document.body.style.overflow="",document.body.style.paddingRight=""),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[p,k]),l.useEffect(()=>{w(A());const s=r=>{r.key&&r.key!==he||w(A())};return typeof window<"u"&&window.addEventListener("storage",s),()=>{typeof window<"u"&&window.removeEventListener("storage",s)}},[]);const X=s=>{f.current=!0,x.current=!1,j.current=s.pageX-i.current.offsetLeft,N.current=i.current.scrollLeft,i.current.style.cursor="grabbing",i.current.style.userSelect="none"},U=s=>{if(!f.current)return;s.preventDefault();const a=(s.pageX-i.current.offsetLeft-j.current)*2;Math.abs(a)>6&&(x.current=!0),i.current.scrollLeft=N.current-a},V=()=>{f.current=!1,i.current&&(i.current.style.cursor="grab",i.current.style.userSelect="")},O=s=>{f.current=!0,x.current=!1,j.current=s.touches[0].pageX-i.current.offsetLeft,N.current=i.current.scrollLeft},G=s=>{if(!f.current)return;const a=(s.touches[0].pageX-i.current.offsetLeft-j.current)*2;Math.abs(a)>6&&(x.current=!0),i.current.scrollLeft=N.current-a},H=()=>{f.current=!1},z=async()=>{F(!0),P(null);try{const s=await le("en");I(s)}catch(s){console.error("Error fetching popular data:",s),P("Failed to load popular content"),I([{id:67,name:"Al-Mulk",verses:"30 verses",type:"Makki"},{id:2,name:"Al-Baqarah",verses:"286 verses",type:"Madani"},{id:1,name:"Al-Fatiha",verses:"7 verses",type:"Makki"},{id:18,name:"Al-Kahf",verses:"110 verses",type:"Makki"},{id:36,name:"Ya-Sin",verses:"83 verses",type:"Makki"},{id:55,name:"Ar-Rahman",verses:"78 verses",type:"Makki"},{id:112,name:"Al-Ikhlas",verses:"4 verses",type:"Makki"},{id:114,name:"An-Nas",verses:"6 verses",type:"Makki"}])}finally{F(!1)}},T=async s=>{const r=$(s);if(!r){c(!1),y([]),v(null);return}E(!0),v(null),c(!0);try{const a=await ce(r,"en"),n=[...a.surahs.map(t=>({type:"surah",data:t,displayText:`${t.number}. ${t.name}`,subText:`${t.ayahs} verses • ${t.type}`,arabicText:t.arabic})),...a.verses.slice(0,10).map(t=>({type:"verse",data:t,displayText:t.text||t.translated_text||"Verse text not available",subText:`Surah ${t.verse_key.split(":")[0]}:${t.verse_key.split(":")[1]}`,verse_key:t.verse_key,surahName:t.surahInfo?.name||t.chapter?.name_simple||`Surah ${t.verse_key.split(":")[0]}`,surahArabic:t.surahInfo?.arabic||"",verseNumber:t.verse_key.split(":")[1],surahNumber:t.verse_key.split(":")[0],surahType:t.surahInfo?.type||"",highlighted_text:t.highlighted_text}))];y(n.slice(0,12))}catch{v("Failed to search. Please try again."),y([])}finally{E(!1)}},Y=s=>{const r=s.target.value,a=$(r);if(g(r),a.length<1){c(!1),y([]),v(null);return}if(Q(a)){g(a),T(a);return}c(!1)},q=(s,r)=>{const a=r?.ctrlKey||r?.metaKey;if(s.type==="surah"){let n=s.data?.number??s.data?.id??s.data?.chapter_id??s.data?.code??null;if(typeof n=="string"&&(n=n.replace(/^0+/,"")),!n){console.warn("Unable to determine surah number from search result:",s);return}const d=`/surah/${n.toString()}`;if(a){r?.preventDefault(),window.open(d,"_blank","noopener,noreferrer");return}b(d)}else if(s.type==="verse"||s.type==="verse_reference"){const[n,t]=s.verse_key.split(":"),d=`/surah/${n}#verse-${t}`;if(a){r?.preventDefault(),window.open(d,"_blank","noopener,noreferrer");return}b(d,{state:{highlightVerse:s.verse_key,scrollToVerse:t}})}c(!1),g("")},J=async s=>{s.preventDefault();const r=$(C);if(!r){c(!1),y([]),v(null);return}if(Q(r)){g(r),await T(r);return}const n=/^\d+$/.test(r),t=/^\d+:$/.test(r);n||t||(g(r),await T(r))},Z=()=>{b("/bookmarkedverses")},ee=()=>{const s=A();if(!s){w(null);return}w(s),s.viewType==="blockwise"?h?.("Block Wise"):s.viewType==="surah"&&h?.("Ayah Wise");const r=s.path||(s.surahId?`/surah/${s.surahId}`:"/reading");b(r)},se=()=>{setTimeout(()=>{c(!1)},200)},re=(s,r)=>{if(x.current){x.current=!1;return}const a=s?.id??s?.chapter_id;if(!a)return;const n=s?.verseKey||s?.verse_key,t=s?.verseNumber??s?.verse_number??(typeof n=="string"?n.split(":")[1]:void 0),d=`/surah/${a}`,te=r?.ctrlKey||r?.metaKey,ae=t||n?{...t?{scrollToVerse:t}:{},...n?{highlightVerse:n}:{}}:void 0;te?(r?.preventDefault(),window.open(d,"_blank","noopener,noreferrer")):b(d,{state:ae}),u(!1),x.current=!1};return e.jsxs("div",{className:"flex flex-col items-center justify-center bg-white dark:bg-gray-900 px-4 py-6 sm:py-8 lg:py-12",children:[e.jsx("div",{className:"w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-2xl xl:max-w-4xl mb-6 sm:mb-8 mx-auto",children:e.jsx("a",{href:"https://app.thafheem.net/",target:"_blank",rel:"noopener noreferrer",className:"block cursor-pointer hover:opacity-90 transition-opacity",children:e.jsx("img",{src:ue,alt:"Banner",className:"w-full h-auto object-contain rounded-xl"})})}),e.jsx("div",{className:"w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl mb-8 sm:mb-10 mx-auto",children:e.jsx("div",{className:"w-full h-20 sm:h-24 md:h-28 lg:h-32 rounded-lg flex items-center justify-center",children:e.jsx("img",{src:o==="dark"?oe:xe,alt:"Logo",className:"object-contain transition-transform h-16 sm:h-20 md:h-24 lg:h-28 max-w-[260px] sm:max-w-[300px] md:max-w-[360px] lg:max-w-[400px] w-auto"})})}),e.jsxs("div",{className:"w-full max-w-xl sm:max-w-2xl md:max-w-3xl mb-8 sm:mb-10 relative",children:[e.jsxs("form",{onSubmit:J,className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(me,{className:"h-5 w-5 text-gray-400 dark:text-white"})}),e.jsx("input",{type:"text",value:C,onChange:Y,onBlur:se,onFocus:()=>{m.length>0&&c(!0)},placeholder:"Search surahs, verses, or try '2:255' for specific verses...",className:"w-full h-[49px] pl-12 pr-12 py-4 border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent bg-white dark:bg-[#2A2C38] dark:border-gray-600 dark:text-white shadow-sm text-gray-700 placeholder-gray-400 text-base"})]}),k&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/20 dark:bg-black/40 z-[300] backdrop-blur-sm",onClick:()=>c(!1)}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-[#2A2C38] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-600 w-[95vw] max-w-xl sm:max-w-2xl md:max-w-3xl z-[310] max-h-[85vh] flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium font-poppins text-gray-900 dark:text-white",children:"Search Results"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 transition-colors p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(K,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-4",children:[S&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-cyan-500"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Searching..."})]}),_&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-red-500 dark:text-red-400",children:_})}),!S&&!_&&m.length===0&&C.length>=2&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No results found"})}),!S&&m.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:["Found ",m.filter(s=>s.type==="surah").length," surahs and ",m.filter(s=>s.type==="verse").length," verses"]}),m.map((s,r)=>e.jsx("div",{onClick:a=>q(s,a),className:"p-3 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg cursor-pointer transition-colors",children:s.type==="surah"?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-cyan-600 dark:text-cyan-400",children:"Surah"}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.subText})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.displayText}),e.jsx("p",{className:"text-lg text-gray-700 dark:text-gray-300 ml-4",dir:"rtl",children:s.arabicText})]})]}),e.jsx(D,{className:"h-4 w-4 text-gray-400 ml-2 flex-shrink-0"})]}):e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-cyan-600 dark:text-cyan-400",children:"Verse"}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.surahName}),s.surahType&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.surahType})]}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),e.jsxs("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-300",children:["Verse ",s.verseNumber]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1 pr-3",children:e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 line-clamp-3 leading-relaxed",children:s.displayText})}),s.surahArabic&&e.jsx("div",{className:"text-right",dir:"rtl",children:e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:s.surahArabic})})]})]}),e.jsx(D,{className:"h-4 w-4 text-gray-400 ml-2 flex-shrink-0"})]})},`${s.type}-${r}`))]})]})]})]}),p&&!k&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/20 dark:bg-black/40 z-[300] backdrop-blur-sm",onClick:()=>u(!1)}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-[#2A2C38] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-600 w-[95vw] max-w-lg sm:max-w-xl md:max-w-2xl z-[310] max-h-[85vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(W,{className:"h-5 w-5 text-cyan-500"}),e.jsx("h2",{className:"sm:text-[15px] font-semibold font-poppins text-gray-600 dark:text-[#95959b]",children:"Popular"})]}),e.jsx("button",{onClick:()=>u(!1),className:"text-[#323A3F] dark:text-white transition-colors hover:bg-gray-100 dark:hover:bg-gray-700 p-1 rounded-lg",children:e.jsx(K,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-3 sm:p-4 space-y-3",children:[e.jsx("h3",{className:"text-base font-medium font-poppins text-gray-900 dark:text-white",children:"Chapters and Verses"}),L&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-cyan-500"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Loading popular content..."})]}),M&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-red-500 dark:text-red-400",children:M})}),!L&&!M&&e.jsx(e.Fragment,{children:e.jsx("div",{ref:i,className:"flex gap-2.5 mb-3 overflow-x-auto scrollbar-hide pr-3 border-b border-gray-200 dark:border-gray-700 pb-2.5 cursor-grab",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},onMouseDown:X,onMouseMove:U,onMouseUp:V,onMouseLeave:V,onTouchStart:O,onTouchMove:G,onTouchEnd:H,children:R.map((s,r)=>e.jsxs("button",{type:"button",onClick:a=>re(s,a),className:"inline-flex font-poppins items-center space-x-2.5 px-3.5 py-2.5 bg-[#D8D8D8] dark:bg-gray-900 dark:text-white dark:hover:bg-gray-800 hover:bg-gray-200 rounded-lg transition-colors text-xs sm:text-sm text-gray-700 flex-shrink-0 min-w-fit shadow pointer-events-auto",style:r===R.length-1?{marginRight:"1rem"}:{},title:`${s.translated_name||s.name} - ${s.verses} (${s.type})`,children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("span",{className:"font-medium",children:[s.id,". ",s.name]}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.verses," • ",s.type]})]}),e.jsx(D,{className:"h-3.5 w-3.5 ml-1.5"})]},`${s.id??s.chapter_id}-${r}`))})})]})]})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row justify-center gap-4 w-full max-w-4xl px-2",children:e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-3 sm:gap-4 w-full",children:[e.jsxs("button",{type:"button",onClick:ee,disabled:!B,title:B?"Jump back to your last reading session":"Start reading any Surah to enable this shortcut",className:"flex items-center space-x-2 px-6 py-3 bg-white dark:bg-[#2A2C38] text-[#62C3DC] dark:text-cyan-200 rounded-full shadow-md transition-all duration-200 text-sm hover:bg-[#62C3DC] hover:text-white hover:shadow-lg disabled:opacity-60 disabled:cursor-not-allowed disabled:pointer-events-none dark:hover:bg-[#3FA6C0] dark:hover:text-white [&_svg]:transition-colors [&_svg]:duration-200 [&:hover_svg]:text-white",children:[e.jsx(ie,{className:"h-4 w-4 text-[#3FA6C0]"}),e.jsx("span",{className:"font-medium whitespace-nowrap font-poppins",children:"Continue Reading"})]}),e.jsxs("button",{onClick:Z,className:"flex items-center space-x-2 px-6 py-3 bg-white dark:bg-[#2A2C38] text-[#62C3DC] dark:text-cyan-200 rounded-full shadow-md transition-all duration-200 text-sm hover:bg-[#62C3DC] hover:text-white hover:shadow-lg flex-shrink-0 dark:hover:bg-[#3FA6C0] dark:hover:text-white [&_svg]:transition-colors [&_svg]:duration-200 [&:hover_svg]:text-white",children:[e.jsx(fe,{className:"h-4 w-4 text-[#3FA6C0]"}),e.jsx("span",{className:"font-medium whitespace-nowrap font-poppins",children:"Bookmarks"})]}),e.jsxs("button",{onClick:()=>{u(!0),R.length===0&&!L&&z()},className:"flex items-center space-x-2 px-6 py-3 bg-white dark:bg-[#2A2C38] text-[#62C3DC] dark:text-cyan-200 rounded-full shadow-md transition-all duration-200 text-sm hover:bg-[#62C3DC] hover:text-white hover:shadow-lg flex-shrink-0 dark:hover:bg-[#3FA6C0] dark:hover:text-white [&_svg]:transition-colors [&_svg]:duration-200 [&:hover_svg]:text-white",children:[e.jsx(W,{className:"h-4 w-4 text-[#3FA6C0]"}),e.jsx("span",{className:"font-medium whitespace-nowrap font-poppins",children:"Popular"})]})]})})]})};export{be as H};
