import{u as Bt,r as p,j as o,X as gt,H as Pt,J as O,D as Ft,I as H,b as Ot,K as Rt,d as Ht,a as _t,g as Lt,q as Wt,t as zt,N as Kt,x as yt,z as Jt}from"./index-BMIAMJ2S.js";import{I as Ut}from"./InterpretationNavbar-CN815TMw.js";import{u as xt,T as vt}from"./Toast-hgqkhZCU.js";import qt from"./tamilTranslationService-CFME1no4.js";import Xt from"./hindiTranslationService-C7DZVBgF.js";import Gt from"./urduTranslationService-BXqK4Yjb.js";import Qt from"./banglaTranslationService-ByBH3qbp.js";import"./WordByWordIcon-C1MNQ2Dq.js";import"./chevron-left-DDzfuR59.js";import"./apiService-xUHHIAvd.js";const Yt=(s=0)=>s<=400?"sm:max-w-xl":s<=1200?"sm:max-w-3xl":s<=2500?"sm:max-w-4xl":"sm:max-w-5xl",Zt=s=>{if(s==null)return"";if(typeof s!="string")return String(s);if(typeof window<"u"){const b=document.createElement("div");return b.innerHTML=s,b.textContent||b.innerText||""}return s.replace(/<[^>]+>/g," ")},te=({surahId:s,verseId:b,interpretationNo:B,language:Q,onClose:Y})=>{const{translationFontSize:K,translationLanguage:c}=Bt(),{toasts:rt,removeToast:f}=xt(),[k,i]=p.useState(null),[T,h]=p.useState(!0),[nt,Z]=p.useState(null),tt=p.useRef(new Map),_=j=>{if(!j)return!0;const S=Array.isArray(j)?j:[j];if(S.length===0)return!0;const d=A=>!A||typeof A!="object"?"":A.Interpretation||A.interpretation||A.AudioIntrerptn||A.text||A.content||"";return!S.some(A=>{const C=d(A);return typeof C=="string"&&C.trim().length>0})};p.useEffect(()=>{(async()=>{if(!(!s||!b))try{h(!0),Z(null);const S=Q||c;let d=null;if(S==="mal")try{const n=await Pt(parseInt(s),parseInt(b),"mal");n&&n.length>0&&(B?(d=n.filter(A=>A.InterpretationNo===String(B)||A.interptn_no===B),d.length===0&&(d=[n[0]])):d=n)}catch{}else if(S==="ta")try{const n=await qt.getAyahTranslation(parseInt(s),parseInt(b));n&&(d=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="hi")try{const n=await Xt.getExplanation(parseInt(s),parseInt(b));n&&n!=="N/A"&&(d=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="ur")try{const n=await Gt.getExplanation(parseInt(s),parseInt(b));n&&n!=="N/A"&&(d=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="bn")try{const n=await Qt.getExplanation(parseInt(s),parseInt(b));n&&n!=="N/A"&&(d=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="E"){try{d=await O(parseInt(s),parseInt(b),parseInt(b),"E")}catch{}if(!d||_(d))try{let n=tt.current.get(`${s}-E`);n||(n=await Ft(parseInt(s),"E"),tt.current.set(`${s}-E`,n||[]));const A=parseInt(b),C=Array.isArray(n)?n.find(R=>{const U=R.AyaFrom||R.ayafrom||R.from,st=R.AyaTo||R.ayato||R.to||U;return U!=null&&st!=null&&A>=U&&A<=st}):null,V=C?`${C.AyaFrom||C.ayafrom||C.from}-${C.AyaTo||C.ayato||C.to||C.AyaFrom||C.ayafrom||C.from}`:`${A}-${A}`;d=await H(parseInt(s),V,B||1,"E")}catch{}}if((!d||_(d))&&(d=await O(parseInt(s),parseInt(b),B||1,S)),!d||_(d))throw new Error("No interpretation content available");Array.isArray(d)?i(d):d?.data&&Array.isArray(d.data)?i(d.data):i(typeof d=="object"?[d]:null)}catch(S){console.error("Error fetching interpretation data:",S),Z(S.message)}finally{h(!1)}})()},[s,b,B,Q,c]);const J=j=>{if(j==null)return"";if(typeof j=="string")return j;const S=["interpret_text","InterpretText","Interpret_Text","interpretation","Interpretation","AudioIntrerptn","text","Text","content","Content","meaning","Meaning","body","Body","desc","Desc","description","Description"];for(const d of S)if(typeof j[d]=="string"&&j[d].trim().length>0)return j[d];for(const[d,n]of Object.entries(j))if(typeof n=="string"&&n.trim().length>20)return n;return'<p class="text-gray-500 italic">No interpretation content available</p>'},L=p.useMemo(()=>k?(Array.isArray(k)?k:[k]).reduce((S,d)=>{const n=J(d),A=Zt(n);return Math.max(S,A.trim().length)},0):0,[k]),W=Yt(L);return T?o.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[99999] p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:o.jsxs("div",{className:`bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full sm:w-auto ${W} max-w-[95vw] max-h-[90vh] flex flex-col overflow-hidden`,children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Interpretation ",B||1," - Surah ",s,", Verse ",b]}),o.jsx("button",{onClick:Y,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:o.jsx(gt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading interpretation..."})]})})]})}):nt?o.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[99999] p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:o.jsxs("div",{className:`bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full sm:w-auto ${W} max-w-[95vw] max-h-[90vh] flex flex-col overflow-hidden`,children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Interpretation ",B||1," - Surah ",s,", Verse ",b]}),o.jsx("button",{onClick:Y,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:o.jsx(gt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-red-500 dark:text-red-400 text-lg mb-2",children:"Failed to load interpretation"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:nt}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Try Again"})]})})]})}):o.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-[99999] p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:[o.jsxs("div",{className:`bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full sm:w-auto ${W} max-w-[95vw] max-h-[90vh] flex flex-col overflow-hidden`,children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Interpretation ",B||1," - Surah ",s,", Verse ",b]}),o.jsx("button",{onClick:Y,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:o.jsx(gt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6 overflow-y-auto flex-1",children:k&&k.length>0?o.jsx("div",{className:"space-y-4",children:k.map((j,S)=>{const d=J(j);return o.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 sm:p-6",children:o.jsx("div",{className:"text-gray-700 leading-[1.6] font-poppins sm:leading-[1.7] lg:leading-[1.8] dark:text-white text-sm sm:text-base lg:text-lg prose prose-sm dark:prose-invert max-w-none",style:{fontSize:`${K}px`},dangerouslySetInnerHTML:{__html:d}})},S)})}):o.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 sm:p-6",children:o.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm italic text-center",children:parseInt(s)===114?"Interpretation data is not available for Surah An-Nas (114). This surah may not have interpretation content in the current database.":"No interpretation available for this verse. The interpretation API may be temporarily unavailable."})})})]}),o.jsx(vt,{toasts:rt,removeToast:f})]})},ge=s=>{const b=Ot(),[B]=Rt(),Q=Ht(),Y=_t(),K=p.useMemo(()=>{const e=b.state||{};return{surahId:parseInt(s.surahId||B.get("surahId")||e.surahId||Q.surahId||1),range:s.range||B.get("range")||e.range||"1-7",ipt:parseInt(s.ipt||B.get("ipt")||e.ipt||1),lang:s.lang||B.get("lang")||e.lang||"en"}},[b.state,B,Q,s.surahId,s.range,s.ipt,s.lang]),[c,rt]=p.useState(K.surahId),[f,k]=p.useState(K.range),[i,T]=p.useState(K.ipt),[h,nt]=p.useState(K.lang),[Z,tt]=p.useState(!1),[_,J]=p.useState(null),[L,W]=p.useState([]),[j,S]=p.useState(""),{user:d}=Lt?.()||{user:null},{toasts:n,removeToast:A,showSuccess:C,showError:V}=xt(),[R,U]=p.useState(!1),[st,bt]=p.useState([]),[P,pt]=p.useState([]),[lt,ft]=p.useState(!1),[ut,ot]=p.useState({id:"",content:null}),[ct,z]=p.useState(!1),[q,X]=p.useState({surahId:null,verseId:null,interpretationNo:null,language:null}),mt=p.useRef([]);p.useEffect(()=>{s.surahId&&parseInt(s.surahId)!==c&&rt(parseInt(s.surahId)),s.range&&s.range!==f&&k(s.range),s.ipt&&parseInt(s.ipt)!==i&&T(parseInt(s.ipt)),s.lang&&s.lang!==h&&nt(s.lang)},[s.surahId,s.range,s.ipt,s.lang]),p.useEffect(()=>{},[c,f,i,h]),p.useEffect(()=>{c&&f&&(async()=>{try{tt(!0),J(null),W([]);const t=/^\d+$/.test(f)?await O(c,parseInt(f,10),i,h):await H(c,f,i,h),a=Array.isArray(t)?t:[t];if(a.length>0){const l=a.map(u=>u?.InterpretationNo||u?.interpretationNo||u?.interptn_no).filter(Boolean);a[0]}if(a.length===0||a.length===1&&(!a[0]||Object.keys(a[0]).length===0)||a.length===1&&a[0].Interpretation==="")if(console.warn(`⚠️ No interpretation ${i} available for range ${f}`),i!==1){T(1),V(`Interpretation ${i} is not available for verses ${f}. Loading interpretation 1.`);return}else V(`No interpretation available for verses ${f}.`),J(`No interpretation available for verses ${f}.`),W([]);else W(a)}catch(r){console.error(`❌ Failed to load interpretation ${i}:`,r);let t="Failed to load interpretation";r.message?.includes("500")?t=`Server error loading interpretation ${i}. Please try again later.`:r.message?.includes("404")?t=`Interpretation ${i} not found for this selection.`:r.message?.includes("network")||r.message?.includes("fetch")?t="Network error. Please check your connection.":t=`Interpretation ${i} is not available.`,J(t)}finally{tt(!1)}})()},[c,f,i,h]);const et=()=>{mt.current.forEach(e=>{if(!e)return;e.querySelectorAll("sup, a").forEach(t=>{const a=(t.innerText||t.textContent||"").trim();a&&(t.style.removeProperty("color"),t.style.removeProperty("text-decoration"),t.style.removeProperty("cursor"),t.style.removeProperty("font-weight"),/^N\d+$/.test(a)?(t.setAttribute("data-type","note"),t.setAttribute("data-value",a),t.onclick=it):(/^\(?\d+\s*[:：]\s*\d+\)?$/.test(a)||/^\d+\s*[:：]\s*\d+$/.test(a)||/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*\d+\s+\d+:\d+/.test(a)||/സൂക്തം:\s*\d+\s+\d+:\d+/.test(a))&&(t.setAttribute("data-type","verse"),t.setAttribute("data-value",a),t.onclick=it))})})};p.useEffect(()=>{L.length>0&&(et(),setTimeout(et,100))},[L]),p.useEffect(()=>{!lt&&!ct&&L.length>0&&(et(),setTimeout(et,100))},[lt,ct]),p.useEffect(()=>{let e=!0;return(async()=>{try{const r=await Wt();if(!e)return;bt(r.map(a=>({value:a.id,label:`${a.id}- ${a.english||"Surah"}`})));const t=r.find(a=>a.id===Number(c));e&&S(`${c}- ${t?.english||"Surah"}`)}catch{e&&S(`${c}- Surah`)}})(),()=>{e=!1}},[c]),p.useEffect(()=>{let e=!0;return(async()=>{try{const r=await zt();if(!e)return;const a=r.find(u=>u.number===Number(c))?.ayahs||286,l=Array.from({length:a},(u,w)=>String(w+1));pt(l)}catch{e&&pt(Array.from({length:50},(t,a)=>String(a+1)))}})(),()=>{e=!1}},[c]);const It=()=>{},kt=()=>{},wt=e=>{rt(parseInt(e,10))},Nt=e=>{k(String(e))},St=async()=>{const e=i-1;if(e>=1)try{const a=/^\d+$/.test(f)?await O(c,parseInt(f,10),e,h):await H(c,f,e,h),l=Array.isArray(a)?a:[a];if(l.length>0&&!(l.length===1&&(!l[0]||Object.keys(l[0]).length===0))&&!(l.length===1&&l[0].Interpretation==="")){T(e);return}}catch{}const r=String(f);if(/^\d+$/.test(r)){const t=parseInt(r,10);if(t<=1){V("Already at the first verse of this surah");return}const a=t-1;try{const l=await O(c,a,i,h),u=Array.isArray(l)?l:[l];if(u.length>0&&!(u.length===1&&(!u[0]||Object.keys(u[0]).length===0))&&!(u.length===1&&u[0].Interpretation===""))k(String(a)),T(i);else{let g=0;for(let m=1;m<i;m++)try{const v=await O(c,a,m,h),x=Array.isArray(v)?v:[v];if(x.length>0&&!(x.length===1&&(!x[0]||Object.keys(x[0]).length===0))&&!(x.length===1&&x[0].Interpretation===""))g=m;else break}catch{break}g>0?(k(String(a)),T(g)):V("No interpretations available for the previous verse")}}catch{k(String(a)),T(1)}}else if(/^(\d+)-(\d+)$/.test(r)){const t=r.match(/^(\d+)-(\d+)$/);if(t){const[,a,l]=t,u=parseInt(a,10),g=parseInt(l,10)-u+1;if(u<=1){V("Already at the first block of this surah");return}const m=Math.max(1,u-g),v=m+g-1,x=`${m}-${v}`;try{const M=await H(c,x,i,h),E=Array.isArray(M)?M:[M];if(E.length>0&&!(E.length===1&&(!E[0]||Object.keys(E[0]).length===0))&&!(E.length===1&&E[0].Interpretation===""))k(x),T(i);else{let D=0;for(let N=1;N<i;N++)try{const y=await H(c,x,N,h),I=Array.isArray(y)?y:[y];if(I.length>0&&!(I.length===1&&(!I[0]||Object.keys(I[0]).length===0))&&!(I.length===1&&I[0].Interpretation===""))D=N;else break}catch{break}if(D>0)k(x),T(D);else{let N=!1;for(let y=v;y>=m&&y>=1;y--)try{let I=0;for(let F=1;F<i;F++)try{const at=await O(c,y,F,h),G=Array.isArray(at)?at:[at];if(G.length>0&&!(G.length===1&&(!G[0]||Object.keys(G[0]).length===0))&&!(G.length===1&&G[0].Interpretation===""))I=F;else break}catch{break}if(I>0){k(String(y)),T(I),N=!0;break}}catch{}N||V("No more interpretations available in this surah")}}}catch{let E=!1;for(let $=v;$>=m&&$>=1;$--)try{let D=0;for(let N=1;N<i;N++)try{const y=await O(c,$,N,h),I=Array.isArray(y)?y:[y];if(I.length>0&&!(I.length===1&&(!I[0]||Object.keys(I[0]).length===0))&&!(I.length===1&&I[0].Interpretation===""))D=N;else break}catch{break}if(D>0){k(String($)),T(D),E=!0;break}}catch{}E||V("No more interpretations available in this surah")}}}},At=async()=>{const e=i+1;try{const a=/^\d+$/.test(f)?await O(c,parseInt(f,10),e,h):await H(c,f,e,h),l=Array.isArray(a)?a:[a];if(l.length>0&&!(l.length===1&&(!l[0]||Object.keys(l[0]).length===0))&&!(l.length===1&&l[0].Interpretation==="")){T(e);return}else{const w=String(f);let g;if(/^\d+$/.test(w)){const m=parseInt(w,10),v=P.length>0?parseInt(P[P.length-1],10):286;if(m>=v){V("Already at the last verse of this surah");return}g=String(m+1)}else if(/^(\d+)-(\d+)$/.test(w)){const m=w.match(/^(\d+)-(\d+)$/);if(m){const[,v,x]=m,M=parseInt(v,10),E=parseInt(x,10),$=E-M+1,D=P.length>0?parseInt(P[P.length-1],10):286;if(E>=D){V("Already at the last block of this surah");return}const N=M+$,y=Math.min(D,N+$-1);g=`${N}-${y}`}}if(g)try{const v=/^\d+$/.test(g)?await O(c,parseInt(g,10),e,h):await H(c,g,e,h),x=Array.isArray(v)?v:[v];if(x.length>0&&!(x.length===1&&(!x[0]||Object.keys(x[0]).length===0))&&!(x.length===1&&x[0].Interpretation==="")){k(g),T(e);return}}catch{}}}catch{}const r=String(f);if(/^\d+$/.test(r)){const t=parseInt(r,10),a=P.length>0?parseInt(P[P.length-1],10):286;if(t>=a){V("Already at the last verse of this surah");return}const l=t+1;k(String(l)),T(1)}else if(/^(\d+)-(\d+)$/.test(r)){const t=r.match(/^(\d+)-(\d+)$/);if(t){const[,a,l]=t,u=parseInt(a,10),w=parseInt(l,10),g=w-u+1,m=P.length>0?parseInt(P[P.length-1],10):286;if(w>=m){V("Already at the last block of this surah");return}const v=u+g,x=Math.min(m,v+g-1),M=`${v}-${x}`;try{const E=await H(c,M,1,h),$=Array.isArray(E)?E:[E];if($.length>0&&!($.length===1&&(!$[0]||Object.keys($[0]).length===0))&&!($.length===1&&$[0].Interpretation===""))k(M),T(1);else{let N=!1;for(let y=v;y<=x&&y<=m;y++)try{const I=await O(c,y,1,h),F=Array.isArray(I)?I:[I];if(F.length>0&&!(F.length===1&&(!F[0]||Object.keys(F[0]).length===0))&&!(F.length===1&&F[0].Interpretation==="")){k(String(y)),T(1),N=!0;break}}catch{}N||V("No more interpretations available in this surah")}}catch{let $=!1;for(let D=v;D<=x&&D<=m;D++)try{const N=await O(c,D,1,h),y=Array.isArray(N)?N:[N];if(y.length>0&&!(y.length===1&&(!y[0]||Object.keys(y[0]).length===0))&&!(y.length===1&&y[0].Interpretation==="")){k(String(D)),T(1),$=!0;break}}catch{}$||V("No more interpretations available in this surah")}}}},jt=async()=>{try{U(!0);const e=yt.getEffectiveUserId(d);await yt.addBlockInterpretationBookmark(e,c,f,j,i,h),C(`Saved interpretation for Surah ${c}, verses ${f}`)}catch(e){console.error("Failed to bookmark interpretation",e),V("Failed to save interpretation bookmark")}finally{setTimeout(()=>U(!1),300)}},$t=async()=>{const e=`Interpretation ${i} — Surah ${c} • Range ${f}`,r=window.location.href;try{navigator.share?await navigator.share({title:document.title||"Thafheem",text:e,url:r}):(await navigator.clipboard.writeText(`${e}
${r}`),C("Link copied to clipboard"))}catch(t){console.error("Share failed",t),V("Share failed: "+t.message)}},Tt=e=>{const r=/^\d+/.exec(String(f))?.[0]||"1",t=`/word-by-word/${c}/${r}`;e?.ctrlKey||e?.metaKey?(e?.preventDefault(),window.open(t,"_blank","noopener,noreferrer")):Y(t,{state:{from:b.pathname+b.search}})},Dt=e=>({N895:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N895</h3>
          <p>ലാത്ത് - ഇത് ഒരു പ്രാചീന അറബ് ദേവതയുടെ പേരാണ്. ഇസ്ലാമിന് മുമ്പുള്ള അറേബ്യയിൽ ഈ ദേവതയെ ആരാധിച്ചിരുന്നു.</p>
          <p>ഖുർആനിൽ ഈ ദേവതയെ പരാമർശിക്കുന്നത് ബഹുദൈവവാദത്തിന്റെ തെറ്റിനെ വിശദീകരിക്കാനാണ്.</p>
        </div>
      `,N189:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N189</h3>
          <p>ഉസ്സ - ഇതും ഒരു പ്രാചീന അറബ് ദേവതയാണ്. ലാത്ത്, ഉസ്സ, മനാത് എന്നിവ മക്കയിലെ പ്രധാന ദേവതകളായിരുന്നു.</p>
          <p>ഇവയെ "അല്ലാഹുവിന്റെ പുത്രിമാർ" എന്ന് അവർ വിളിച്ചിരുന്നു.</p>
        </div>
      `,N1514:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N1514</h3>
          <p>നബി(സ) തിരുമേനി ആ സന്ദർഭത്തിൽ അകപ്പെട്ടിരുന്ന സ്ഥിതിവിശേഷമാണിവിടെ സൂചിപ്പിക്കുന്നത്.</p>
          <p>നബി(സ)ക്കും സഹചാരികൾക്കും എതിരാളികൾ ഏൽപിച്ചിരുന്ന ദണ്ഡനപീഡനങ്ങളല്ല തിരുമേനിയെ ദുഃഖാകുലനാക്കിയിരുന്നതെന്ന് ഇതിൽനിന്ന് വ്യക്തമാണ്.</p>
        </div>
      `,N1462:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N1462</h3>
          <p>മുസ്ലിം ഹദീസ് ശേഖരത്തിലെ 1462-ാം നമ്പർ ഹദീസിനെ സൂചിപ്പിക്കുന്നു.</p>
          <p>ഈ ഹദീസ് നബി(സ)യുടെ ഉദാഹരണങ്ങളെക്കുറിച്ച് പ്രതിപാദിക്കുന്നു.</p>
        </div>
      `,"3 26:3":`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Verse Reference 3:26:3</h3>
          <p>അശ്ശുഅറാഅ് സൂറയിലെ 26-ാം വാക്യത്തിന്റെ 3-ാം ഭാഗത്തെ സൂചിപ്പിക്കുന്നു.</p>
          <p>ഈ വാക്യം കവികളെക്കുറിച്ചും അവരുടെ പിന്തുടർച്ചക്കാരെക്കുറിച്ചും പ്രതിപാദിക്കുന്നു.</p>
        </div>
      `})[e]||null,dt=async e=>{ot({id:e,content:"Loading..."}),ft(!0);const r=Dt(e);r&&ot({id:e,content:r});try{const t=await Jt(e),a=t?.NoteText||t?.content||t?.html||t?.text||t?.body||t?.description||t?.note||(typeof t=="string"?t:null);a&&a!=="Note content not available"&&ot({id:e,content:a})}catch(t){!t.message?.includes("500")&&!t.message?.includes("Network error")&&console.warn(`Failed to fetch note ${e}:`,t.message),r||ot({id:e,content:`
            <div class="note-content">
              <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note ${e}</h3>
              <p style="color: #666;">Note content is temporarily unavailable. Please try again later.</p>
            </div>
          `})}},it=e=>{e.preventDefault(),e.stopPropagation();const r=e.target,t=r.getAttribute("data-type"),a=r.getAttribute("data-value"),l=r.innerText||r.textContent||"";if(!l)return;if(t==="verse"||t==="range"){const g=a||l,m=g.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||g.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(m){const[,x,M]=m;X({surahId:parseInt(x,10),verseId:parseInt(M,10),interpretationNo:i,language:h}),z(!0);return}const v=g.match(/^\(?(\d+)\s*[:：]\s*(\d+)\)?$/);if(v){const[,x,M]=v;X({surahId:parseInt(x,10),verseId:parseInt(M,10),interpretationNo:i,language:h}),z(!0);return}}else if(t==="note"){dt(a||l);return}const u=l.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||l.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(u){const[,g,m]=u;X({surahId:parseInt(g,10),verseId:parseInt(m,10),interpretationNo:i,language:h}),z(!0);return}const w=l.match(/^\(?(\d+)\s*[:：]\s*(\d+)\)?$/);if(w){const[,g,m]=w;X({surahId:parseInt(g,10),verseId:parseInt(m,10),interpretationNo:i,language:h}),z(!0);return}dt(l)};p.useEffect(()=>(window.handleNoteHighlightClick=it,()=>{delete window.handleNoteHighlightClick}),[]);const Vt=()=>{setTimeout(et,50)};p.useEffect(()=>(window.restoreStyling=Vt,()=>{delete window.restoreStyling}),[]);const Et=e=>{const r=e.target;if(r.tagName==="SUP"||r.tagName==="A"){it(e);return}const t=r.innerText||r.textContent||"",a=t.match(/N(\d+)/);if(a){const w=`N${a[1]}`;dt(w);return}const l=t.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||t.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(l){const[,w,g]=l;X({surahId:parseInt(w,10),verseId:parseInt(g,10),interpretationNo:i,language:h}),z(!0);return}const u=t.match(/\(?(\d+)\s*[:：]\s*(\d+)\)?/);if(u){const[,w,g]=u;X({surahId:parseInt(w,10),verseId:parseInt(g,10),interpretationNo:i,language:h}),z(!0);return}},Ct=e=>{const r=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];return e.toString().split("").map(t=>r[t]||t).join("")},ht=e=>{if(!e||typeof e!="string")return e;const r=document.createElement("div");r.innerHTML=e;const t=document.createTreeWalker(r,NodeFilter.SHOW_TEXT,null,!1),a=[];let l;for(;l=t.nextNode();)a.push(l);return a.forEach(u=>{const w=u.textContent,g=w.replace(/\((\d+)\)/g,(m,v)=>`(${Ct(v)})`);g!==w&&(u.textContent=g)}),r.innerHTML},Mt=e=>{if(e==null)return"";if(typeof e=="string")return ht(e);const r=["interpret_text","InterpretText","Interpret_Text","interpretation","Interpretation","text","Text","content","Content","meaning","Meaning","body","Body","desc","Desc","description","Description"];for(const t of r)if(typeof e[t]=="string"&&e[t].trim().length>0)return ht(e[t]);for(const[t,a]of Object.entries(e))if(typeof a=="string"&&a.trim().length>20)return ht(a);return console.warn("⚠️ No valid interpretation text found in item:",e),`<p class="text-gray-500 italic">No interpretation content available for interpretation ${i}</p>`};return o.jsxs(o.Fragment,{children:[o.jsx("style",{children:`
        /* Specific styling for note and verse markers in interpretation content */
        .interpretation-content sup[data-type="note"], 
        .interpretation-content a[data-type="note"],
        .interpretation-content sup[data-type="verse"], 
        .interpretation-content a[data-type="verse"] {
          transition: all 0.2s ease !important;
          color: #2AA0BF !important;
          font-weight: 600 !important;
          cursor: pointer !important;
          text-decoration: none !important;
        }
        
        .interpretation-content sup[data-type="note"]:hover, 
        .interpretation-content a[data-type="note"]:hover,
        .interpretation-content sup[data-type="verse"]:hover, 
        .interpretation-content a[data-type="verse"]:hover {
          color: #1e7a8c !important;
          text-decoration: underline !important;
          transform: scale(1.05) !important;
        }
        
        /* Fallback for elements without data-type but with note/verse patterns */
        .interpretation-content sup:not([data-type]), 
        .interpretation-content a:not([data-type]) {
          color: #2AA0BF !important;
          font-weight: 600 !important;
          cursor: pointer !important;
          text-decoration: none !important;
          transition: all 0.2s ease !important;
        }
        
        .interpretation-content sup:not([data-type]):hover, 
        .interpretation-content a:not([data-type]):hover {
          color: #1e7a8c !important;
          text-decoration: underline !important;
          transform: scale(1.05) !important;
        }
        `}),o.jsx(Ut,{interpretationNumber:i,surahName:j,verseRange:f.replace(/-/g," - "),backTo:b.state?.from||void 0,onClose:s.onClose||b.state?.onClose,onSelectSurah:It,onSelectRange:kt,onBookmark:jt,onShare:$t,onWordByWord:Tt,bookmarking:R,surahOptions:st,rangeOptions:P,onPickSurah:wt,onPickRange:Nt,onPrev:St,onNext:At},`navbar-${c}-${f}-${i}`),o.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white dark:bg-[#2A2C38]",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4 text-sm",children:[o.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["Surah: ",c]}),o.jsxs("span",{className:"font-bold text-cyan-600 dark:text-cyan-400 text-base",children:["• Range: ",f]}),o.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["• Interpretation: ",i]}),o.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["• Lang: ",h]})]}),Z&&o.jsx("div",{className:"text-center py-8 text-gray-600 dark:text-gray-300",children:"Loading interpretation…"}),_&&o.jsx("div",{className:"text-red-600 dark:text-red-400 py-4",children:_}),!Z&&!_&&L.length===0&&o.jsx("div",{className:"text-center py-10 text-gray-600 dark:text-gray-300",children:"No interpretation found for this selection."}),o.jsx("div",{className:"space-y-6",children:L.map((e,r)=>o.jsx("div",{className:"bg-gray-50 p-6 rounded-lg border-l-4 dark:bg-[#2A2C38] dark:border-[#2A2C38] border-white",children:o.jsx("div",{className:"interpretation-content text-gray-800 dark:text-white  text-justify whitespace-pre-wrap prose prose-sm dark:prose-invert max-w-none",ref:t=>mt.current[r]=t,onClick:Et,style:{pointerEvents:"auto",position:"relative",zIndex:1,fontFamily:h==="hi"?"NotoSansDevanagari, sans-serif":h==="ur"?"JameelNoori, sans-serif":h==="bn"?"SutonnyMJ, sans-serif":h==="ta"?"Bamini, sans-serif":h==="mal"?"NotoSansMalayalam, sans-serif":"Poppins, sans-serif"},dangerouslySetInnerHTML:{__html:Mt(e)}})},`${c}-${f}-${i}-${e?.ID||e?.id||r}`))},`block-${c}-${f}-${i}`)]}),o.jsx(Kt,{isOpen:lt,onClose:()=>ft(!1),noteId:ut.id,noteContent:ut.content}),ct&&q.surahId&&q.verseId&&o.jsx(te,{surahId:q.surahId,verseId:q.verseId,interpretationNo:q.interpretationNo,language:q.language,onClose:()=>z(!1)}),o.jsx(vt,{toasts:n,removeToast:A})]})};export{ge as default};
