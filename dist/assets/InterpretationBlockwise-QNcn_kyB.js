import{u as Mt,r as u,j as s,X as dt,G as Pt,I as O,A as Ft,H,b as Ot,K as Rt,d as Ht,a as _t,g as Lt,q as zt,t as Wt,x as mt,J as Kt}from"./index-pxHnjHjD.js";import{I as Jt,N as Ut}from"./NotePopup-DbvEEH89.js";import{u as yt,T as xt}from"./Toast-B6q433qJ.js";import qt from"./tamilTranslationService-BXq1lve9.js";import Xt from"./hindiTranslationService-TIz5d7Jr.js";import Gt from"./urduTranslationService-Devikl1b.js";import Qt from"./banglaTranslationService-DREVDw9v.js";import"./WordByWordIcon-B1kDBx-G.js";import"./chevron-left-BDDzhXoa.js";import"./apiService-uFQGO9bv.js";const Yt=({surahId:o,verseId:w,interpretationNo:B,language:U,onClose:q})=>{const{translationFontSize:z,translationLanguage:c}=Mt(),{toasts:tt,removeToast:p}=yt(),[T,i]=u.useState(null),[D,d]=u.useState(!0),[et,X]=u.useState(null),G=u.useRef(new Map),_=N=>{if(!N)return!0;const S=Array.isArray(N)?N:[N];if(S.length===0)return!0;const h=A=>!A||typeof A!="object"?"":A.Interpretation||A.interpretation||A.AudioIntrerptn||A.text||A.content||"";return!S.some(A=>{const M=h(A);return typeof M=="string"&&M.trim().length>0})};u.useEffect(()=>{(async()=>{if(!(!o||!w))try{d(!0),X(null);const S=U||c;let h=null;if(S==="mal")try{const n=await Pt(parseInt(o),parseInt(w),"mal");n&&n.length>0&&(B?(h=n.filter(A=>A.InterpretationNo===String(B)||A.interptn_no===B),h.length===0&&(h=[n[0]])):h=n)}catch{}else if(S==="ta")try{const n=await qt.getAyahTranslation(parseInt(o),parseInt(w));n&&(h=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="hi")try{const n=await Xt.getExplanation(parseInt(o),parseInt(w));n&&n!=="N/A"&&(h=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="ur")try{const n=await Gt.getExplanation(parseInt(o),parseInt(w));n&&n!=="N/A"&&(h=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="bn")try{const n=await Qt.getExplanation(parseInt(o),parseInt(w));n&&n!=="N/A"&&(h=[{interpretation:n,AudioIntrerptn:n,text:n,content:n}])}catch{}else if(S==="E"){try{h=await O(parseInt(o),parseInt(w),parseInt(w),"E")}catch{}if(!h||_(h))try{let n=G.current.get(`${o}-E`);n||(n=await Ft(parseInt(o),"E"),G.current.set(`${o}-E`,n||[]));const A=parseInt(w),M=Array.isArray(n)?n.find(R=>{const j=R.AyaFrom||R.ayafrom||R.from,at=R.AyaTo||R.ayato||R.to||j;return j!=null&&at!=null&&A>=j&&A<=at}):null,st=M?`${M.AyaFrom||M.ayafrom||M.from}-${M.AyaTo||M.ayato||M.to||M.AyaFrom||M.ayafrom||M.from}`:`${A}-${A}`;h=await H(parseInt(o),st,B||1,"E")}catch{}}if((!h||_(h))&&(h=await O(parseInt(o),parseInt(w),B||1,S)),!h||_(h))throw new Error("No interpretation content available");Array.isArray(h)?i(h):h?.data&&Array.isArray(h.data)?i(h.data):i(typeof h=="object"?[h]:null)}catch(S){console.error("Error fetching interpretation data:",S),X(S.message)}finally{d(!1)}})()},[o,w,B,U,c]);const Q=N=>{if(N==null)return"";if(typeof N=="string")return N;const S=["interpret_text","InterpretText","Interpret_Text","interpretation","Interpretation","AudioIntrerptn","text","Text","content","Content","meaning","Meaning","body","Body","desc","Desc","description","Description"];for(const h of S)if(typeof N[h]=="string"&&N[h].trim().length>0)return N[h];for(const[h,n]of Object.entries(N))if(typeof n=="string"&&n.trim().length>20)return n;return'<p class="text-gray-500 italic">No interpretation content available</p>'};return D?s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[99999] p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:s.jsxs("div",{className:"bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] max-h-[90vh] flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Interpretation ",B||1," - Surah ",o,", Verse ",w]}),s.jsx("button",{onClick:q,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(dt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading interpretation..."})]})})]})}):et?s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[99999] p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:s.jsxs("div",{className:"bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] max-h-[90vh] flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Interpretation ",B||1," - Surah ",o,", Verse ",w]}),s.jsx("button",{onClick:q,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(dt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 dark:text-red-400 text-lg mb-2",children:"Failed to load interpretation"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:et}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Try Again"})]})})]})}):s.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-[99999] p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:[s.jsxs("div",{className:"bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] max-h-[90vh] flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Interpretation ",B||1," - Surah ",o,", Verse ",w]}),s.jsx("button",{onClick:q,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(dt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),s.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6 overflow-y-auto flex-1",children:T&&T.length>0?s.jsx("div",{className:"space-y-4",children:T.map((N,S)=>{const h=Q(N);return s.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 sm:p-6",children:s.jsx("div",{className:"text-gray-700 leading-[1.6] font-poppins sm:leading-[1.7] lg:leading-[1.8] dark:text-white text-sm sm:text-base lg:text-lg prose prose-sm dark:prose-invert max-w-none",style:{fontSize:`${z}px`},dangerouslySetInnerHTML:{__html:h}})},S)})}):s.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 sm:p-6",children:s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm italic text-center",children:parseInt(o)===114?"Interpretation data is not available for Surah An-Nas (114). This surah may not have interpretation content in the current database.":"No interpretation available for this verse. The interpretation API may be temporarily unavailable."})})})]}),s.jsx(xt,{toasts:tt,removeToast:p})]})},de=o=>{const w=Ot(),[B]=Rt(),U=Ht(),q=_t(),z=u.useMemo(()=>{const e=w.state||{};return{surahId:parseInt(o.surahId||B.get("surahId")||e.surahId||U.surahId||1),range:o.range||B.get("range")||e.range||"1-7",ipt:parseInt(o.ipt||B.get("ipt")||e.ipt||1),lang:o.lang||B.get("lang")||e.lang||"en"}},[w.state,B,U,o.surahId,o.range,o.ipt,o.lang]),[c,tt]=u.useState(z.surahId),[p,T]=u.useState(z.range),[i,D]=u.useState(z.ipt),[d,et]=u.useState(z.lang),[X,G]=u.useState(!1),[_,Q]=u.useState(null),[N,S]=u.useState([]),[h,n]=u.useState(""),{user:A}=Lt?.()||{user:null},{toasts:M,removeToast:st,showSuccess:R,showError:j}=yt(),[at,ht]=u.useState(!1),[vt,bt]=u.useState([]),[P,gt]=u.useState([]),[ot,pt]=u.useState(!1),[ft,rt]=u.useState({id:"",content:null}),[it,L]=u.useState(!1),[W,K]=u.useState({surahId:null,verseId:null,interpretationNo:null,language:null}),ut=u.useRef([]);u.useEffect(()=>{o.surahId&&parseInt(o.surahId)!==c&&tt(parseInt(o.surahId)),o.range&&o.range!==p&&T(o.range),o.ipt&&parseInt(o.ipt)!==i&&D(parseInt(o.ipt)),o.lang&&o.lang!==d&&et(o.lang)},[o.surahId,o.range,o.ipt,o.lang]),u.useEffect(()=>{},[c,p,i,d]),u.useEffect(()=>{c&&p&&(async()=>{try{G(!0),Q(null),S([]);const t=/^\d+$/.test(p)?await O(c,parseInt(p,10),i,d):await H(c,p,i,d),a=Array.isArray(t)?t:[t];if(a.length>0){const l=a.map(f=>f?.InterpretationNo||f?.interpretationNo||f?.interptn_no).filter(Boolean);a[0]}if(a.length===0||a.length===1&&(!a[0]||Object.keys(a[0]).length===0)||a.length===1&&a[0].Interpretation==="")if(console.warn(`⚠️ No interpretation ${i} available for range ${p}`),i!==1){D(1),j(`Interpretation ${i} is not available for verses ${p}. Loading interpretation 1.`);return}else j(`No interpretation available for verses ${p}.`),Q(`No interpretation available for verses ${p}.`),S([]);else S(a)}catch(r){console.error(`❌ Failed to load interpretation ${i}:`,r);let t="Failed to load interpretation";r.message?.includes("500")?t=`Server error loading interpretation ${i}. Please try again later.`:r.message?.includes("404")?t=`Interpretation ${i} not found for this selection.`:r.message?.includes("network")||r.message?.includes("fetch")?t="Network error. Please check your connection.":t=`Interpretation ${i} is not available.`,Q(t)}finally{G(!1)}})()},[c,p,i,d]);const Y=()=>{ut.current.forEach(e=>{if(!e)return;e.querySelectorAll("sup, a").forEach(t=>{const a=(t.innerText||t.textContent||"").trim();a&&(t.style.removeProperty("color"),t.style.removeProperty("text-decoration"),t.style.removeProperty("cursor"),t.style.removeProperty("font-weight"),/^N\d+$/.test(a)?(t.setAttribute("data-type","note"),t.setAttribute("data-value",a),t.onclick=nt):(/^\(?\d+\s*[:：]\s*\d+\)?$/.test(a)||/^\d+\s*[:：]\s*\d+$/.test(a)||/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*\d+\s+\d+:\d+/.test(a)||/സൂക്തം:\s*\d+\s+\d+:\d+/.test(a))&&(t.setAttribute("data-type","verse"),t.setAttribute("data-value",a),t.onclick=nt))})})};u.useEffect(()=>{N.length>0&&(Y(),setTimeout(Y,100))},[N]),u.useEffect(()=>{!ot&&!it&&N.length>0&&(Y(),setTimeout(Y,100))},[ot,it]),u.useEffect(()=>{let e=!0;return(async()=>{try{const r=await zt();if(!e)return;bt(r.map(a=>({value:a.id,label:`${a.id}- ${a.english||"Surah"}`})));const t=r.find(a=>a.id===Number(c));e&&n(`${c}- ${t?.english||"Surah"}`)}catch{e&&n(`${c}- Surah`)}})(),()=>{e=!1}},[c]),u.useEffect(()=>{let e=!0;return(async()=>{try{const r=await Wt();if(!e)return;const a=r.find(f=>f.number===Number(c))?.ayahs||286,l=Array.from({length:a},(f,I)=>String(I+1));gt(l)}catch{e&&gt(Array.from({length:50},(t,a)=>String(a+1)))}})(),()=>{e=!1}},[c]);const It=()=>{},kt=()=>{},wt=e=>{tt(parseInt(e,10))},Nt=e=>{T(String(e))},St=async()=>{const e=i-1;if(e>=1)try{const a=/^\d+$/.test(p)?await O(c,parseInt(p,10),e,d):await H(c,p,e,d),l=Array.isArray(a)?a:[a];if(l.length>0&&!(l.length===1&&(!l[0]||Object.keys(l[0]).length===0))&&!(l.length===1&&l[0].Interpretation==="")){D(e);return}}catch{}const r=String(p);if(/^\d+$/.test(r)){const t=parseInt(r,10);if(t<=1){j("Already at the first verse of this surah");return}const a=t-1;try{const l=await O(c,a,i,d),f=Array.isArray(l)?l:[l];if(f.length>0&&!(f.length===1&&(!f[0]||Object.keys(f[0]).length===0))&&!(f.length===1&&f[0].Interpretation===""))T(String(a)),D(i);else{let g=0;for(let m=1;m<i;m++)try{const v=await O(c,a,m,d),x=Array.isArray(v)?v:[v];if(x.length>0&&!(x.length===1&&(!x[0]||Object.keys(x[0]).length===0))&&!(x.length===1&&x[0].Interpretation===""))g=m;else break}catch{break}g>0?(T(String(a)),D(g)):j("No interpretations available for the previous verse")}}catch{T(String(a)),D(1)}}else if(/^(\d+)-(\d+)$/.test(r)){const t=r.match(/^(\d+)-(\d+)$/);if(t){const[,a,l]=t,f=parseInt(a,10),g=parseInt(l,10)-f+1;if(f<=1){j("Already at the first block of this surah");return}const m=Math.max(1,f-g),v=m+g-1,x=`${m}-${v}`;try{const C=await H(c,x,i,d),E=Array.isArray(C)?C:[C];if(E.length>0&&!(E.length===1&&(!E[0]||Object.keys(E[0]).length===0))&&!(E.length===1&&E[0].Interpretation===""))T(x),D(i);else{let V=0;for(let k=1;k<i;k++)try{const y=await H(c,x,k,d),b=Array.isArray(y)?y:[y];if(b.length>0&&!(b.length===1&&(!b[0]||Object.keys(b[0]).length===0))&&!(b.length===1&&b[0].Interpretation===""))V=k;else break}catch{break}if(V>0)T(x),D(V);else{let k=!1;for(let y=v;y>=m&&y>=1;y--)try{let b=0;for(let F=1;F<i;F++)try{const Z=await O(c,y,F,d),J=Array.isArray(Z)?Z:[Z];if(J.length>0&&!(J.length===1&&(!J[0]||Object.keys(J[0]).length===0))&&!(J.length===1&&J[0].Interpretation===""))b=F;else break}catch{break}if(b>0){T(String(y)),D(b),k=!0;break}}catch{}k||j("No more interpretations available in this surah")}}}catch{let E=!1;for(let $=v;$>=m&&$>=1;$--)try{let V=0;for(let k=1;k<i;k++)try{const y=await O(c,$,k,d),b=Array.isArray(y)?y:[y];if(b.length>0&&!(b.length===1&&(!b[0]||Object.keys(b[0]).length===0))&&!(b.length===1&&b[0].Interpretation===""))V=k;else break}catch{break}if(V>0){T(String($)),D(V),E=!0;break}}catch{}E||j("No more interpretations available in this surah")}}}},At=async()=>{const e=i+1;try{const a=/^\d+$/.test(p)?await O(c,parseInt(p,10),e,d):await H(c,p,e,d),l=Array.isArray(a)?a:[a];if(l.length>0&&!(l.length===1&&(!l[0]||Object.keys(l[0]).length===0))&&!(l.length===1&&l[0].Interpretation==="")){D(e);return}else{const I=String(p);let g;if(/^\d+$/.test(I)){const m=parseInt(I,10),v=P.length>0?parseInt(P[P.length-1],10):286;if(m>=v){j("Already at the last verse of this surah");return}g=String(m+1)}else if(/^(\d+)-(\d+)$/.test(I)){const m=I.match(/^(\d+)-(\d+)$/);if(m){const[,v,x]=m,C=parseInt(v,10),E=parseInt(x,10),$=E-C+1,V=P.length>0?parseInt(P[P.length-1],10):286;if(E>=V){j("Already at the last block of this surah");return}const k=C+$,y=Math.min(V,k+$-1);g=`${k}-${y}`}}if(g)try{const v=/^\d+$/.test(g)?await O(c,parseInt(g,10),e,d):await H(c,g,e,d),x=Array.isArray(v)?v:[v];if(x.length>0&&!(x.length===1&&(!x[0]||Object.keys(x[0]).length===0))&&!(x.length===1&&x[0].Interpretation==="")){T(g),D(e);return}}catch{}}}catch{}const r=String(p);if(/^\d+$/.test(r)){const t=parseInt(r,10),a=P.length>0?parseInt(P[P.length-1],10):286;if(t>=a){j("Already at the last verse of this surah");return}const l=t+1;T(String(l)),D(1)}else if(/^(\d+)-(\d+)$/.test(r)){const t=r.match(/^(\d+)-(\d+)$/);if(t){const[,a,l]=t,f=parseInt(a,10),I=parseInt(l,10),g=I-f+1,m=P.length>0?parseInt(P[P.length-1],10):286;if(I>=m){j("Already at the last block of this surah");return}const v=f+g,x=Math.min(m,v+g-1),C=`${v}-${x}`;try{const E=await H(c,C,1,d),$=Array.isArray(E)?E:[E];if($.length>0&&!($.length===1&&(!$[0]||Object.keys($[0]).length===0))&&!($.length===1&&$[0].Interpretation===""))T(C),D(1);else{let k=!1;for(let y=v;y<=x&&y<=m;y++)try{const b=await O(c,y,1,d),F=Array.isArray(b)?b:[b];if(F.length>0&&!(F.length===1&&(!F[0]||Object.keys(F[0]).length===0))&&!(F.length===1&&F[0].Interpretation==="")){T(String(y)),D(1),k=!0;break}}catch{}k||j("No more interpretations available in this surah")}}catch{let $=!1;for(let V=v;V<=x&&V<=m;V++)try{const k=await O(c,V,1,d),y=Array.isArray(k)?k:[k];if(y.length>0&&!(y.length===1&&(!y[0]||Object.keys(y[0]).length===0))&&!(y.length===1&&y[0].Interpretation==="")){T(String(V)),D(1),$=!0;break}}catch{}$||j("No more interpretations available in this surah")}}}},jt=async()=>{try{ht(!0);const e=mt.getEffectiveUserId(A);await mt.addBlockInterpretationBookmark(e,c,p,h,i,d),R(`Saved interpretation for Surah ${c}, verses ${p}`)}catch(e){console.error("Failed to bookmark interpretation",e),j("Failed to save interpretation bookmark")}finally{setTimeout(()=>ht(!1),300)}},$t=async()=>{const e=`Interpretation ${i} — Surah ${c} • Range ${p}`,r=window.location.href;try{navigator.share?await navigator.share({title:document.title||"Thafheem",text:e,url:r}):(await navigator.clipboard.writeText(`${e}
${r}`),R("Link copied to clipboard"))}catch(t){console.error("Share failed",t),j("Share failed: "+t.message)}},Tt=e=>{const r=/^\d+/.exec(String(p))?.[0]||"1",t=`/word-by-word/${c}/${r}`;e?.ctrlKey||e?.metaKey?(e?.preventDefault(),window.open(t,"_blank","noopener,noreferrer")):q(t,{state:{from:w.pathname+w.search}})},Dt=e=>({N895:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N895</h3>
          <p>ലാത്ത് - ഇത് ഒരു പ്രാചീന അറബ് ദേവതയുടെ പേരാണ്. ഇസ്ലാമിന് മുമ്പുള്ള അറേബ്യയിൽ ഈ ദേവതയെ ആരാധിച്ചിരുന്നു.</p>
          <p>ഖുർആനിൽ ഈ ദേവതയെ പരാമർശിക്കുന്നത് ബഹുദൈവവാദത്തിന്റെ തെറ്റിനെ വിശദീകരിക്കാനാണ്.</p>
        </div>
      `,N189:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N189</h3>
          <p>ഉസ്സ - ഇതും ഒരു പ്രാചീന അറബ് ദേവതയാണ്. ലാത്ത്, ഉസ്സ, മനാത് എന്നിവ മക്കയിലെ പ്രധാന ദേവതകളായിരുന്നു.</p>
          <p>ഇവയെ "അല്ലാഹുവിന്റെ പുത്രിമാർ" എന്ന് അവർ വിളിച്ചിരുന്നു.</p>
        </div>
      `,N1514:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N1514</h3>
          <p>നബി(സ) തിരുമേനി ആ സന്ദർഭത്തിൽ അകപ്പെട്ടിരുന്ന സ്ഥിതിവിശേഷമാണിവിടെ സൂചിപ്പിക്കുന്നത്.</p>
          <p>നബി(സ)ക്കും സഹചാരികൾക്കും എതിരാളികൾ ഏൽപിച്ചിരുന്ന ദണ്ഡനപീഡനങ്ങളല്ല തിരുമേനിയെ ദുഃഖാകുലനാക്കിയിരുന്നതെന്ന് ഇതിൽനിന്ന് വ്യക്തമാണ്.</p>
        </div>
      `,N1462:`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note N1462</h3>
          <p>മുസ്ലിം ഹദീസ് ശേഖരത്തിലെ 1462-ാം നമ്പർ ഹദീസിനെ സൂചിപ്പിക്കുന്നു.</p>
          <p>ഈ ഹദീസ് നബി(സ)യുടെ ഉദാഹരണങ്ങളെക്കുറിച്ച് പ്രതിപാദിക്കുന്നു.</p>
        </div>
      `,"3 26:3":`
        <div class="note-content">
          <h3 style="color: #2AA0BF; margin-bottom: 10px;">Verse Reference 3:26:3</h3>
          <p>അശ്ശുഅറാഅ് സൂറയിലെ 26-ാം വാക്യത്തിന്റെ 3-ാം ഭാഗത്തെ സൂചിപ്പിക്കുന്നു.</p>
          <p>ഈ വാക്യം കവികളെക്കുറിച്ചും അവരുടെ പിന്തുടർച്ചക്കാരെക്കുറിച്ചും പ്രതിപാദിക്കുന്നു.</p>
        </div>
      `})[e]||null,lt=async e=>{rt({id:e,content:"Loading..."}),pt(!0);const r=Dt(e);r&&rt({id:e,content:r});try{const t=await Kt(e),a=t?.NoteText||t?.content||t?.html||t?.text||t?.body||t?.description||t?.note||(typeof t=="string"?t:null);a&&a!=="Note content not available"&&rt({id:e,content:a})}catch(t){!t.message?.includes("500")&&!t.message?.includes("Network error")&&console.warn(`Failed to fetch note ${e}:`,t.message),r||rt({id:e,content:`
            <div class="note-content">
              <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note ${e}</h3>
              <p style="color: #666;">Note content is temporarily unavailable. Please try again later.</p>
            </div>
          `})}},nt=e=>{e.preventDefault(),e.stopPropagation();const r=e.target,t=r.getAttribute("data-type"),a=r.getAttribute("data-value"),l=r.innerText||r.textContent||"";if(!l)return;if(t==="verse"||t==="range"){const g=a||l,m=g.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||g.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(m){const[,x,C]=m;K({surahId:parseInt(x,10),verseId:parseInt(C,10),interpretationNo:i,language:d}),L(!0);return}const v=g.match(/^\(?(\d+)\s*[:：]\s*(\d+)\)?$/);if(v){const[,x,C]=v;K({surahId:parseInt(x,10),verseId:parseInt(C,10),interpretationNo:i,language:d}),L(!0);return}}else if(t==="note"){lt(a||l);return}const f=l.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||l.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(f){const[,g,m]=f;K({surahId:parseInt(g,10),verseId:parseInt(m,10),interpretationNo:i,language:d}),L(!0);return}const I=l.match(/^\(?(\d+)\s*[:：]\s*(\d+)\)?$/);if(I){const[,g,m]=I;K({surahId:parseInt(g,10),verseId:parseInt(m,10),interpretationNo:i,language:d}),L(!0);return}lt(l)};u.useEffect(()=>(window.handleNoteHighlightClick=nt,()=>{delete window.handleNoteHighlightClick}),[]);const Vt=()=>{setTimeout(Y,50)};u.useEffect(()=>(window.restoreStyling=Vt,()=>{delete window.restoreStyling}),[]);const Et=e=>{const r=e.target;if(r.tagName==="SUP"||r.tagName==="A"){nt(e);return}const t=r.innerText||r.textContent||"",a=t.match(/N(\d+)/);if(a){const I=`N${a[1]}`;lt(I);return}const l=t.match(/അശ്ശുഅറാഅ്,?\s*സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/)||t.match(/സൂക്തം:\s*(\d+)\s+(\d+):(\d+)/);if(l){const[,I,g]=l;K({surahId:parseInt(I,10),verseId:parseInt(g,10),interpretationNo:i,language:d}),L(!0);return}const f=t.match(/\(?(\d+)\s*[:：]\s*(\d+)\)?/);if(f){const[,I,g]=f;K({surahId:parseInt(I,10),verseId:parseInt(g,10),interpretationNo:i,language:d}),L(!0);return}},Ct=e=>{const r=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];return e.toString().split("").map(t=>r[t]||t).join("")},ct=e=>{if(!e||typeof e!="string")return e;const r=document.createElement("div");r.innerHTML=e;const t=document.createTreeWalker(r,NodeFilter.SHOW_TEXT,null,!1),a=[];let l;for(;l=t.nextNode();)a.push(l);return a.forEach(f=>{const I=f.textContent,g=I.replace(/\((\d+)\)/g,(m,v)=>`(${Ct(v)})`);g!==I&&(f.textContent=g)}),r.innerHTML},Bt=e=>{if(e==null)return"";if(typeof e=="string")return ct(e);const r=["interpret_text","InterpretText","Interpret_Text","interpretation","Interpretation","text","Text","content","Content","meaning","Meaning","body","Body","desc","Desc","description","Description"];for(const t of r)if(typeof e[t]=="string"&&e[t].trim().length>0)return ct(e[t]);for(const[t,a]of Object.entries(e))if(typeof a=="string"&&a.trim().length>20)return ct(a);return console.warn("⚠️ No valid interpretation text found in item:",e),`<p class="text-gray-500 italic">No interpretation content available for interpretation ${i}</p>`};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
        /* Specific styling for note and verse markers in interpretation content */
        .interpretation-content sup[data-type="note"], 
        .interpretation-content a[data-type="note"],
        .interpretation-content sup[data-type="verse"], 
        .interpretation-content a[data-type="verse"] {
          transition: all 0.2s ease !important;
          color: #2AA0BF !important;
          font-weight: 600 !important;
          cursor: pointer !important;
          text-decoration: none !important;
        }
        
        .interpretation-content sup[data-type="note"]:hover, 
        .interpretation-content a[data-type="note"]:hover,
        .interpretation-content sup[data-type="verse"]:hover, 
        .interpretation-content a[data-type="verse"]:hover {
          color: #1e7a8c !important;
          text-decoration: underline !important;
          transform: scale(1.05) !important;
        }
        
        /* Fallback for elements without data-type but with note/verse patterns */
        .interpretation-content sup:not([data-type]), 
        .interpretation-content a:not([data-type]) {
          color: #2AA0BF !important;
          font-weight: 600 !important;
          cursor: pointer !important;
          text-decoration: none !important;
          transition: all 0.2s ease !important;
        }
        
        .interpretation-content sup:not([data-type]):hover, 
        .interpretation-content a:not([data-type]):hover {
          color: #1e7a8c !important;
          text-decoration: underline !important;
          transform: scale(1.05) !important;
        }
        `}),s.jsx(Jt,{interpretationNumber:i,surahName:h,verseRange:p.replace(/-/g," - "),backTo:w.state?.from||void 0,onClose:o.onClose||w.state?.onClose,onSelectSurah:It,onSelectRange:kt,onBookmark:jt,onShare:$t,onWordByWord:Tt,bookmarking:at,surahOptions:vt,rangeOptions:P,onPickSurah:wt,onPickRange:Nt,onPrev:St,onNext:At},`navbar-${c}-${p}-${i}`),s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white dark:bg-[#2A2C38]",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4 text-sm",children:[s.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["Surah: ",c]}),s.jsxs("span",{className:"font-bold text-cyan-600 dark:text-cyan-400 text-base",children:["• Range: ",p]}),s.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["• Interpretation: ",i]}),s.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["• Lang: ",d]})]}),X&&s.jsx("div",{className:"text-center py-8 text-gray-600 dark:text-gray-300",children:"Loading interpretation…"}),_&&s.jsx("div",{className:"text-red-600 dark:text-red-400 py-4",children:_}),!X&&!_&&N.length===0&&s.jsx("div",{className:"text-center py-10 text-gray-600 dark:text-gray-300",children:"No interpretation found for this selection."}),s.jsx("div",{className:"space-y-6",children:N.map((e,r)=>s.jsx("div",{className:"bg-gray-50 p-6 rounded-lg border-l-4 dark:bg-[#2A2C38] dark:border-[#2A2C38] border-white",children:s.jsx("div",{className:"interpretation-content text-gray-800 dark:text-white  text-justify whitespace-pre-wrap prose prose-sm dark:prose-invert max-w-none",ref:t=>ut.current[r]=t,onClick:Et,style:{pointerEvents:"auto",position:"relative",zIndex:1,fontFamily:d==="hi"?"NotoSansDevanagari, sans-serif":d==="ur"?"JameelNoori, sans-serif":d==="bn"?"SutonnyMJ, sans-serif":d==="ta"?"Bamini, sans-serif":d==="mal"?"NotoSansMalayalam, sans-serif":"Poppins, sans-serif"},dangerouslySetInnerHTML:{__html:Bt(e)}})},`${c}-${p}-${i}-${e?.ID||e?.id||r}`))},`block-${c}-${p}-${i}`)]}),s.jsx(Ut,{isOpen:ot,onClose:()=>pt(!1),noteId:ft.id,noteContent:ft.content}),it&&W.surahId&&W.verseId&&s.jsx(Yt,{surahId:W.surahId,verseId:W.verseId,interpretationNo:W.interpretationNo,language:W.language,onClose:()=>L(!1)}),s.jsx(xt,{toasts:M,removeToast:st})]})};export{de as default};
