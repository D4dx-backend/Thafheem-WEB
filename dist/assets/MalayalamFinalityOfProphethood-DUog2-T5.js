import{i as N,j as e,ay as C,az as M}from"./index-ZyCXWqTv.js";import{u as S,b as i}from"./react-vendor-v5ei6ytj.js";const E=()=>{const f=S(),{translationLanguage:k}=N(),s=k==="mal",[h,u]=i.useState([]),[c,p]=i.useState(!0),[x,y]=i.useState(null),[n,m]=i.useState({open:!1,code:"",content:"",loading:!1,error:null}),v=(t=0)=>t<=400?"max-w-lg":t<=1200?"max-w-2xl":t<=2e3?"max-w-3xl":"max-w-4xl";i.useEffect(()=>{let t=!0;return(async()=>{try{p(!0),y(null);const a=await C();if(!t)return;u(a.sections||[]),a.error&&y("Unable to fetch content from the server.")}catch{t&&(y("Unable to load content. Please try again later."),u([]))}finally{t&&p(!1)}})(),()=>{t=!1}},[]);const w=async(t,d)=>{const a=t.target.closest(".note-marker");if(!a)return;const o=a.getAttribute("data-code");m({open:!0,code:o,content:"Loading...",loading:!0,error:null});try{let l="";const g=await M(o);if(g?.footnote_text)l=g.footnote_text;else if(g?.error)throw new Error(g.error);if(!l){const r=d?.raw||{};l=r.notes||r.Notes||r.note||r.Note||r.comments||r.Comments||r.commentary||r.Commentary||""}m({open:!0,code:o,content:l||"Note content not available.",loading:!1,error:null})}catch(l){m({open:!0,code:o,content:"Note content not available.",loading:!1,error:l?.message||"Unable to load note."})}},b=(t,d)=>t&&t.replace(/\b([PHN]\d{1,5})\b/g,(a,o)=>`<button type="button" class="note-marker" data-code="${o}">${o}</button>`),j=()=>{window.history.state&&window.history.state.idx>0?f(-1):f("/")};return e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 font-poppins",children:e.jsxs("div",{className:"max-w-[1070px] w-full mx-auto px-4 sm:px-6 py-8",children:[e.jsx("button",{onClick:j,className:"text-sm text-cyan-600 dark:text-cyan-400 hover:underline mb-4",children:"← Back"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:`text-3xl font-bold text-gray-900 mb-2 dark:text-white ${s?"font-malayalam":""}`,children:s?"പ്രവാചകത്വത്തിന്റെ അന്ത്യം":"The Finality of Prophethood"}),e.jsx("div",{className:"mt-4 h-px bg-gray-200 dark:bg-gray-700"})]}),c&&e.jsx("div",{className:"py-10 text-center text-gray-600 dark:text-gray-300",children:s?"ഉള്ളടക്കം ലോഡുചെയ്യുന്നു...":"Loading content..."}),!c&&x&&e.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-200",children:x}),!c&&!x&&h.length===0&&e.jsx("div",{className:"py-10 text-center text-gray-600 dark:text-gray-300",children:s?"ഇപ്പോൾ ഉള്ളടക്കം ലഭ്യമല്ല.":"Content is not available at the moment."}),!c&&!x&&h.length>0&&e.jsx("div",{className:"space-y-8",children:h.map((t,d)=>e.jsxs("section",{className:"bg-white dark:bg-[#1b1d27] rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 p-5 sm:p-7",onClick:a=>w(a,t),children:[t.title&&e.jsx("div",{className:`mb-4 prose prose-lg dark:prose-invert max-w-none ${s?"font-malayalam":""}`,dangerouslySetInnerHTML:{__html:b(t.title)}}),e.jsx("div",{className:`prose prose-sm sm:prose-base dark:prose-invert max-w-none leading-relaxed text-gray-800 dark:text-gray-200 ${s?"font-malayalam":""}`,dangerouslySetInnerHTML:{__html:b(t.text||"")},style:{lineHeight:1.8,textAlign:"justify"}})]},t.id||d))}),n.open&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4",children:e.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-xl shadow-xl w-full ${v(n.content?.length||0)} max-w-[95vw] max-h-[90vh] flex flex-col overflow-hidden border border-gray-200 dark:border-gray-700`,children:[e.jsxs("div",{className:"flex items-start justify-between p-5 sm:p-6 pb-3 flex-shrink-0 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-malayalam",children:"കുറിപ്പ്"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n.code})]}),e.jsx("button",{onClick:()=>m({open:!1,code:"",content:"",loading:!1,error:null}),className:"text-sm text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-5 sm:p-6 pt-4 overflow-y-auto flex-1",children:[n.loading?e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Loading..."}):e.jsx("div",{className:"text-sm leading-relaxed text-gray-800 dark:text-gray-200 font-malayalam whitespace-pre-wrap break-words text-justify",style:{textAlign:"justify"},children:n.content}),n.error&&e.jsx("div",{className:"mt-3 text-xs text-red-600 dark:text-red-300",children:n.error})]})})]})}),e.jsx("style",{children:`
          .note-marker {
            color: #0891b2;
            border: none;
            background: transparent;
            padding: 0 2px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: color 0.15s ease;
          }
          .note-marker:hover {
            color: #04748d;
          }
          .note-marker:focus {
            outline: none;
            text-decoration: underline;
          }
        `})]})})};export{E as default};
