import{i as j,j as e,aA as M,aB as C}from"./index-D80Klju5.js";import{u as S,b as i}from"./react-vendor-v5ei6ytj.js";const $=()=>{const h=S(),{translationLanguage:k}=j(),a=k==="mal",[g,u]=i.useState([]),[c,p]=i.useState(!0),[x,f]=i.useState(null),[o,m]=i.useState({open:!1,code:"",content:"",loading:!1,error:null}),v=(t=0)=>t<=400?"max-w-lg":t<=1200?"max-w-2xl":t<=2e3?"max-w-3xl":"max-w-4xl";i.useEffect(()=>{let t=!0;return(async()=>{try{p(!0),f(null);const r=await M();if(!t)return;u(r.sections||[]),r.error&&f("Unable to fetch content from the server.")}catch{t&&(f("Unable to load content. Please try again later."),u([]))}finally{t&&p(!1)}})(),()=>{t=!1}},[]);const N=async(t,d)=>{const r=t.target.closest(".note-marker");if(!r)return;const s=r.getAttribute("data-code");m({open:!0,code:s,content:"Loading...",loading:!0,error:null});try{let l="";const y=await C(s);if(y?.footnote_text)l=y.footnote_text;else if(y?.error)throw new Error(y.error);if(!l){const n=d?.raw||{};l=n.notes||n.Notes||n.note||n.Note||n.comments||n.Comments||n.commentary||n.Commentary||""}m({open:!0,code:s,content:l||"Note content not available.",loading:!1,error:null})}catch(l){m({open:!0,code:s,content:"Note content not available.",loading:!1,error:l?.message||"Unable to load note."})}},b=(t,d)=>t&&t.replace(/\b([PHN]\d{1,5})\b/g,(r,s)=>`<button type="button" class="note-marker" data-code="${s}">${s}</button>`),w=()=>{window.history.state&&window.history.state.idx>0?h(-1):h("/")};return e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 font-poppins",children:e.jsxs("div",{className:"max-w-[1070px] w-full mx-auto px-4 sm:px-6 py-8",children:[e.jsx("button",{onClick:w,className:"text-sm text-cyan-600 dark:text-cyan-400 hover:underline mb-4",children:"← Back"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:`text-3xl font-bold text-gray-900 mb-2 dark:text-white ${a?"font-malayalam":""}`,style:a?{fontFamily:"'NotoSansMalayalam'"}:{},children:a?"പ്രവാചകത്വത്തിന്റെ അന്ത്യം":"The Finality of Prophethood"}),e.jsx("div",{className:"mt-4 h-px bg-gray-200 dark:bg-gray-700"})]}),c&&e.jsx("div",{className:"py-10 text-center text-gray-600 dark:text-gray-300",children:a?"ഉള്ളടക്കം ലോഡുചെയ്യുന്നു...":"Loading content..."}),!c&&x&&e.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-200",children:x}),!c&&!x&&g.length===0&&e.jsx("div",{className:"py-10 text-center text-gray-600 dark:text-gray-300",children:a?"ഇപ്പോൾ ഉള്ളടക്കം ലഭ്യമല്ല.":"Content is not available at the moment."}),!c&&!x&&g.length>0&&e.jsx("div",{className:"space-y-8",children:g.map((t,d)=>e.jsxs("section",{className:"bg-white dark:bg-[#1b1d27] rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 p-5 sm:p-7",onClick:r=>N(r,t),children:[t.title&&e.jsx("div",{className:`mb-4 prose prose-lg dark:prose-invert max-w-none ${a?"font-malayalam":""}`,style:a?{fontFamily:"'NotoSansMalayalam'"}:{},dangerouslySetInnerHTML:{__html:b(t.title)}}),e.jsx("div",{className:`prose prose-sm sm:prose-base dark:prose-invert max-w-none leading-relaxed text-gray-800 dark:text-gray-200 ${a?"font-malayalam":""}`,dangerouslySetInnerHTML:{__html:b(t.text||"")},style:{lineHeight:1.8,textAlign:"justify",...a?{fontFamily:"'NotoSansMalayalam'"}:{}}})]},t.id||d))}),o.open&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4",children:e.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-xl shadow-xl w-full ${v(o.content?.length||0)} max-w-[95vw] max-h-[90vh] flex flex-col overflow-hidden border border-gray-200 dark:border-gray-700`,children:[e.jsxs("div",{className:"flex items-start justify-between p-5 sm:p-6 pb-3 flex-shrink-0 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-malayalam",children:"കുറിപ്പ്"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o.code})]}),e.jsx("button",{onClick:()=>m({open:!1,code:"",content:"",loading:!1,error:null}),className:"text-sm text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:e.jsxs("div",{className:"p-5 sm:p-6 pt-4 overflow-y-auto flex-1",children:[o.loading?e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Loading..."}):e.jsx("div",{className:"text-sm leading-relaxed text-gray-800 dark:text-gray-200 font-malayalam whitespace-pre-wrap break-words text-justify",style:{textAlign:"justify"},children:o.content}),o.error&&e.jsx("div",{className:"mt-3 text-xs text-red-600 dark:text-red-300",children:o.error})]})})]})}),e.jsx("style",{children:`
          .note-marker {
            color: #0891b2;
            border: none;
            background: transparent;
            padding: 0 2px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: color 0.15s ease;
          }
          .note-marker:hover {
            color: #04748d;
          }
          .note-marker:focus {
            outline: none;
            text-decoration: underline;
          }
        `})]})})};export{$ as default};
