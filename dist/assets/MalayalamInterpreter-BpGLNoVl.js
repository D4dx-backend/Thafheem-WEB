import{u as z,j as e,o as D,N as J,D as K,E as U,w as X}from"./index-zWRKLUWk.js";import{b as i,u as G,d as Q,h as V}from"./react-vendor-v5ei6ytj.js";import{I as Y}from"./InterpretationNavbar-BnNdja9N.js";import{A as Z}from"./WordByWord-DN1As7tc.js";import{C as tt}from"./chevron-left-8YABQ6I3.js";import"./WordByWordIcon-DxjBUJXe.js";import"./tamilWordByWordService-B0xEV9Gl.js";import"./apiService-hOh9yyny.js";import"./hindiWordByWordService-BCeNezEp.js";import"./banglaWordByWordService-DG8H3aZ-.js";import"./banglaTranslationService-DLkj577Y.js";import"./Toast-DunFfijn.js";import"./tamilTranslationService-CJsvEoeN.js";import"./hindiTranslationService-BGO3ah39.js";import"./urduTranslationService-jZuXP4Cs.js";import"./englishTranslationService-CdieVbVi.js";import"./surahNameUtils-CNmXwDjY.js";import"./surahNameUnicodes-C_pntk6C.js";const vt=()=>{const[g,A]=i.useState(!1),[S,u]=i.useState({id:"",content:""}),[v,C]=i.useState(!1),[m,B]=i.useState({surahId:null,verseId:null}),[E,P]=i.useState(!1),[j,T]=i.useState(null),[y,$]=i.useState([]),[w,H]=i.useState(6),[k,M]=i.useState("3"),[x,O]=i.useState(1),[f,_]=i.useState("en"),{quranFont:et}=z(),l=i.useRef(null);G();const c=Q(),[h]=V();i.useEffect(()=>{(async()=>{try{P(!0),T(null);const t=c.surahId?parseInt(c.surahId):parseInt(h.get("surahId"))||w,n=c.range||h.get("range")||k,o=c.ipt?parseInt(c.ipt):parseInt(h.get("ipt"))||x,p=c.lang||h.get("lang")||f;H(t),M(n),O(o),_(p);const a=/^\d+$/.test(n)?await K(t,parseInt(n,10),o,p):await U(t,n,o,p),d=Array.isArray(a)?a:[a];$(d)}catch(t){T(t.message||"Failed to load interpretation")}finally{P(!1)}})()},[c,h]);const L=async r=>{u({id:r,content:"Loading..."}),A(!0);try{const t=await X(r),n=t?.NoteText||t?.note_text||t?.content||t?.html||t?.text||t?.body||t?.description||t?.note||(typeof t=="string"?t:null);u(n&&n!=="Note content not available"?{id:r,content:n}:{id:r,content:'<p style="color: #666;">Note content is not available.</p>'})}catch(t){console.error("Error fetching note:",t),u({id:r,content:`
          <div class="note-content">
            <h3 style="color: #2AA0BF; margin-bottom: 10px;">Note ${r}</h3>
            <p style="color: #666;">Note content is temporarily unavailable. Please try again later.</p>
            <p style="color: #999; font-size: 0.9em; margin-top: 10px;">Error: ${t.message||"Unknown error"}</p>
          </div>
        `})}},W=r=>{const t=r.target;if(!(t.classList.contains("note-highlight")||t.closest(".note-highlight")||t.closest("sup")||t.closest("a")))return;const o=t.classList.contains("note-highlight")?t:t.closest(".note-highlight"),p=t.closest("sup"),s=t.closest("a"),a=(o?.innerText||p?.innerText||s?.innerText||"").trim();if(!a)return;const d=a.match(/^\(?(\d+)\s*[:：]\s*(\d+)\)?$/);if(d){const[,F,b]=d;B({surahId:parseInt(F,10),verseId:parseInt(b,10)}),C(!0);return}L(a)},I=()=>{if(!l.current)return;l.current.querySelectorAll(".note-highlight").forEach(s=>{const a=s.parentNode;a.replaceChild(document.createTextNode(s.textContent),s),a.normalize()});const t=[],n=document.createTreeWalker(l.current,NodeFilter.SHOW_TEXT,null,!1);let o;for(;o=n.nextNode();)o.parentElement&&!o.parentElement.classList.contains("note-highlight")&&!o.parentElement.closest(".note-highlight")&&o.textContent.trim()&&t.push(o);t.forEach(s=>{const a=s.textContent,d=s.parentElement;[{regex:/N\d+/g,type:"note"},{regex:/\(\d+:\d+\)/g,type:"verse"},{regex:/\d+\s+\d+:\d+/g,type:"range"}].forEach(({regex:b,type:rt})=>{if(b.test(a)){const R=a.replace(b,N=>`<span class="note-highlight" style="color: #2AA0BF !important; text-decoration: none !important; cursor: pointer !important; font-weight: 600 !important;">${N}</span>`);if(R!==a){const N=document.createElement("div");N.innerHTML=R,d.replaceChild(N.firstChild,s)}}})}),l.current.querySelectorAll("sup, a").forEach(s=>{const a=(s.innerText||"").trim();if(/^N\d+$/.test(a)){s.style.setProperty("color","#2AA0BF","important"),s.style.setProperty("text-decoration","none","important"),s.style.setProperty("cursor","pointer","important"),s.style.setProperty("font-weight","600","important");return}if(/^\(?\d+\s*[:：]\s*\d+\)?$/.test(a)){s.style.setProperty("color","#2AA0BF","important"),s.style.setProperty("text-decoration","none","important"),s.style.setProperty("cursor","pointer","important"),s.style.setProperty("font-weight","600","important");return}/^\d+\s+\d+:\d+$/.test(a)&&(s.style.setProperty("color","#2AA0BF","important"),s.style.setProperty("text-decoration","none","important"),s.style.setProperty("cursor","pointer","important"),s.style.setProperty("font-weight","600","important"))})};i.useEffect(()=>{I()},[y]),i.useEffect(()=>{!g&&!v&&setTimeout(I,100)},[g,v]),i.useEffect(()=>{if(!l.current)return;const r=new MutationObserver(t=>{let n=!1;t.forEach(o=>{(o.type==="childList"||o.type==="attributes")&&(n=!0)}),n&&setTimeout(I,50)});return r.observe(l.current,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]}),()=>r.disconnect()},[y]);const q=r=>{if(r==null)return"";if(typeof r=="string")return r;const t=["interpret_text","interpretation","text","content","meaning","body","desc","description"];for(const n of t)if(typeof r[n]=="string"&&r[n].trim().length>0)return r[n];for(const[n,o]of Object.entries(r))if(typeof o=="string"&&o.trim().length>20)return o;try{return JSON.stringify(r)}catch{return String(r)}};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
               .note-highlight {
                 color: #2AA0BF !important;
                 text-decoration: none !important;
                 cursor: pointer !important;
                 font-weight: 600 !important;
               }
               sup.note-highlight, a.note-highlight {
                 color: #2AA0BF !important;
                 text-decoration: none !important;
                 cursor: pointer !important;
                 font-weight: 600 !important;
               }
             `}),e.jsx(Y,{interpretationNumber:x,surahName:`${w}- Surah`,verseRange:k.replace(/-/g," - "),language:f,onWordByWord:()=>{}}),e.jsx("div",{className:"w-full  mx-auto p-3 sm:p-4 lg:p-6 bg-white dark:bg-[#2A2C38] max-w-[1073px] ",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("span",{children:["Surah: ",w]}),e.jsxs("span",{children:["• Range: ",k]}),e.jsxs("span",{children:["• Interpretation: ",x]}),e.jsxs("span",{children:["• Lang: ",f]}),e.jsx("button",{onClick:()=>L("N189"),className:"ml-4 px-2 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600",children:"Test Note N189"})]}),E&&e.jsx("div",{className:"text-center py-8 text-gray-600 dark:text-gray-300",children:"Loading interpretation…"}),j&&e.jsx("div",{className:"text-red-600 dark:text-red-400 py-4",children:j}),!E&&!j&&y.length===0&&e.jsx("div",{className:"text-center py-10 text-gray-600 dark:text-gray-300",children:"No interpretation found for this selection."}),y.map((r,t)=>e.jsx("div",{className:"bg-gray-50 dark:bg-[#2A2C38] p-3 sm:p-4 lg:p-6 rounded-lg border-l-4 dark:border-[#2A2C38] border-white",children:e.jsx("div",{className:"text-gray-800 dark:text-white leading-relaxed text-justify space-y-3 sm:space-y-4 prose prose-sm dark:prose-invert max-w-none",ref:l,onClick:W,style:{fontFamily:"serif"},dangerouslySetInnerHTML:{__html:q(r)}})},t)),e.jsxs("div",{className:" bottom-0 left-0 w-full flex justify-between gap-3 sm:gap-0 p-3 sm:p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-[#2A2C38] z-50",children:[e.jsxs("button",{className:`flex items-center justify-center sm:justify-start space-x-2 px-3 sm:px-4 py-2 rounded-lg border transition-colors group min-h-[44px] 
    text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-300 dark:border-gray-500`,children:[e.jsx(tt,{className:"w-3 h-3 sm:w-4 sm:h-4 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Previous Ayah"})]}),e.jsxs("button",{className:`flex items-center justify-center sm:justify-start space-x-2 px-3 sm:px-4 py-2 rounded-lg border transition-colors group min-h-[44px] 
    text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-300 dark:border-gray-500`,children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Next Ayah"}),e.jsx(D,{className:"w-3 h-3 sm:w-4 sm:h-4 group-hover:translate-x-1 transition-transform"})]})]})]})}),g&&e.jsx(J,{isOpen:g,onClose:()=>A(!1),noteId:S.id,noteContent:S.content}),v&&m.surahId&&m.verseId&&e.jsx(Z,{surahId:m.surahId,verseId:m.verseId,onClose:()=>C(!1),interpretationNo:x,language:f})]})};export{vt as default};
