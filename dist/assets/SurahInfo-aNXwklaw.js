import{i as U,j as e,p as M,N as L,x as F,y as V}from"./index-CUlJBpza.js";import{d as D,b as l,u as B,L as H}from"./react-vendor-v5ei6ytj.js";import{A as W}from"./arrow-left-BNUhNc4Q.js";const G=()=>{const{surahId:i}=D(),{translationLanguage:h}=U(),[t,T]=l.useState(null),[$,N]=l.useState(!0),[v,_]=l.useState(null),C=B(),[g,w]=l.useState(null),[p,y]=l.useState({isOpen:!1,noteId:null,loading:!1,error:null,content:null}),d=l.useRef(null);l.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]);const f=l.useCallback(a=>{w(a),d.current&&clearTimeout(d.current),a&&(d.current=setTimeout(()=>w(null),2500))},[d]),m=a=>{if(!a)return"";const s=document.createElement("div");return s.innerHTML=a,(s.textContent||s.innerText||"").replace(/\s+/g," ").trim()},I=a=>{if(!a)return[];const s=[];return a.split(/<h2[^>]*>/).forEach((n,c)=>{if(c===0&&!n.includes("</h2>")){if(n.trim()){const o=m(n);o&&s.push({title:"Introduction",content:o})}}else{const o=n.indexOf("</h2>");if(o!==-1){const b=n.substring(0,o).trim(),j=n.substring(o+5).trim(),S=m(j);b&&S&&s.push({title:m(b),content:S})}}}),s};if(l.useEffect(()=>{(async()=>{try{N(!0);const s=await F(i,h);T(s)}catch(s){_(s.message)}finally{N(!1)}})()},[i,h]),$)return e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading Surah information..."})]})});if(v)return e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 dark:text-red-400 text-lg mb-2",children:"Failed to load Surah information"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:v}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Try Again"})]})});const E=l.useMemo(()=>a=>a?a.replace(/\r\n/g,`
`).replace(/\t+/g," ").split(/\n{2,}/).map(s=>s.trim()).filter(Boolean):[],[]),x=t?.thafheem?.PrefaceText?I(t.thafheem.PrefaceText):[],k=Array.isArray(t?.thafheem?.PrefaceSections)?t.thafheem.PrefaceSections.filter(a=>a?.subtitle&&a.subtitle.trim()||a?.text&&a.text.trim()):[],u=h==="mal"&&k.length>0,P=l.useCallback(()=>{if(!t)return"";const a=t?.basic?.name_simple||t?.surah?.name||`Surah ${i}`,s=t?.basic?.name_arabic||t?.surah?.arabic||"";let r=`${a}
`;return s&&(r+=`${s}

`),r+=`Revelation: ${t?.basic?.revelation_place||t?.thafheem?.SuraType||t?.surah?.type||"Unknown"}
`,r+=`Revelation Order: ${t?.basic?.revelation_order||t?.thafheem?.RevOrder||"Unknown"}
`,r+=`Verses: ${t?.basic?.verses_count||t?.thafheem?.TotalAyas||t?.surah?.ayahs||"Unknown"}
`,t?.thafheem&&(r+=`Thafheem Vol: ${t.thafheem.ThafVolume||"Unknown"}
`,r+=`Type: ${t.thafheem.SuraType||"Unknown"}
`),r+=`
`,t?.detailed?.short_text&&(r+=`OVERVIEW
${m(t.detailed.short_text)}

`),t?.detailed?.text&&(r+=`DETAILED INFORMATION
${m(t.detailed.text)}

`),x.length>0&&(r+=`THAFHEEM COMMENTARY

`,x.forEach(n=>{r+=`${n.title}
${n.content}

`})),!t?.detailed?.text&&x.length===0&&(r+=`BASIC INFORMATION

`,t?.basic?.translated_name?.name&&(r+=`English Name: ${t.basic.translated_name.name}
`),t?.basic?.name_simple&&(r+=`Simple Name: ${t.basic.name_simple}
`),t?.basic?.revelation_place&&(r+=`Place of Revelation: ${t.basic.revelation_place}
`),t?.basic?.pages&&(r+=`Pages: ${t.basic.pages[0]} to ${t.basic.pages[1]}
`)),r+=`
— ${a} (Surah ${i})`,r},[i,t,x]),R=a=>{if(h!=="mal")return;const s=a.target.closest("sup, a");if(!s)return;const r=(s.innerText||s.textContent||"").trim();if(!r)return;let n=!1;const c=r.replace(/[\s()]+/g,"").toUpperCase();if(/^[NHB]\d+$/.test(c))n=!0,A(c);else{const o=r.match(/(\d+)\s*[:：]\s*(\d+)/);if(o){const b=parseInt(o[1],10),j=parseInt(o[2],10);Number.isFinite(b)&&Number.isFinite(j)&&(n=!0,C(`/reading/${b}?verse=${j}`))}}n&&(a.preventDefault(),a.stopPropagation())},O=async()=>{if(!t)return;if(typeof navigator>"u"){f("error");return}const a=t?.basic?.name_simple||t?.surah?.name||`Surah ${i}`,s=P(),r=typeof window<"u"?`${window.location.origin}/surah/${i}`:"",n={title:`${a} - Surah Information`,text:s,url:r||void 0};try{if(navigator.share&&(!navigator.canShare||navigator.canShare(n)))await navigator.share(n),f("shared");else{const c=r?`${s}

Read more: ${r}`:s;navigator.clipboard?.writeText?(await navigator.clipboard.writeText(c),f("copied")):f("error")}}catch(c){console.error("Error sharing Surah information:",c),f("error")}},A=async a=>{y({isOpen:!0,noteId:a,loading:!0,error:null,content:null});try{const s=await V(a);y(r=>({...r,loading:!1,content:s&&(s.NoteText||s.html||s.content||s.text)||s||"Note content unavailable."}))}catch(s){y(r=>({...r,loading:!1,error:s?.message||"Unable to load this note at the moment. Please try again."}))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white px-3 sm:px-4 lg:px-6 py-4 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{to:`/surah/${i}`,children:e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors mr-3 sm:mr-4",children:e.jsx(W,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 dark:text-white"})})}),e.jsx("h1",{className:"text-base sm:text-lg lg:text-xl font-semibold text-gray-900 dark:text-white",children:t?.basic?.name_simple||t?.surah?.name||`Surah ${i}`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:O,disabled:!t,className:"p-2 rounded-lg border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Share Surah information",children:e.jsx(M,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),g&&e.jsx("span",{className:`text-xs sm:text-sm ${g==="error"?"text-red-500":"text-green-500"}`,children:g==="copied"?"Copied":g==="shared"?"Shared":"Share failed"})]})]})}),e.jsxs("div",{className:"w-full max-w-[1290px] mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6",children:[e.jsxs("div",{className:"text-center mb-6 sm:mb-8 border-b border-gray-200 dark:border-white pb-4 sm:pb-6 font-poppins",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-arabic text-black mb-4 sm:mb-6 dark:text-white px-2",children:t?.basic?.name_arabic||t?.surah?.arabic||`Surah ${i}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-x-6 sm:gap-x-8 md:gap-x-12 lg:gap-x-15 gap-y-2 sm:gap-y-4 text-xs sm:text-sm text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-black dark:text-white",children:"Revelation: "}),e.jsx("span",{className:"font-semibold text-black dark:text-white",children:t?.basic?.revelation_place||t?.thafheem?.SuraType||t?.surah?.type||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-black dark:text-white",children:"Revelation Order: "}),e.jsx("span",{className:"font-semibold text-black dark:text-white",children:t?.basic?.revelation_order||t?.thafheem?.RevOrder||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-black dark:text-white",children:"Verses: "}),e.jsx("span",{className:"font-semibold text-black dark:text-white",children:t?.basic?.verses_count||t?.thafheem?.TotalAyas||t?.surah?.ayahs||"Unknown"})]})]}),t?.thafheem&&e.jsxs("div",{className:"flex flex-wrap justify-center gap-x-6 sm:gap-x-8 md:gap-x-12 lg:gap-x-15 gap-y-2 sm:gap-y-4 mt-2 sm:mt-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-black dark:text-white text-xs sm:text-sm",children:"Thafheem Vol: "}),e.jsx("span",{className:"font-semibold text-black dark:text-white text-xs sm:text-sm",children:t.thafheem.ThafVolume||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-black dark:text-white text-xs sm:text-sm",children:"Type: "}),e.jsx("span",{className:"font-semibold text-black dark:text-white text-xs sm:text-sm",children:t.thafheem.SuraType||"Unknown"})]})]})]})]}),e.jsxs("div",{className:"font-poppins",children:[u&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[h==="mal"&&e.jsx("style",{children:`
                    .surah-preface-content sup.f-noteno,
                    .surah-preface-content a.crs {
                      color: #2AA0BF !important;
                      cursor: pointer !important;
                      text-decoration: none !important;
                    }

                    .surah-preface-content sup.f-noteno:hover,
                    .surah-preface-content a.crs:hover {
                      text-decoration: underline !important;
                    }
                  `}),e.jsx("div",{className:"text-gray-700 leading-relaxed dark:text-white text-sm sm:text-base lg:text-lg px-1 sm:px-0 space-y-4 surah-preface-content",onClick:R,children:k.map((a,s)=>{const r=E(a.text);return e.jsxs("div",{className:"space-y-3",children:[a.subtitle?e.jsx("h4",{className:"text-base sm:text-lg lg:text-xl font-semibold text-cyan-500",children:a.subtitle}):null,r.map((n,c)=>e.jsx("p",{className:"mb-2 sm:mb-3",dangerouslySetInnerHTML:{__html:n}},c))]},s)})})]}),!u&&t?.detailed?.short_text&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-cyan-600 mb-3 sm:mb-4",children:"Overview"}),e.jsx("p",{className:"text-gray-700 leading-relaxed dark:text-white text-sm sm:text-base lg:text-lg px-1 sm:px-0",children:m(t.detailed.short_text)})]}),!u&&t?.detailed?.text&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-cyan-600 mb-3 sm:mb-4",children:"Detailed Information"}),e.jsx("div",{className:"text-gray-700 leading-relaxed dark:text-white text-sm sm:text-base lg:text-lg px-1 sm:px-0 space-y-4",children:m(t.detailed.text).split(`

`).map((a,s)=>e.jsx("p",{className:"mb-4",children:a.trim()},s))})]}),!u&&x.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-cyan-600 mb-3 sm:mb-4",children:"Thafheem Commentary"}),e.jsx("div",{className:"space-y-6",children:x.map((a,s)=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-base sm:text-lg lg:text-xl font-semibold text-cyan-500 mb-2 sm:mb-3",children:a.title}),e.jsx("div",{className:"text-gray-700 leading-relaxed dark:text-white text-sm sm:text-base lg:text-lg px-1 sm:px-0",children:a.content.split(`
`).filter(r=>r.trim()).map((r,n)=>e.jsx("p",{className:"mb-3 sm:mb-4",children:r.trim()},n))})]},s))})]}),!t?.detailed?.text&&x.length===0&&!u&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-cyan-600 mb-3 sm:mb-4",children:"Basic Information"}),e.jsxs("div",{className:"text-gray-700 leading-relaxed dark:text-white text-sm sm:text-base lg:text-lg px-1 sm:px-0 space-y-4",children:[t?.basic?.translated_name?.name&&e.jsxs("p",{children:[e.jsx("strong",{children:"English Name:"})," ",t.basic.translated_name.name]}),t?.basic?.name_simple&&e.jsxs("p",{children:[e.jsx("strong",{children:"Simple Name:"})," ",t.basic.name_simple]}),t?.basic?.revelation_place&&e.jsxs("p",{children:[e.jsx("strong",{children:"Place of Revelation:"})," ",t.basic.revelation_place]}),t?.basic?.pages&&e.jsxs("p",{children:[e.jsx("strong",{children:"Pages:"})," ",t.basic.pages[0]," to ",t.basic.pages[1]]}),!t?.basic?.translated_name&&e.jsx("p",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Detailed information for this Surah is not available at the moment."})]})]})]})]})]}),e.jsx(L,{isOpen:p.isOpen,noteId:p.noteId,noteContent:p.content,loading:p.loading,error:p.error,onClose:()=>y(a=>({...a,isOpen:!1}))})]})};export{G as default};
