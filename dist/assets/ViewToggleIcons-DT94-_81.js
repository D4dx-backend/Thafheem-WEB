import{j as d}from"./index-B7u_SSOz.js";const w="ThafheemTranslations",g=1,s="translations",C=30;class E{constructor(){this.db=null,this.initPromise=this.initDB()}async initDB(){return new Promise((r,n)=>{const e=indexedDB.open(w,g);e.onerror=()=>n(e.error),e.onsuccess=()=>{this.db=e.result,r(this.db)},e.onupgradeneeded=t=>{const o=t.target.result;o.objectStoreNames.contains(s)||o.createObjectStore(s,{keyPath:"key"}).createIndex("expiry","expiry",{unique:!1})}})}generateCacheKey(r,n,e="E"){const t=e?.toLowerCase()||"E";return`translation_${r}_${n}_${t}`}async getCachedTranslation(r,n,e="E"){try{if(await this.initPromise,!this.db)return null;const t=this.generateCacheKey(r,n,e),c=this.db.transaction([s],"readonly").objectStore(s);return new Promise(i=>{const a=c.get(t);a.onsuccess=()=>{const A=a.result;if(!A){i(null);return}const l=Date.now();if(A.expiry&&l>A.expiry){this.deleteCachedTranslation(r,n,e),i(null);return}i(A.data)},a.onerror=()=>i(null)})}catch(t){return console.error("Error getting cached translation:",t),null}}async setCachedTranslation(r,n,e,t="E"){try{if(await this.initPromise,!this.db)return!1;const o=this.generateCacheKey(r,n,t),c=Date.now()+C*24*60*60*1e3,a=this.db.transaction([s],"readwrite").objectStore(s);return new Promise(A=>{const l=a.put({key:o,data:e,expiry:c,timestamp:Date.now()});l.onsuccess=()=>{A(!0)},l.onerror=()=>{console.error("Error setting cached translation:",l.error),A(!1)}})}catch(o){return console.error("Error setting cached translation:",o),!1}}async deleteCachedTranslation(r,n,e="E"){try{if(await this.initPromise,!this.db)return!1;const t=this.generateCacheKey(r,n,e),c=this.db.transaction([s],"readwrite").objectStore(s);return new Promise(i=>{const a=c.delete(t);a.onsuccess=()=>i(!0),a.onerror=()=>i(!1)})}catch(t){return console.error("Error deleting cached translation:",t),!1}}async clearExpiredCache(){try{if(await this.initPromise,!this.db)return 0;const e=this.db.transaction([s],"readwrite").objectStore(s).index("expiry");return new Promise(t=>{const o=e.openCursor(IDBKeyRange.upperBound(Date.now()));let c=0;o.onsuccess=i=>{const a=i.target.result;a?(a.delete(),c++,a.continue()):t(c)},o.onerror=()=>t(0)})}catch(r){return console.error("Error clearing expired cache:",r),0}}async getCacheStats(){try{if(await this.initPromise,!this.db)return{total:0,expired:0,size:"0 KB"};const n=this.db.transaction([s],"readonly").objectStore(s);return new Promise(e=>{const t=n.count();t.onsuccess=()=>{const o=t.result;e({total:o,expired:0,size:"Unknown"})},t.onerror=()=>e({total:0,expired:0,size:"0 KB"})})}catch(r){return console.error("Error getting cache stats:",r),{total:0,expired:0,size:"0 KB"}}}async clearAllCache(){try{if(await this.initPromise,!this.db)return!1;const n=this.db.transaction([s],"readwrite").objectStore(s);return new Promise(e=>{const t=n.clear();t.onsuccess=()=>{e(!0)},t.onerror=()=>e(!1)})}catch(r){return console.error("Error clearing all cache:",r),!1}}}const k=new E,p="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIFSURBVHgB7dzhTQJBEAXgp/G/duDZgR2wHUAH0gFYAbECpALpBOxAK2A7wA5wN2siuTtNlrcHN/C+ZGLuF9zzdhm4ywAiIiIiIiJizBXKcKGGoe5ggw/1HmqNE5uG2obaGa1NqCecQLzSlrAZWlvNcWRL2A6srd5wgEP2wHHLi30hhfoBGxzSedQ9h3pFxzZo7iMV7KnQPJctOjZC89KvYFeF5oegQ4Zr5BnUjpdILYFVHukc9g2RITfAep+3hn2fteOsXjY3QKlRgKQblBMv/fjN5B795kMtkFovWskAJ6FmsOMFBWgJk0pegYufvxX6zeP3vdJKBhj3lCLLwhItYZICJClAkoU+0KNg31aapT6wlx9QWsIkC32gR8G+rTT1gSQtYZICJClAkgIkKUCSAiQpQJICJClAkgIkKUCSAiQpQJICJClA0iU8G+PR4T2VS3o2ppMfe7WESZfwbIxHh/dUdE+EpCVMUoAkBUjSszEkPRtD0hIm6dkYkvpAkpYwSQGSFCBJAZLYAK3MifnPLQi5AdaHSoxgn6sddzo4w6E5M8HBrjGa5/OIjq3QnHQxhT1tU5dWyHTI3Bj3xwt5pMu/l1/698R926F9/37AkYZoxP/e7sxqhiOzPnhsfwua4EQqpDFQFoOM73kO8sePUvMDowHSvmKhN4yzYjz6v1+LiPTaN2DzjNueWQ/sAAAAAElFTkSuQmCC",I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH2SURBVHgB7dzhTQJBEAXgp/G/duDZgR24HUAH0gFYAbECpALpBOxAK2A7wA5wN2siuT1NlrcHN+Z9ycTwC+55szfwYwAREREREREx5gJ1uFCjUDewwYd6C7XBmc1C7ULtjdY21CPOIN5pK9gMrasWOLEVbAfWVa84wjFn4KTjzT6RQn2HDQ7pOtqeQr2gZ1vk50gDexrk17JDz8bIb/0GdjXIH4IOBS5R5qH1eoU0Eljlka7h0AgFSgNsz3kb2PfRel00y5YGKC0KkKQASQqQpABJCpB0hXri4z/+OnOLYfOhlkhfP2k1A5yGmsOOZ1SgFibVvAOX338bDJvHz2el1QwwnilV2sIStTBJAZIUIElzIElzIEktTNIcSNIcSFILkxQgSQGSNAeSNAeS1MIkzYEkzYEktTBJAZIUIElzIElzIEktTNIcSNIcSFILkxQgSQGSLMyBHhXnttoszYGDfECphUkW5kCPinNbbZoDSWphkgIkKUCSAiSxAVrZE/OXaxBKA2wvlRjDPtd63eviDId8Z4KDXRPk13OPnq2Rb7qYwZ6urUtrFDpmb4z75Y080u0/yC/9B+K57dB9ft/hREs04n9v/89qjhOzvnjs8Aia4kwapDVQFoOMn3kB8sePWvsDowekc8XCbBh3xXgM/7wWERm0L8qIlOUlQCSkAAAAAElFTkSuQmCC",u={alt:"",draggable:!1,"aria-hidden":"true"},B=({className:h})=>d.jsx("img",{src:p,className:h,...u}),b=({className:h})=>d.jsx("img",{src:I,className:h,...u});export{B as A,b as B,k as t};
