import{E as ve,r as o,a as ue,g as je,j as e,X as se,Q as ne,B as _e,n as Ne,o as Se,t as oe,x as te,u as Ee,p as Ae,G as be,a9 as We,I as Te,w as Be,v as ze,d as Me,b as Ve,aa as ae,ab as Le}from"./index-pxHnjHjD.js";import De from"./tamilWordByWordService-CbdEWK98.js";import Ie from"./hindiWordByWordService-C4orOXOT.js";import Fe from"./banglaWordByWordService-CbmHEzxM.js";import{u as pe,T as re}from"./Toast-B6q433qJ.js";import{C as Ce}from"./chevron-left-BDDzhXoa.js";import Pe from"./tamilTranslationService-BXq1lve9.js";import de from"./hindiTranslationService-TIz5d7Jr.js";import ce from"./urduTranslationService-Devikl1b.js";import xe from"./banglaTranslationService-DREVDw9v.js";import ke from"./englishTranslationService-DbBUmdrl.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Re=ve("list",He);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"16",height:"18",x:"4",y:"4",rx:"2",key:"1u9h20"}],["path",{d:"M8 10h6",key:"3oa6kw"}],["path",{d:"M8 14h8",key:"1fgep2"}],["path",{d:"M8 18h5",key:"17enja"}]],qe=ve("notepad-text",Qe),me=({surahId:n,selectedVerse:p,surahInfo:N,onNavigate:y,onClose:L,onShowAyahModal:k,onSurahChange:l,onVerseChange:C,wordData:c=null,showSuccess:r=null,showError:w=null,translationLanguage:$=null})=>{const[Q,m]=o.useState(!0),[h,_]=o.useState([]),[v,q]=o.useState(!1),[E,F]=o.useState(!1),[P,b]=o.useState(!1),[H,z]=o.useState(!1),[W,U]=o.useState(""),A=o.useRef(null),T=o.useRef(null),D=ue(),{user:K}=je?.()||{user:null};N?.ayahs;const X=t=>{q(!1),U(""),l&&l(t.number)},O=t=>{F(!1),C&&C(t)},Y=()=>{const t=N?.ayahs||0;return Array.from({length:t},(d,s)=>s+1)},G=async()=>{try{b(!0);const t=te.getEffectiveUserId(K),d=N?.name||`Surah ${n}`,s=c?.text_uthmani||c?.translations?.[0]?.text||"";await te.addBookmark(t,n,p,"word-by-word",d,s),r&&r("Word-by-word content bookmarked successfully!")}catch(t){console.error("Failed to bookmark word-by-word content:",t),w&&w("Failed to save bookmark. Please try again.")}finally{setTimeout(()=>b(!1),300)}},x=async()=>{try{const t=N?.name||`Surah ${n}`,d=c?.text_uthmani||c?.translations?.[0]?.text||"",s=c?.translations?.[0]?.text||"";let g=`Word by Word - ${t}, Verse ${p}

`;g+=`Arabic: ${d}

`,s&&(g+=`Translation: ${s}

`),c?.words&&c.words.length>0&&(g+=`Word Breakdown:
`,c.words.slice(0,5).forEach((u,a)=>{const f=u.text_uthmani||u.text_simple||"",R=u.translation?.text||"N/A";g+=`${a+1}. ${f} - ${R}
`}),c.words.length>5&&(g+=`... and ${c.words.length-5} more words
`),g+=`
`),g+="Shared from Thafheem - Word by Word Study";const j=window.location.href;if(navigator.share)await navigator.share({title:`Word by Word - ${t}, Verse ${p}`,text:g,url:j});else{const u=`${g}

View full content: ${j}`;if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(u),alert("Word-by-word content copied to clipboard for sharing");else{const a=document.createElement("textarea");a.value=u,a.style.position="fixed",a.style.left="-999999px",a.style.top="-999999px",document.body.appendChild(a),a.focus(),a.select(),document.execCommand("copy"),document.body.removeChild(a),alert("Word-by-word content copied to clipboard for sharing")}}}catch(t){console.error("Failed to share word-by-word content:",t),t.name!=="AbortError"&&alert("Failed to share content: "+t.message)}};return o.useEffect(()=>{(async()=>{try{z(!0);const d=await oe();_(d)}catch(d){console.error("Error loading surahs:",d)}finally{z(!1)}})()},[]),o.useEffect(()=>{const t=d=>{A.current&&!A.current.contains(d.target)&&q(!1),T.current&&!T.current.contains(d.target)&&F(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),h.filter(t=>t.name.toLowerCase().includes(W.toLowerCase())||t.arabic.includes(W)||t.number.toString().includes(W)),Q?e.jsxs("div",{className:"bg-white dark:bg-gray-900 px-3 sm:px-4 py-3 space-y-3 relative z-10",children:[e.jsx("button",{className:"absolute top-2 right-2 sm:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors bg-white dark:bg-gray-600 shadow-sm z-10",title:"Close",onClick:()=>D(-1),children:e.jsx(se,{className:"w-4 h-4 text-gray-600 dark:text-white"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 sm:space-x-3 pr-12 sm:pr-0",children:[e.jsxs("div",{className:"relative dropdown-container",ref:A,children:[e.jsxs("button",{onClick:()=>q(!v),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsx("span",{children:n?`${n} - ${N?.name||"Loading..."}`:"Select Surah"}),e.jsx(ne,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),v&&!H&&e.jsx("div",{className:"absolute sm:text-sm text-sm top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-80 sm:w-45 h-[calc(100vh-100px)] z-50",children:h.map(t=>e.jsxs("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${t.number===parseInt(n)?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>X(t),children:[t.number," - ",t.name]},t.number))})]}),e.jsxs("div",{className:"relative dropdown-container",ref:T,children:[e.jsxs("button",{onClick:()=>F(!E),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsx("span",{children:p||"1"}),e.jsx(ne,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),E&&e.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-auto max-h-60 z-50",children:Y().map(t=>e.jsx("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${parseInt(p)===t?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>O(t),children:t},t))})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 self-end sm:self-auto",children:[$!=="ta"&&e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"View Ayah Details",onClick:()=>k&&k(p),children:e.jsx(_e,{className:"w-4 sm:w-5 h-4 sm:h-5 text-gray-600 dark:text-gray-300"})}),e.jsx("button",{onClick:G,disabled:P,className:`p-2 rounded-lg transition-colors ${P?"text-gray-400 cursor-not-allowed":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:P?"Saving...":"Bookmark this verse",children:e.jsx(Ne,{className:"w-4 sm:w-5 h-4 sm:h-5"})}),e.jsx("button",{onClick:x,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Share word-by-word content",children:e.jsx(Se,{className:"w-4 sm:w-5 h-4 sm:h-5 text-gray-600 dark:text-gray-300"})}),L&&e.jsx("button",{className:"hidden sm:block p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors dark:bg-white",title:"Close",onClick:L,children:e.jsx(se,{className:"w-5 h-5 text-gray-600"})})]})]})]}):null},he=({surahId:n,verseId:p,totalVerses:N,surahInfo:y,onVerseChange:L,onSurahChange:k,onClose:l,onWordByWordClick:C,verseData:c,selectedQari:r,onQariChange:w})=>{const[$,Q]=o.useState(!0),[m,h]=o.useState(!1),[_,v]=o.useState(!1),[q,E]=o.useState([]),[F,P]=o.useState(!0),[b,H]=o.useState(!1),[z,W]=o.useState(!1),U=ue(),{user:A}=je(),{showSuccess:T,showError:D}=pe();o.useEffect(()=>{(async()=>{try{const t=await oe();E(t)}catch(t){console.error("Error loading surahs:",t)}finally{P(!1)}})()},[]),o.useEffect(()=>{(async()=>{if(A&&n&&p)try{const t=await te.isBookmarked(A.uid,n,p,"interpretation");H(t)}catch(t){console.error("Error checking bookmark status:",t)}})()},[A,n,p]);const K=Array.from({length:N||10},(x,t)=>t+1),X=y?`${y.number} - ${y.name||y.arabic}`:`${n} - Loading...`,O=x=>{k?k(x):U(`/surah/${x}`),h(!1)},Y=x=>{L&&L(x),v(!1)},G=async()=>{if(!A){U("/sign");return}try{if(W(!0),b){const t=(await te.getBookmarks(A.uid,"interpretation")).find(d=>d.surahId===parseInt(n)&&d.verseId===parseInt(p));t&&(await te.deleteBookmark(t.id,A.uid),H(!1),T("Bookmark removed successfully"))}else{const x=y?.name||y?.arabic||`Surah ${n}`,t=c?.translation||c?.arabic||"";await te.addBookmark(A.uid,n,p,"interpretation",x,t),H(!0),T("Verse bookmarked successfully")}}catch(x){console.error("Error handling bookmark:",x),D("Failed to update bookmark. Please try again.")}finally{W(!1)}};return $?e.jsxs("div",{className:"bg-white dark:bg-gray-900 px-3 sm:px-4 py-3 space-y-3 relative",children:[e.jsx("button",{className:"absolute top-2 right-2 sm:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors bg-white dark:bg-gray-600 shadow-sm z-10",title:"Close",onClick:l||(()=>U(-1)),children:e.jsx(se,{className:"w-4 h-4 text-gray-600 dark:text-white"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 sm:space-x-3 pr-12 sm:pr-0",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>h(x=>!x),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsx("span",{children:X}),e.jsx(ne,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),m&&!F&&e.jsx("div",{className:"absolute sm:text-sm text-sm top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-80 sm:w-45 h-[calc(100vh-100px)] z-50",children:q.map(x=>e.jsxs("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${x.number===parseInt(n)?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>O(x.number),children:[x.number," - ",x.name]},x.number))})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>v(x=>!x),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsxs("span",{children:[" ",p]}),e.jsx(ne,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),_&&e.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-auto max-h-60 z-50",children:K.map(x=>e.jsx("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${x===parseInt(p)?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>Y(x),children:x},x))})]})]}),e.jsx("div",{className:"hidden sm:flex items-center",children:e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors dark:bg-gray-950",title:"Close",onClick:l||(()=>U(-1)),children:e.jsx(se,{className:"w-5 h-5 text-gray-600"})})})]}),e.jsxs("div",{className:"flex flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx("div",{className:"flex items-center gap-2"}),e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg  transition-colors",title:"Copy",children:e.jsx(qe,{className:"w-4 sm:w-5 h-4 sm:h-5 dark:text-white text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:b?"Remove Bookmark":"Add Bookmark",onClick:G,disabled:z,children:z?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 sm:h-5 sm:w-5 border-b border-current"}):e.jsx(Ne,{className:`w-4 sm:w-5 h-4 sm:h-5 transition-colors ${b?"text-cyan-500 fill-cyan-500 dark:text-cyan-400 dark:fill-cyan-400":"text-gray-600 dark:text-gray-300"}`})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Word by Word",onClick:()=>C&&C(p),children:e.jsx(Re,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Share",children:e.jsx(Se,{className:"w-4 sm:w-5 h-4 sm:h-5 text-gray-600 dark:text-gray-300"})})]})]})]}):null};let ge=null,we=0;const Ue=300*1e3,Oe=({surahId:n,verseId:p,onClose:N})=>{const{quranFont:y,fontSize:L,translationFontSize:k,translationLanguage:l}=Ee(),{toasts:C,removeToast:c}=pe(),[r,w]=o.useState(1),[$,Q]=o.useState(null),[m,h]=o.useState(null),[_,v]=o.useState(null),[q,E]=o.useState(!0),[F,P]=o.useState(null),[b,H]=o.useState(0),[z,W]=o.useState(!1),[U,A]=o.useState(null),[T,D]=o.useState("al-afasy"),[K,X]=o.useState("qirath");o.useEffect(()=>{p&&w(parseInt(p))},[p]),o.useEffect(()=>{let t=!1;return(async()=>{if(!(!n||!r))try{E(!0),P(null),v(null),h(null);const s=r,g=l==="mal"?be(parseInt(n),s,"mal").then(i=>i||[]).catch(i=>(console.error("❌ Error fetching Malayalam interpretations:",i),[])):l==="ta"?Pe.getAyahTranslation(parseInt(n),s).then(i=>i?[{interpretation:i,AudioIntrerptn:i,text:i,content:i}]:[]).catch(()=>[]):l==="hi"?de.getAllExplanations(parseInt(n),s).then(i=>i&&i.length>0?i.map(S=>({interpretation:S.explanation,AudioIntrerptn:S.explanation,text:S.explanation,content:S.explanation,explanation_no_BN:S.explanation_no_BN,explanation_no_EN:S.explanation_no_EN})):[]).catch(i=>(console.error("❌ Error fetching Hindi explanations in AyahModal:",i),[])):l==="ur"?ce.getAllExplanations(parseInt(n),s).then(i=>i&&i.length>0?i.map(I=>({interpretation:I.explanation,AudioIntrerptn:I.explanation,text:I.explanation,content:I.explanation,explanation_no:I.explanation_no})):[]).catch(()=>[]):l==="bn"?xe.getAllExplanations(parseInt(n),s).then(i=>i&&i.length>0?i.map(S=>({interpretation:S.explanation,AudioIntrerptn:S.explanation,text:S.explanation,content:S.explanation,explanation_no_BNG:S.explanation_no_BNG,explanation_no_EN:S.explanation_no_EN})):[]).catch(i=>(console.error("❌ Error fetching Bangla explanations in AyahModal:",i),[])):l==="E"?(async()=>{try{const i=await ke.getAyahTranslation(parseInt(n),s);if(!i)return[];const I=[],S=/<sup[^>]*foot_note="([^"]+)"[^>]*>(\d+)<\/sup>/g;let fe;for(;(fe=S.exec(i))!==null;){const B=fe[1];I.push(B)}if(I.length===0)return[];const $e=I.map(B=>fetch(`${We}/english/footnote/${B}`).then(ee=>ee.ok?ee.json().then(ie=>({footnote_id:B,text:ie.footnote_text,content:ie.footnote_text,explanation:ie.footnote_text})):null).catch(ee=>(console.error(`❌ Error fetching footnote ${B}:`,ee),null)));return(await Promise.all($e)).filter(B=>B!==null).map((B,ee)=>({interpretation:B.text,AudioIntrerptn:B.text,text:B.text,content:B.text,interptn_no:B.footnote_id||ee+1}))}catch(i){return console.error(`❌ [AyahModal] Error fetching English translation for verse ${s}:`,i),[]}})():(async()=>{try{return l==="mal"?await be(parseInt(n),s,"mal"):await Te(parseInt(n),s,1,l)}catch{return parseInt(n)===114,null}})(),j=l==="ta"||l==="hi"||l==="bn"||l==="E"?Promise.resolve(null):Be(parseInt(n),s),u=Date.now(),a=async()=>{if(ge&&u-we<Ue)return ge;const i=await oe();return ge=i,we=u,i},[f,R,J,M]=await Promise.all([a(),ze(parseInt(n)),j,g]);if(t)return;const V=f.find(i=>i.number===parseInt(n));Q(V||{arabic:"Unknown Surah",number:parseInt(n)}),H(V?.ayahs||0);const le=R.find(i=>i.verse_key===`${n}:${s}`),ye=J?Array.isArray(J)?J.find(i=>i.contiayano===s):J:null;let Z="";if(l==="E")try{Z=await ke.getAyahTranslation(parseInt(n),s),Z=Z?Z.replace(/<sup[^>]*foot_note[^>]*>\d+<\/sup>/g,"").replace(/\s+/g," ").trim():""}catch(i){console.error("Error fetching English translation:",i),Z=""}if(t||(h({number:s,arabic:le?.text_uthmani||"",translation:l==="E"?Z:ye?.AudioText?ye.AudioText.replace(/<sup[^>]*foot_note[^>]*>\d+<\/sup>/g,"").replace(/\s+/g," ").trim():"",verseKey:`${n}:${s}`}),t))return;M?Array.isArray(M)?v(M):M.data&&Array.isArray(M.data)?v(M.data):v(typeof M=="object"?[M]:null):v(null)}catch(s){if(t)return;P(s.message),console.error("Error fetching verse data:",s)}finally{if(t)return;E(!1)}})(),()=>{t=!0}},[n,r,l]),o.useEffect(()=>{const t=async d=>{d.preventDefault(),d.stopPropagation();const s=d.target.closest(".bangla-explanation-link");if(s){const g=s.getAttribute("data-explanation-number"),j=s.getAttribute("data-surah"),u=s.getAttribute("data-ayah");if(g&&j&&u)try{const a=await xe.getExplanationByNumber(parseInt(j),parseInt(u),g);alert(a?`Explanation ${g}:

${a}`:"Explanation not found.")}catch(a){console.error("❌ Error loading Bangla explanation:",a),alert("Error loading explanation.")}}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]),o.useEffect(()=>{const t=async d=>{d.preventDefault(),d.stopPropagation();const s=d.target.closest(".hindi-explanation-link");if(s){const g=s.getAttribute("data-explanation-number"),j=s.getAttribute("data-surah"),u=s.getAttribute("data-ayah");if(g&&j&&u)try{const a=await de.getExplanationByNumber(parseInt(j),parseInt(u),g);alert(a?`Explanation ${g}:

${a}`:`Explanation ${g} not found.`)}catch(a){console.error("❌ Error loading Hindi explanation:",a),alert("Error loading explanation.")}}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]),o.useEffect(()=>{const t=async d=>{d.preventDefault(),d.stopPropagation();const s=d.target.closest(".urdu-footnote-link");if(s){const g=s.getAttribute("data-footnote-id");s.getAttribute("data-footnote-number");const j=s.getAttribute("data-surah"),u=s.getAttribute("data-ayah");if(g&&j&&u)try{const a=await ce.getFootnoteExplanation(g);a&&a.trim()!==""&&a!=="Explanation not available"?(v([{interpretation:a,AudioIntrerptn:a,text:a,content:a}]),setShowInterpretationModal(!0)):showToast("Footnote explanation not available","warning")}catch(a){console.error("Error fetching Urdu footnote:",a),showToast("Failed to load footnote explanation","error")}}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]);const O=()=>{r<b&&w(r+1)},Y=()=>{r>1&&w(r-1)},G=t=>{W(!0)},x=()=>{W(!1)};return o.useEffect(()=>{if(z){const t=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}}},[z]),q?e.jsx("div",{className:"fixed inset-0 flex items-start justify-center z-[99999] pt-24 sm:pt-28 lg:pt-32 p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:e.jsxs("div",{className:"bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsx(he,{surahId:n,verseId:r,totalVerses:b,surahInfo:$,onVerseChange:w,onClose:N,onWordByWordClick:G,verseData:m,selectedQari:T,onQariChange:D}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading verse data..."})]})})]})}):F?e.jsx("div",{className:"fixed inset-0 flex items-start justify-center z-[99999] pt-24 sm:pt-28 lg:pt-32 p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:e.jsxs("div",{className:"bg-white dark:bg-[#2A2C38] rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsx(he,{surahId:n,verseId:r,totalVerses:b,surahInfo:$,onVerseChange:w,onClose:N,onWordByWordClick:G,verseData:m,selectedQari:T,onQariChange:D}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 dark:text-red-400 text-lg mb-2",children:"Failed to load verse data"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:F}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Try Again"})]})})]})}):e.jsxs("div",{className:"fixed inset-0 flex items-start justify-center z-[99999] pt-24 sm:pt-28 lg:pt-32 p-2 sm:p-4 lg:p-6 bg-gray-500/70 dark:bg-black/70 overflow-hidden",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsx(he,{surahId:n,verseId:r,totalVerses:b,surahInfo:$,onVerseChange:w,onClose:N,onWordByWordClick:G,verseData:m,selectedQari:T,onQariChange:D}),e.jsxs("div",{className:"px-3 sm:px-4 lg:px-6 py-4 sm:py-6 overflow-y-auto flex-1",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm sm:text-base font-medium text-gray-600 dark:text-gray-300",style:{fontFamily:y,fontSize:`${L}px`},children:$?.arabic||`Surah ${n}`}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Verse ",r," of ",b]})]})}),m&&e.jsx("div",{className:"text-right mb-4 sm:mb-6 border-b border-gray-200 dark:border-gray-600 pb-3 sm:pb-4",children:e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl dark:text-white text-gray-900 leading-loose px-2 sm:px-0",style:{fontFamily:y,fontSize:`${L}px`},children:m.arabic})}),m&&e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l==="hi"||l==="ur"||l==="bn"?"Explanation:":l==="E"?"Interpretation:":"Translation:"}),l==="bn"?e.jsx("div",{className:"text-gray-700 leading-[1.6] font-bengali sm:leading-[1.7] lg:leading-[1.8] dark:text-white px-2 sm:px-0",style:{fontSize:`${k}px`},dangerouslySetInnerHTML:{__html:xe.parseBanglaTranslationWithClickableExplanations(m.translation,parseInt(n),r)}}):l==="hi"?e.jsx("div",{className:"text-gray-700 leading-[1.6] font-hindi sm:leading-[1.7] lg:leading-[1.8] dark:text-white px-2 sm:px-0",style:{fontSize:`${k}px`},dangerouslySetInnerHTML:{__html:de.parseHindiTranslationWithClickableExplanations(m.translation,parseInt(n),r)}}):l==="ur"?e.jsx("div",{className:"text-gray-700 leading-[1.6] font-urdu sm:leading-[1.7] lg:leading-[1.8] dark:text-white px-2 sm:px-0",style:{fontSize:`${k}px`},dangerouslySetInnerHTML:{__html:ce.parseUrduTranslationWithClickableFootnotes(m.translation,parseInt(n),r)}}):l==="ta"?e.jsx("div",{className:"text-gray-700 leading-[1.6] font-tamil sm:leading-[1.7] lg:leading-[1.8] dark:text-white px-2 sm:px-0",style:{fontSize:`${k}px`},dangerouslySetInnerHTML:{__html:m.translation}}):e.jsx("p",{className:"text-gray-700 leading-[1.6] font-poppins sm:leading-[1.7] lg:leading-[1.8] dark:text-white px-2 sm:px-0",style:{fontSize:`${k}px`},children:m.translation})]}),(_&&_.length>0,null),_&&_.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}),e.jsx("div",{className:"space-y-3",children:_.map((t,d)=>{const g=[t.AudioIntrerptn,t.interpretation,t.Interpretation,t.text,t.content,t?.interpretation_text,t?.InterpretationText].find(u=>typeof u=="string"&&u.trim().length>0)||"No interpretation available",j=l==="hi"?t.explanation_no_BN||t.explanation_no_EN||d+1:l==="bn"?t.explanation_no_BNG||t.explanation_no_EN||d+1:l==="ur"?t.explanation_no||d+1:t.interptn_no||t.number||d+1;return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 sm:p-4",children:[(l==="hi"||l==="ur")&&e.jsxs("div",{className:"mb-2 text-sm font-medium text-cyan-600 dark:text-cyan-400",children:["Explanation ",j,":"]}),l==="E"&&e.jsxs("div",{className:"mb-2 text-sm font-medium text-cyan-600 dark:text-cyan-400",children:["Interpretation ",j,":"]}),e.jsx("p",{className:"text-gray-700 leading-[1.6] font-poppins sm:leading-[1.7] lg:leading-[1.8] dark:text-white text-xs sm:text-sm lg:text-base",style:{fontSize:`${k}px`},children:g})]},d)})})]}),(!_||_.length===0)&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Tafheem-ul-Quran (Interpretation):"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-950 rounded-lg p-3 sm:p-4",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm italic",children:parseInt(n)===114?"Interpretation data is not available for Surah An-Nas (114). This surah may not have interpretation content in the current database.":"No interpretation available for this verse. The interpretation API may be temporarily unavailable."})})]})]}),e.jsxs("div",{className:"flex justify-between gap-3 sm:gap-0 p-3 sm:p-4 bg-white dark:bg-gray-900",children:[e.jsxs("button",{onClick:Y,disabled:r<=1,className:`flex items-center justify-center sm:justify-start space-x-2 px-3 sm:px-4 py-2 rounded-lg border transition-colors group min-h-[44px] ${r<=1?"text-gray-400 dark:text-gray-500 cursor-not-allowed border-gray-200 dark:border-gray-600":"text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-300 dark:border-gray-500"}`,children:[e.jsx(Ce,{className:"w-3 h-3 sm:w-4 sm:h-4 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Previous Ayah"})]}),e.jsxs("button",{onClick:O,disabled:r>=b,className:`flex items-center justify-center sm:justify-start space-x-2 px-3 sm:px-4 py-2 rounded-lg border transition-colors group min-h-[44px] ${r>=b?"text-gray-400 dark:text-gray-500 cursor-not-allowed border-gray-200 dark:border-gray-600":"text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-300 dark:border-gray-500"}`,children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Next Ayah"}),e.jsx(Ae,{className:"w-3 h-3 sm:w-4 sm:h-4 group-hover:translate-x-1 transition-transform"})]})]})]}),z&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-start justify-center z-[99999] pt-24 sm:pt-28 lg:pt-32 p-4 overflow-hidden",children:e.jsx("div",{className:"bg-white dark:bg-[#2A2C38] rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col overflow-hidden",children:e.jsx("div",{className:"overflow-y-auto flex-1",children:e.jsx(Ge,{selectedVerse:r,surahId:n,onClose:x,onNavigate:w})})})}),e.jsx(re,{toasts:C,removeToast:c})]})},Ge=({selectedVerse:n,surahId:p,onClose:N,onNavigate:y,onSurahChange:L})=>{const k=Me(),l=ue(),C=Ve(),c=k.surahId||p,r=k.verseId?parseInt(k.verseId):n,{quranFont:w,fontSize:$,translationFontSize:Q,translationLanguage:m}=Ee(),[h,_]=o.useState(null),[v,q]=o.useState([]),[E,F]=o.useState(null),[P,b]=o.useState(!0),[H,z]=o.useState(null),[W,U]=o.useState(0),[A,T]=o.useState(!1),{toasts:D,removeToast:K,showSuccess:X,showError:O}=pe();o.useEffect(()=>{(async()=>{if(!(!r||!c))try{b(!0),z(null);const f=[m==="ta"?De.getWordByWordDataWithArabic(c,r).catch(async V=>(console.warn("Tamil word-by-word service failed, falling back to English:",V),await ae(c,r,"E"))):m==="hi"?Ie.getWordByWordDataWithArabic(c,r).catch(async V=>(console.warn("Hindi word-by-word service failed, falling back to English:",V),await ae(c,r,"E"))):m==="bn"?Fe.getWordByWordDataWithArabic(c,r).catch(async V=>(console.warn("Bangla word-by-word service failed, falling back to English:",V),await ae(c,r,"E"))):m!=="mal"?ae(c,r,m):Promise.resolve(null),Le(c,r).catch(()=>[]),E?Promise.resolve(E):oe().then(V=>V.find(le=>le.number===parseInt(c))).catch(()=>null)],[R,J,M]=await Promise.all(f);_(R),q(J||[]),F(M),U(M?.ayahs||0)}catch(f){z(f.message),console.error("Error fetching word data:",f)}finally{b(!1)}})()},[r,c,m]);const Y=()=>{r>1&&(y?y(r-1):l(`/word-by-word/${c}/${r-1}`,{state:C.state}))},G=()=>{y?y(r+1):l(`/word-by-word/${c}/${r+1}`,{state:C.state})},x=()=>{if(N)N();else{const a=C.state?.from;l(a&&a!=="/surah/all"&&a!=="/surah"?a:`/surah/${c}`)}},t=a=>{T(!0)},d=a=>{L?L(a):y?(N(),l(`/surah/${a}?wordByWord=1`)):l(`/word-by-word/${a}/1`,{state:C.state})},s=a=>{y?y(a):l(`/word-by-word/${c}/${a}`,{state:C.state})},g=()=>{T(!1)},u=(a=>{switch(a){case"mal":return"Malayalam";case"E":return"English";case"ta":return"Tamil";case"hi":return"Hindi";case"ur":return"Urdu";case"ar":return"Arabic";default:return"English"}})(m);return P?e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] h-[85vh] sm:h-[90vh] flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 z-10 bg-white dark:bg-gray-900",children:e.jsx(me,{surahId:c,selectedVerse:r,surahInfo:E,onNavigate:y,onClose:x,onShowAyahModal:t,onSurahChange:d,onVerseChange:s,wordData:h,showSuccess:X,showError:O,translationLanguage:m})}),e.jsx("div",{className:"flex-1 flex items-center justify-center px-6 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading word meanings..."})]})}),e.jsx(re,{toasts:D,removeToast:K})]}):H?e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] h-[85vh] sm:h-[90vh] flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 z-10 bg-white dark:bg-gray-900",children:e.jsx(me,{surahId:c,selectedVerse:r,surahInfo:E,onNavigate:y,onClose:x,onShowAyahModal:t,onSurahChange:d,onVerseChange:s,wordData:h,showSuccess:X,showError:O,translationLanguage:m})}),e.jsx("div",{className:"flex-1 flex items-center justify-center px-6 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 dark:text-red-400 mb-2",children:"Failed to load word meanings"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:H}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Retry"})]})}),e.jsx(re,{toasts:D,removeToast:K})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-xs sm:max-w-2xl lg:max-w-4xl xl:max-w-[1073px] h-[85vh] sm:h-[90vh] flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 z-10 bg-white dark:bg-gray-900",children:e.jsx(me,{surahId:c,selectedVerse:r,surahInfo:E,onNavigate:y,onClose:x,onShowAyahModal:t,onSurahChange:d,onVerseChange:s,wordData:h,showSuccess:X,showError:O,translationLanguage:m})}),e.jsxs("div",{className:"px-3 sm:px-4 lg:px-6 py-4 sm:py-6 overflow-y-auto flex-1 min-h-0",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm sm:text-base font-medium text-gray-600 dark:text-gray-300",style:{fontFamily:w,fontSize:`${$}px`},children:E?.arabic||`Surah ${c}`}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Verse ",r," of ",W]})]})}),h&&e.jsx("div",{className:"text-right mb-4 sm:mb-6 border-b border-gray-200 dark:border-gray-600 pb-3 sm:pb-4",children:e.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl dark:text-white text-gray-900 leading-loose px-2 sm:px-0",style:{fontFamily:w,fontSize:`${$}px`},children:[h.text_uthmani||h.words&&h.words.map(a=>a.text_uthmani||a.text_simple).join(" ")||"Verse text not available"," "]})}),h&&h.translations&&h.translations.length>0&&e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Translation:"}),e.jsx("p",{className:`text-gray-700 leading-[1.6] sm:leading-[1.7] lg:leading-[1.8] dark:text-white px-2 sm:px-0 ${m==="hi"?"font-hindi":m==="ur"?"font-urdu":m==="bn"?"font-bengali":m==="ta"?"font-tamil":m==="mal"?"font-malayalam":"font-poppins"}`,style:{fontSize:`${Q}px`},children:h.translations[0].text})]}),m!=="mal"&&h&&h.words&&h.words.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[m!=="bn"&&e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:["Word Breakdown (",u,"):"]}),e.jsx("div",{className:"space-y-3",children:h.words.map((a,f)=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 sm:p-4",children:e.jsxs("div",{className:"flex flex-row-reverse justify-between items-center",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl sm:text-3xl text-gray-700 dark:text-white font-arabic",style:{fontFamily:w,fontSize:`${$}px`},children:a.text_uthmani||a.text_simple||"N/A"}),a.text_simple&&a.text_uthmani!==a.text_simple&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:a.text_simple})]}),e.jsxs("div",{className:"text-left max-w-[60%]",children:[a.translation&&a.translation.text?e.jsx("p",{className:"text-gray-700 leading-[1.6] font-poppins sm:leading-[1.7] lg:leading-[1.8] dark:text-white mb-1",style:{fontSize:`${Q}px`},children:a.translation.text}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-1 italic",style:{fontSize:`${Q}px`},children:"Translation not available"}),a.class_name&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:a.class_name})]})]})},f))})]}),h&&(!h.words||h.words.length===0)&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Word Breakdown:"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 sm:p-4",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm italic",children:"Word-by-word breakdown not available for this verse."})})]}),m==="mal"&&v.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Word Breakdown (Malayalam):"}),e.jsx("div",{className:"space-y-3",children:v.reduce((f,R,J)=>(f.findIndex(V=>V.WordPhrase===R.WordPhrase)===-1&&f.push({...R,originalIndex:J}),f),[]).map((f,R)=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 sm:p-4",children:e.jsxs("div",{className:"flex flex-row-reverse justify-between items-center",children:[e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-lg font-arabic dark:text-white",style:{fontFamily:w,fontSize:`${$}px`},children:f.WordPhrase})}),e.jsx("div",{className:"text-left max-w-[60%]",children:e.jsx("span",{className:"text-gray-700 leading-[1.6] font-poppins sm:leading-[1.7] lg:leading-[1.8] dark:text-white font-malayalam",style:{fontSize:`${Q}px`},children:f.Meaning})})]})},`${f.WordPhrase}-${R}`))})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex justify-between gap-3 sm:gap-0 p-3 sm:p-4 bg-white dark:bg-gray-900 z-10",children:[e.jsxs("button",{onClick:Y,disabled:r<=1,className:`flex items-center justify-center sm:justify-start space-x-2 px-3 sm:px-4 py-2 rounded-lg border transition-colors group min-h-[44px] ${r<=1?"text-gray-400 dark:text-gray-500 cursor-not-allowed border-gray-200 dark:border-gray-600":"text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-300 dark:border-gray-500"}`,children:[e.jsx(Ce,{className:"w-3 h-3 sm:w-4 sm:h-4 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Previous Ayah"})]}),e.jsxs("button",{onClick:G,disabled:r>=W,className:`flex items-center justify-center sm:justify-start space-x-2 px-3 sm:px-4 py-2 rounded-lg border transition-colors group min-h-[44px] ${r>=W?"text-gray-400 dark:text-gray-500 cursor-not-allowed border-gray-200 dark:border-gray-600":"text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-300 dark:border-gray-500"}`,children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Next Ayah"}),e.jsx(Ae,{className:"w-3 h-3 sm:w-4 sm:h-4 group-hover:translate-x-1 transition-transform"})]})]}),A&&e.jsx(Oe,{surahId:c,verseId:r,onClose:g}),e.jsx(re,{toasts:D,removeToast:K})]})};export{Oe as A,Ge as W};
