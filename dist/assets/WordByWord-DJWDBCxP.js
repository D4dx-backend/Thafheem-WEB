import{H as ze,ac as Re,g as $e,j as e,X as he,W as ge,B as Le,r as Te,t as We,b as ue,y as le,u as Ie,v as Be,ad as qe,I as Ue,x as He,q as Ke,ae as ce,af as Oe}from"./index-CQnsQrCL.js";import{b as m,u as pe,c as ne,d as Qe,e as Ge}from"./react-vendor-v5ei6ytj.js";import Xe from"./tamilWordByWordService-hcBF0Oqj.js";import Je from"./hindiWordByWordService-D6d0WAux.js";import Ye from"./banglaWordByWordService-BYCbgXlT.js";import{a as re}from"./apiService-71VjOsf1.js";import{u as je,T as xe}from"./Toast-o5YPdajv.js";import{C as Me}from"./chevron-left-BOO1WfRR.js";import Ze from"./tamilTranslationService-r6I80Z9R.js";import fe from"./hindiTranslationService-BJ9PnWT5.js";import Ce from"./urduTranslationService-1ZXwZ4s1.js";import be from"./banglaTranslationService-4j8OZJ37.js";import ke from"./englishTranslationService-1HFCWZLV.js";import{g as et,s as tt}from"./surahNameUtils-CNmXwDjY.js";const at=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"16",height:"18",x:"4",y:"4",rx:"2",key:"1u9h20"}],["path",{d:"M8 10h6",key:"3oa6kw"}],["path",{d:"M8 14h8",key:"1fgep2"}],["path",{d:"M8 18h5",key:"17enja"}]],rt=ze("notepad-text",at);class nt{constructor(){this.language="malayalam",this.apiBasePath=Re,this.pendingRequests=new Map,this.cache=new Map,this.cacheEnabled=!0,this.cacheTtl=3e5}generateCacheKey(n,r){const a=Object.keys(r).sort().map(c=>`${c}=${r[c]}`).join("&");return`${n}${a?`?${a}`:""}`}isCacheValid(n){return Date.now()-n<this.cacheTtl}getCachedData(n){if(!this.cacheEnabled)return null;const r=this.cache.get(n);return r&&this.isCacheValid(r.timestamp)?r.data:(r&&this.cache.delete(n),null)}setCachedData(n,r){this.cacheEnabled&&this.cache.set(n,{data:r,timestamp:Date.now()})}async getAyahTranslation(n,r){const a=this.generateCacheKey("getAyahTranslation",{surahId:n,ayahNumber:r}),c=this.getCachedData(a);if(c)return c;if(this.pendingRequests.has(a))return this.pendingRequests.get(a);const g=this._getAyahTranslationInternal(n,r,a);this.pendingRequests.set(a,g);try{return await g}finally{this.pendingRequests.delete(a)}}async _getAyahTranslationInternal(n,r,a){try{const c=await re.getTranslation(this.language,n,r),g=c?.translation_text??c?.translation??null;return g?(this.setCachedData(a,g),g):(console.warn(`⚠️ No Malayalam translation returned for ${n}:${r}`),null)}catch(c){throw console.error(`❌ Malayalam translation API failed for ${n}:${r}:`,c),c}}async getSurahTranslations(n){const r=this.generateCacheKey("getSurahTranslations",{surahId:n}),a=this.getCachedData(r);if(a)return a;if(this.pendingRequests.has(r))return this.pendingRequests.get(r);const c=this._getSurahTranslationsInternal(n,r);this.pendingRequests.set(r,c);try{return await c}finally{this.pendingRequests.delete(r)}}async _getSurahTranslationsInternal(n,r){try{const a=await re.getSurahTranslations(this.language,n),c=Array.isArray(a?.translations)?a.translations.map(g=>({number:g.verse_number,ArabicText:"",Translation:g.translation_text??""})):[];return this.setCachedData(r,c),c}catch(a){throw console.error(`❌ Malayalam surah translation API failed for ${n}:`,a),a}}async getInterpretation(n,r,a=null){const c=this.generateCacheKey("getInterpretation",{surahId:n,ayahNumber:r,interpretationNo:a}),g=this.getCachedData(c);if(g)return g;if(this.pendingRequests.has(c))return this.pendingRequests.get(c);const s=this._getInterpretationInternal(n,r,a,c);this.pendingRequests.set(c,s);try{return await s}finally{this.pendingRequests.delete(c)}}async _getInterpretationInternal(n,r,a,c){try{const g=await re.getInterpretation(this.language,n,r,a),s=Array.isArray(g?.explanations)?g.explanations:[];return this.setCachedData(c,s),s}catch(g){throw console.error(`❌ Malayalam interpretation API failed for ${n}:${r}:`,g),g}}async getWordByWordData(n,r){const a=this.generateCacheKey("getWordByWordData",{surahId:n,ayahNumber:r}),c=this.getCachedData(a);if(c)return c;if(this.pendingRequests.has(a))return this.pendingRequests.get(a);const g=this._getWordByWordDataInternal(n,r,a);this.pendingRequests.set(a,g);try{return await g}finally{this.pendingRequests.delete(a)}}async _getWordByWordDataInternal(n,r,a){try{const c=await re.getWordByWord(this.language,n,r),g=Array.isArray(c?.words)?c.words:[];if(g.length===0)return console.warn(`⚠️ No Malayalam word-by-word data for ${n}:${r}`),null;const s=g.map((o,x)=>({id:o.WordId||o.id||x+1,position:o.WordId||o.id||x+1,audio_url:o.audio_url||null,char_type_name:o.char_type_name||"word",code_v1:o.code_v1||"",code_v2:o.code_v2||"",line_number:o.line_number||1,page_number:o.page_number||1,text_uthmani:o.text_uthmani||o.WordPhrase||"",text_simple:o.text_simple||o.WordPhrase||"",translation:{text:o.MalMeaning||o.WordMeaning||o.translation?.text||"",language_name:"Malayalam",resource_name:"Thafheem Malayalam Word Database"},transliteration:{text:o.transliteration?.text||o.WordPhrase||"",language_name:"English"}})),W={text_uthmani:c?.text_uthmani||"",words:s,translations:c?.translations||[]};return this.setCachedData(a,W),W}catch(c){throw console.error(`❌ Malayalam word-by-word API failed for ${n}:${r}:`,c),c}}async getWordByWordDataWithArabic(n,r){try{const a=await this.getWordByWordData(n,r);if(!a)return console.warn(`⚠️ No Malayalam data found for ${n}:${r}, falling back to English`),await this.getEnglishFallback(n,r);try{const c=await re.getArabicText(n,r);return{...a,text_uthmani:c.text_uthmani||a.text_uthmani,text_simple:c.text_simple||a.text_simple}}catch{console.warn("⚠️ Could not fetch Arabic text, using Malayalam data only")}return a}catch(a){throw console.error(`❌ Error fetching Malayalam word-by-word with Arabic for ${n}:${r}:`,a),a}}async getEnglishFallback(n,r){try{const a=await re.getWordByWord("english",n,r),c=Array.isArray(a?.words)?a.words:[];if(c.length===0)return null;const g=c.map((s,W)=>({id:s.WordId||s.id||W+1,position:s.WordId||s.id||W+1,text_uthmani:s.text_uthmani||s.WordPhrase||"",text_simple:s.text_simple||s.WordPhrase||"",translation:{text:s.EngMeaning||s.WordMeaning||s.translation?.text||"",language_name:"English",resource_name:"Thafheem English Word Database"}}));return{text_uthmani:a?.text_uthmani||"",words:g,translations:a?.translations||[]}}catch(a){return console.error(`❌ English fallback failed for ${n}:${r}:`,a),null}}async getFootnote(n){const r=this.generateCacheKey("getFootnote",{footnoteId:n}),a=this.getCachedData(r);if(a)return a;try{const g=(await re.getMalayalamFootnote(n))?.footnote_text||"";return this.setCachedData(r,g),g}catch(c){throw console.error(`❌ Malayalam footnote API failed for ${n}:`,c),c}}clearCache(){this.cache.clear(),this.pendingRequests.clear()}}const st=new nt,we=({surahId:S,selectedVerse:n,surahInfo:r,onNavigate:a,onClose:c,onShowAyahModal:g,onSurahChange:s,onVerseChange:W,wordData:o=null,showSuccess:x=null,showError:f=null,translationLanguage:G=null})=>{const[j,k]=m.useState(!0),[v,ee]=m.useState([]),[$,U]=m.useState(!1),[A,P]=m.useState(!1),[Z,X]=m.useState(!1),[H,R]=m.useState(!1),[T,te]=m.useState(""),K=m.useRef(null),L=m.useRef(null),q=pe(),{user:F}=$e?.()||{user:null};r?.ayahs;const J=h=>{U(!1),te(""),s&&s(h.number)},V=h=>{P(!1),W&&W(h)},O=()=>{const h=r?.ayahs||0;return Array.from({length:h},(_,I)=>I+1)},se=async()=>{try{X(!0);const h=le.getEffectiveUserId(F),_=r?.name||`Surah ${S}`,I=o?.text_uthmani||o?.translations?.[0]?.text||"";await le.addBookmark(h,S,n,"word-by-word",_,I),x&&x("Word-by-word content bookmarked successfully!")}catch(h){console.error("Failed to bookmark word-by-word content:",h),f&&f("Failed to save bookmark. Please try again.")}finally{setTimeout(()=>X(!1),300)}},oe=async()=>{try{const h=r?.name||`Surah ${S}`,_=o?.text_uthmani||o?.translations?.[0]?.text||"",I=o?.translations?.[0]?.text||"";let B=`Word by Word - ${h}, Verse ${n}

`;B+=`Arabic: ${_}

`,I&&(B+=`Translation: ${I}

`),o?.words&&o.words.length>0&&(B+=`Word Breakdown:
`,o.words.slice(0,5).forEach((l,y)=>{const i=l.text_uthmani||l.text_simple||"",b=l.translation?.text||"N/A";B+=`${y+1}. ${i} - ${b}
`}),o.words.length>5&&(B+=`... and ${o.words.length-5} more words
`),B+=`
`),B+="Shared from Thafheem - Word by Word Study";const ae=window.location.href;if(navigator.share)await navigator.share({title:`Word by Word - ${h}, Verse ${n}`,text:B,url:ae});else{const l=`${B}

View full content: ${ae}`;if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(l),alert("Word-by-word content copied to clipboard for sharing");else{const y=document.createElement("textarea");y.value=l,y.style.position="fixed",y.style.left="-999999px",y.style.top="-999999px",document.body.appendChild(y),y.focus(),y.select(),document.execCommand("copy"),document.body.removeChild(y),alert("Word-by-word content copied to clipboard for sharing")}}}catch(h){console.error("Failed to share word-by-word content:",h),h.name!=="AbortError"&&alert("Failed to share content: "+h.message)}};return m.useEffect(()=>{(async()=>{try{R(!0);const _=await ue();ee(_)}catch(_){console.error("Error loading surahs:",_)}finally{R(!1)}})()},[]),m.useEffect(()=>{const h=_=>{K.current&&!K.current.contains(_.target)&&U(!1),L.current&&!L.current.contains(_.target)&&P(!1)};return document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[]),v.filter(h=>h.name.toLowerCase().includes(T.toLowerCase())||h.arabic.includes(T)||h.number.toString().includes(T)),j?e.jsxs("div",{className:"bg-white dark:bg-gray-900 px-3 sm:px-4 py-3 space-y-3 relative z-10",children:[e.jsx("button",{className:"absolute top-2 right-2 sm:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors bg-white dark:bg-gray-600 shadow-sm z-10",title:"Close",onClick:()=>c?c():q(-1),children:e.jsx(he,{className:"w-4 h-4 text-gray-600 dark:text-white"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 sm:space-x-3 pr-12 sm:pr-0",children:[e.jsxs("div",{className:"relative dropdown-container",ref:K,children:[e.jsxs("button",{onClick:()=>U(!$),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsx("span",{children:S?`${S} - ${r?.name||"Loading..."}`:"Select Surah"}),e.jsx(ge,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),$&&!H&&e.jsx("div",{className:"absolute sm:text-sm text-sm top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-80 sm:w-45 h-[calc(100vh-100px)] z-50",children:v.map(h=>e.jsxs("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${h.number===parseInt(S)?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>J(h),children:[h.number," - ",h.name]},h.number))})]}),e.jsxs("div",{className:"relative dropdown-container",ref:L,children:[e.jsxs("button",{onClick:()=>P(!A),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsx("span",{children:n||"1"}),e.jsx(ge,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),A&&e.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-auto max-h-60 z-50",children:O().map(h=>e.jsx("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${parseInt(n)===h?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>V(h),children:h},h))})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 self-end sm:self-auto",children:[G!=="ta"&&e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"View Ayah Details",onClick:()=>g&&g(n),children:e.jsx(Le,{className:"w-4 sm:w-5 h-4 sm:h-5 text-gray-600 dark:text-gray-300"})}),e.jsx("button",{onClick:se,disabled:Z,className:`p-2 rounded-lg transition-colors ${Z?"text-gray-400 cursor-not-allowed":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:Z?"Saving...":"Bookmark this verse",children:e.jsx(Te,{className:"w-4 sm:w-5 h-4 sm:h-5"})}),e.jsx("button",{onClick:oe,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Share word-by-word content",children:e.jsx(We,{className:"w-4 sm:w-5 h-4 sm:h-5 text-gray-600 dark:text-gray-300"})}),c&&e.jsx("button",{className:"hidden sm:block p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors dark:bg-white",title:"Close",onClick:c,children:e.jsx(he,{className:"w-5 h-5 text-gray-600"})})]})]})]}):null},ve=({surahId:S,verseId:n,totalVerses:r,surahInfo:a,onVerseChange:c,onSurahChange:g,onClose:s,onWordByWordClick:W,verseData:o,interpretationData:x,selectedQari:f,onQariChange:G})=>{const[j,k]=m.useState(!0),[v,ee]=m.useState(!1),[$,U]=m.useState(!1),[A,P]=m.useState([]),[Z,X]=m.useState(!0),[H,R]=m.useState(!1),[T,te]=m.useState(!1),[K,L]=m.useState(!1),q=pe(),{user:F}=$e(),{showSuccess:J,showError:V}=je();m.useEffect(()=>{(async()=>{try{const y=await ue();P(y)}catch(y){console.error("Error loading surahs:",y)}finally{X(!1)}})()},[]),m.useEffect(()=>{(async()=>{if(F&&S&&n)try{const y=await le.isBookmarked(F.uid,S,n,"interpretation");R(y)}catch(y){console.error("Error checking bookmark status:",y)}})()},[F,S,n]);const O=Array.from({length:r||10},(l,y)=>y+1),se=a?`${a.number} - ${a.name||a.arabic}`:`${S} - Loading...`,oe=l=>{g?g(l):q(`/surah/${l}`),ee(!1)},h=l=>{c&&c(l),U(!1)},_=l=>{if(l==null)return"";if(typeof l!="string")return String(l);if(typeof window<"u"){const y=document.createElement("div");return y.innerHTML=l,y.textContent||y.innerText||""}return l.replace(/<[^>]+>/g," ")},I=l=>{if(!l||typeof l!="object")return"";const y=["AudioIntrerptn","Interpretation","interpretation","AudioText","interpret_text","InterpretText","Interpret_Text","text","Text","content","Content","meaning","Meaning","body","Body","desc","Desc","description","Description"];for(const i of y)if(typeof l[i]=="string"&&l[i].trim().length>0)return l[i];for(const[i,b]of Object.entries(l))if(typeof b=="string"&&b.trim().length>10&&!["InterpretationNo","Interpretation_No","interptn_no","contiayano","ayaid","Ayaid","suraid","pageid","QAudioUrl","TransUrl","InterPtnUrl","ASuraName"].includes(i))return b;return""},B=async()=>{if(!o&&!x){V("No data available to copy");return}try{const l=[];if(o?.arabic&&l.push(o.arabic),o?.translation&&l.push(o.translation),x){const i=[];if(Array.isArray(x))x.forEach((b,t)=>{if(typeof b=="string"&&b.trim().length>0){const p=_(b);if(p.trim()){const d=x.length>1?`Interpretation ${t+1}:
`:`Interpretation:
`;i.push(d+p.trim())}}else if(b&&typeof b=="object"){const p=I(b);if(p){const d=_(p);if(d.trim()){const w=x.length>1?`Interpretation ${t+1}:
`:`Interpretation:
`;i.push(w+d.trim())}}}});else if(typeof x=="string"){const b=_(x);b.trim()&&i.push(`Interpretation:
`+b.trim())}else if(typeof x=="object"){const b=I(x);if(b){const t=_(b);t.trim()&&i.push(`Interpretation:
`+t.trim())}}i.length>0?l.push(i.join(`

`)):console.warn("Interpretation data exists but no text extracted:",x)}if(l.length===0){const i=a?.name||a?.arabic||`Surah ${S}`;l.push(`${i}, Verse ${n}`)}const y=l.join(`

---

`);if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(y);else{const i=document.createElement("textarea");i.value=y,i.style.position="fixed",i.style.opacity="0",document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i)}L(!0),J("Verse and interpretation copied to clipboard"),setTimeout(()=>L(!1),2e3)}catch(l){console.error("Failed to copy verse:",l),V("Failed to copy verse. Please try again.")}},ae=async()=>{if(!F){q("/sign");return}try{if(te(!0),H){const y=(await le.getBookmarks(F.uid,"interpretation")).find(i=>i.surahId===parseInt(S)&&i.verseId===parseInt(n));y&&(await le.deleteBookmark(y.id,F.uid),R(!1),J("Bookmark removed successfully"))}else{const l=a?.name||a?.arabic||`Surah ${S}`,y=o?.translation||o?.arabic||"";await le.addBookmark(F.uid,S,n,"interpretation",l,y),R(!0),J("Verse bookmarked successfully")}}catch(l){console.error("Error handling bookmark:",l),V("Failed to update bookmark. Please try again.")}finally{te(!1)}};return j?e.jsxs("div",{className:"bg-white dark:bg-gray-900 px-3 sm:px-4 py-3 space-y-3 relative",children:[e.jsx("button",{className:"absolute top-2 right-2 sm:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors bg-white dark:bg-gray-600 shadow-sm z-10",title:"Close",onClick:s||(()=>q(-1)),children:e.jsx(he,{className:"w-4 h-4 text-gray-600 dark:text-white"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 sm:space-x-3 pr-12 sm:pr-0",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>ee(l=>!l),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsx("span",{children:se}),e.jsx(ge,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),v&&!Z&&e.jsx("div",{className:"absolute sm:text-sm text-sm top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-80 sm:w-45 h-[calc(100vh-100px)] z-50",children:A.map(l=>e.jsxs("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${l.number===parseInt(S)?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>oe(l.number),children:[l.number," - ",l.name]},l.number))})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>U(l=>!l),className:"flex font-poppins items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 dark:bg-[#323A3F] dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs sm:text-sm font-medium text-gray-700 transition-colors",children:[e.jsxs("span",{children:[" ",n]}),e.jsx(ge,{className:"w-4 h-4 text-gray-600 dark:text-white"})]}),$&&e.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white dark:bg-[#2A2C38] shadow-lg rounded-lg overflow-auto w-auto max-h-60 z-50",children:O.map(l=>e.jsx("div",{className:`px-4 py-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-white ${l===parseInt(n)?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>h(l),children:l},l))})]})]}),e.jsx("div",{className:"hidden sm:flex items-center",children:e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors dark:bg-gray-950",title:"Close",onClick:s||(()=>q(-1)),children:e.jsx(he,{className:"w-5 h-5 text-gray-600"})})})]}),e.jsxs("div",{className:"flex flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx("div",{className:"flex items-center gap-2"}),e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[e.jsx("button",{onClick:B,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors relative",title:"Copy",children:K?e.jsx("span",{className:"text-green-500 font-bold text-xs",children:"Copied!"}):e.jsx(rt,{className:"w-4 sm:w-5 h-4 sm:h-5 dark:text-white text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:H?"Remove Bookmark":"Add Bookmark",onClick:ae,disabled:T,children:T?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 sm:h-5 sm:w-5 border-b border-current"}):e.jsx(Te,{className:`w-4 sm:w-5 h-4 sm:h-5 transition-colors ${H?"text-cyan-500 fill-cyan-500 dark:text-cyan-400 dark:fill-cyan-400":"text-gray-600 dark:text-gray-300"}`})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Share",children:e.jsx(We,{className:"w-4 sm:w-5 h-4 sm:h-5 text-gray-600 dark:text-gray-300"})})]})]})]}):null};let Ne=null,Ee=0;const ot=300*1e3,it=({surahId:S,verseId:n,onClose:r})=>{const{quranFont:a,fontSize:c,adjustedTranslationFontSize:g,translationLanguage:s}=Ie(),{toasts:W,removeToast:o}=je(),x=pe(),[f,G]=m.useState(()=>{const t=parseInt(S,10);return Number.isNaN(t)?0:t}),[j,k]=m.useState(1),[v,ee]=m.useState(null),[$,U]=m.useState(null),[A,P]=m.useState(null),[Z,X]=m.useState(!0),[H,R]=m.useState(null),[T,te]=m.useState(0),[K,L]=m.useState(!1),q=t=>{if(!t||typeof t!="object")return null;const p=[t.ayaid,t.AyaId,t.AyaID,t.contiayano,t.contiAyaNo,t.verse_number,t.number];for(const d of p){const w=Number.parseInt(d,10);if(Number.isFinite(w)&&w>0)return w}return null},[F,J]=m.useState(null),[V,O]=m.useState("al-afasy"),[se,oe]=m.useState("qirath");m.useEffect(()=>{n&&k(parseInt(n))},[n]),m.useEffect(()=>{const t=parseInt(S,10);Number.isNaN(t)||G(t)},[S]),m.useEffect(()=>{let t=!1;return(async()=>{if(!(!f||!j))try{X(!0),R(null),P(null),U(null);const d=j,w=s==="mal",C=s==="mal"?(async()=>{try{const u=await qe(f,d,"mal");return u&&u.length>0?u.map(E=>({interpretation:E.Interpretation||"",AudioIntrerptn:E.Interpretation||"",text:E.Interpretation||"",content:E.Interpretation||"",InterpretationNo:E.InterpretationNo||String(E.resolvedInterpretationNo||1),interptn_no:E.resolvedInterpretationNo||parseInt(E.InterpretationNo||"1",10),number:E.resolvedInterpretationNo||parseInt(E.InterpretationNo||"1",10)})):[]}catch(u){return console.error(`[AyahModal] Error fetching Malayalam interpretations for Surah ${f}, Ayah ${d}:`,u),[]}})():s==="ta"?Ze.getAyahTranslation(f,d).then(u=>u?[{interpretation:u,AudioIntrerptn:u,text:u,content:u}]:[]).catch(()=>[]):s==="hi"?fe.getAllExplanations(f,d).then(u=>u&&u.length>0?u.map(M=>({interpretation:M.explanation,AudioIntrerptn:M.explanation,text:M.explanation,content:M.explanation,explanation_no_BN:M.explanation_no_BN,explanation_no_EN:M.explanation_no_EN})):[]).catch(u=>(console.error("❌ Error fetching Hindi explanations in AyahModal:",u),[])):s==="ur"?Ce.getAllExplanations(f,d).then(u=>u&&u.length>0?u.map(E=>({interpretation:E.explanation,AudioIntrerptn:E.explanation,text:E.explanation,content:E.explanation,explanation_no:E.explanation_no})):[]).catch(()=>[]):s==="bn"?be.getAllExplanations(f,d).then(u=>u&&u.length>0?u.map(M=>({interpretation:M.explanation,AudioIntrerptn:M.explanation,text:M.explanation,content:M.explanation,explanation_no_BNG:M.explanation_no_BNG,explanation_no_EN:M.explanation_no_EN})):[]).catch(u=>(console.error("❌ Error fetching Bangla explanations in AyahModal:",u),[])):s==="E"?(async()=>{try{const u=await ke.getAyahTranslation(f,d);if(!u)return[];const E=/<sup[^>]*foot_note="([^"]+)"[^>]*>(\d+)<\/sup>/g,M=[];let ye;for(;(ye=E.exec(u))!==null;){const z=ye[1],Y=parseInt(ye[2],10);M.push({footnoteId:z,footnoteNumber:Y})}const _e=Array.from(new Map(M.map(z=>[z.footnoteId,z])).values());_e.sort((z,Y)=>z.footnoteNumber-Y.footnoteNumber);const Ve=_e.map(async z=>{try{const Y=await ke.getExplanation(parseInt(z.footnoteId,10));return{interpretation:Y||"",AudioIntrerptn:Y||"",text:Y||"",content:Y||"",interptn_no:z.footnoteNumber,number:z.footnoteNumber,InterpretationNo:String(z.footnoteNumber),footnoteId:z.footnoteId}}catch(Y){return console.warn(`Failed to fetch footnote ${z.footnoteId}:`,Y),null}});return(await Promise.all(Ve)).filter(Boolean)}catch(u){return console.error(`❌ [AyahModal] Error fetching English footnotes for Surah ${f}, Ayah ${d}:`,u),[]}})():(async()=>{try{return await Ue(f,d,1,s)}catch(u){return console.error(`[AyahModal] Error fetching interpretations for Surah ${f}, Ayah ${d}:`,u),f===114?[]:[]}})(),D=s==="ta"||s==="hi"||s==="bn"||s==="E"||s==="ur"?Promise.resolve(null):He(f,d),N=Date.now(),de=async()=>{if(Ne&&N-Ee<ot)return Ne;const u=await ue();return Ne=u,Ee=N,u},[Pe,De,me,Q]=await Promise.all([de(),Ke(f),D,C]);if(console.log("[AyahModal] After Promise.all - interpretationResponse:",Q,"type:",typeof Q,"isArray:",Array.isArray(Q)),t)return;const Se=Pe.find(u=>u.number===f);ee(Se||{arabic:"Unknown Surah",number:f}),te(Se?.ayahs||0);const Fe=De.find(u=>u.verse_key===`${f}:${d}`),Ae=me?Array.isArray(me)?me.find(u=>q(u)===d):me:null;let ie="";if(s==="E")try{ie=await ke.getAyahTranslation(f,d),ie=ie?ie.replace(/<sup[^>]*foot_note[^>]*>\d+<\/sup>/g,"").replace(/\s+/g," ").trim():""}catch(u){console.error("Error fetching English translation:",u),ie=""}if(t||(U({number:d,arabic:Fe?.text_uthmani||"",translation:s==="E"?ie:Ae?.AudioText?Ae.AudioText.replace(/<sup[^>]*foot_note[^>]*>\d+<\/sup>/g,"").replace(/\s+/g," ").trim():"",verseKey:`${f}:${d}`}),t))return;Q?Array.isArray(Q)?P(Q):Q.data&&Array.isArray(Q.data)?P(Q.data):P(typeof Q=="object"?[Q]:null):P(null)}catch(d){if(t)return;R(d.message),console.error("Error fetching verse data:",d)}finally{if(t)return;X(!1)}})(),()=>{t=!0}},[f,j,s]),m.useEffect(()=>{const t=async p=>{p.preventDefault(),p.stopPropagation();const d=p.target.closest(".bangla-explanation-link");if(d){const w=d.getAttribute("data-explanation-number"),C=d.getAttribute("data-surah"),D=d.getAttribute("data-ayah");if(w&&C&&D)try{const N=await be.getExplanationByNumber(parseInt(C),parseInt(D),w);alert(N?`Explanation ${w}:

${N}`:"Explanation not found.")}catch(N){console.error("❌ Error loading Bangla explanation:",N),alert("Error loading explanation.")}}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]),m.useEffect(()=>{const t=async p=>{p.preventDefault(),p.stopPropagation();const d=p.target.closest(".hindi-explanation-link");if(d){const w=d.getAttribute("data-explanation-number"),C=d.getAttribute("data-surah"),D=d.getAttribute("data-ayah");if(w&&C&&D)try{const N=await fe.getExplanationByNumber(parseInt(C),parseInt(D),w);alert(N?`Explanation ${w}:

${N}`:`Explanation ${w} not found.`)}catch(N){console.error("❌ Error loading Hindi explanation:",N),alert("Error loading explanation.")}}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]),m.useEffect(()=>{const t=async p=>{p.preventDefault(),p.stopPropagation();const d=p.target.closest(".urdu-footnote-link");if(d){const w=d.getAttribute("data-footnote-id");d.getAttribute("data-footnote-number");const C=d.getAttribute("data-surah"),D=d.getAttribute("data-ayah");if(w&&C&&D)try{const N=await Ce.getFootnoteExplanation(w);N&&N.trim()!==""&&N!=="Explanation not available"?(P([{interpretation:N,AudioIntrerptn:N,text:N,content:N}]),setShowInterpretationModal(!0)):showToast("Footnote explanation not available","warning")}catch(N){console.error("Error fetching Urdu footnote:",N),showToast("Failed to load footnote explanation","error")}}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]);const h=()=>{j<T&&k(j+1)},_=()=>{j>1&&k(j-1)},I=t=>{L(!0)},B=()=>{L(!1)},ae=t=>{if(s!=="mal")return;const p=t.target.closest("sup, a");if(!p)return;const d=(p.innerText||p.textContent||"").trim();if(!d)return;let w=!1;const C=d.replace(/[\s()]+/g,"").toUpperCase();if(/^N\d+$/.test(C))w=!0,r&&r(),x(`/note/${C}`);else{const D=d.match(/(\d+)\s*[:：]\s*(\d+)/);if(D){const N=parseInt(D[1],10),de=parseInt(D[2],10);Number.isFinite(N)&&Number.isFinite(de)&&(w=!0,G(N),k(de))}}w&&(t.preventDefault(),t.stopPropagation())};m.useEffect(()=>{if(K){const t=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}}},[K]);const l=document.getElementById("modal-root")||document.body;if(Z)return ne.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm"}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:min-w-[600px] lg:min-w-[800px] max-w-4xl xl:max-w-[1073px] max-h-[85vh] sm:max-h-[90vh] flex flex-col bg-white dark:bg-gray-900 rounded-t-2xl sm:rounded-2xl shadow-2xl overflow-hidden animate-slideUp sm:animate-fadeIn",children:[e.jsx(ve,{surahId:f,verseId:j,totalVerses:T,surahInfo:v,onVerseChange:k,onClose:r,onWordByWordClick:I,verseData:$,interpretationData:A,selectedQari:V,onQariChange:O}),e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[300px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading verse data..."})]})})]})]}),l);if(H)return ne.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:min-w-[600px] max-w-4xl flex flex-col bg-white dark:bg-gray-900 rounded-t-2xl sm:rounded-2xl shadow-2xl overflow-hidden animate-slideUp sm:animate-fadeIn",children:[e.jsx(ve,{surahId:f,verseId:j,totalVerses:T,surahInfo:v,onVerseChange:k,onClose:r,onWordByWordClick:I,verseData:$,interpretationData:A,selectedQari:V,onQariChange:O}),e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[300px] p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 dark:text-red-400 text-lg mb-2",children:"Failed to load verse data"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:H}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Try Again"})]})})]})]}),l);const y=typeof s=="string"&&["e","en"].includes(s.toLowerCase()),i=v?.arabic||(f?`Surah ${f}`:"Surah"),b=et(f,i);return ne.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm transition-opacity",onClick:r}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:min-w-[600px] lg:min-w-[800px] max-w-4xl xl:max-w-[1073px] max-h-[85vh] sm:max-h-[90vh] flex flex-col bg-white dark:bg-gray-900 rounded-t-2xl sm:rounded-2xl shadow-2xl overflow-hidden animate-slideUp sm:animate-fadeIn",children:[e.jsx("div",{className:"sm:hidden w-full flex justify-center pt-3 pb-1 bg-white dark:bg-gray-900 border-b border-gray-100 dark:border-gray-800",onClick:r,children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full"})}),e.jsx(ve,{surahId:f,verseId:j,totalVerses:T,surahInfo:v,onVerseChange:k,onClose:r,onWordByWordClick:I,verseData:$,selectedQari:V,onQariChange:O}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-4 sm:py-6 overflow-y-auto flex-1 bg-gray-50/50 dark:bg-gray-900/50",children:[e.jsx("div",{className:"mb-4 sm:mb-6 text-center sm:text-left",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mb-3 gap-2",children:[e.jsx("h3",{className:"text-2xl sm:text-3xl font-medium text-gray-800 dark:text-gray-200",style:{fontFamily:tt},"aria-label":i,children:b}),e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 dark:bg-gray-800 text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400 border border-gray-200 dark:border-gray-700",children:["Verse ",j," of ",T]})]})}),$&&e.jsx("div",{className:"text-right mb-6 sm:mb-8 border-b border-gray-200 dark:border-gray-700 pb-6",children:e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl dark:text-white text-gray-900 leading-[2.2] px-2 sm:px-0",style:{fontFamily:a,fontSize:`${c}px`},dir:"rtl",children:$.arabic})}),$&&!y&&s!=="ur"&&e.jsx("div",{className:"mb-6 sm:mb-8",children:s==="bn"?e.jsx("div",{className:"text-gray-700 leading-[1.8] font-bengali dark:text-gray-200 px-2 sm:px-0 prose dark:prose-invert max-w-none",style:{fontSize:`${g}px`},dangerouslySetInnerHTML:{__html:be.parseBanglaTranslationWithClickableExplanations($.translation,f,j)}}):s==="hi"?e.jsx("div",{className:"text-gray-700 leading-[1.8] font-hindi dark:text-gray-200 px-2 sm:px-0 prose dark:prose-invert max-w-none",style:{fontSize:`${g}px`},dangerouslySetInnerHTML:{__html:fe.parseHindiTranslationWithClickableExplanations($.translation,f,j)}}):s==="ta"?e.jsx("div",{className:"text-gray-700 leading-[1.8] font-tamil dark:text-gray-200 px-2 sm:px-0 prose dark:prose-invert max-w-none",style:{fontSize:`${g}px`},dangerouslySetInnerHTML:{__html:$.translation}}):e.jsx("p",{className:"text-gray-700 leading-[1.8] font-poppins dark:text-gray-200 px-2 sm:px-0",style:{fontSize:`${g}px`},children:$.translation})}),(A&&A.length>0,null),A&&A.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsxs("h4",{className:"text-sm font-semibold uppercase tracking-wider text-primary dark:text-primary-light mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-[1px] bg-primary dark:bg-primary-light"}),"Tafheem-ul-Quran"]}),s==="mal"&&e.jsx("style",{children:`
                    .ayah-interpretation-content sup.f-intprno,
                    .ayah-interpretation-content sup.f-noteno,
                    .ayah-interpretation-content a.crs {
                      color: #0F766E !important;
                      cursor: pointer !important;
                      text-decoration: none !important;
                      font-weight: bold;
                    }
                    .dark .ayah-interpretation-content sup.f-intprno,
                    .dark .ayah-interpretation-content sup.f-noteno,
                    .dark .ayah-interpretation-content a.crs {
                      color: #14B8A6 !important;
                    }

                    .ayah-interpretation-content sup.f-intprno:hover,
                    .ayah-interpretation-content sup.f-noteno:hover,
                    .ayah-interpretation-content a.crs:hover {
                      text-decoration: underline !important;
                    }
                  `}),e.jsx("div",{className:"space-y-4 ayah-interpretation-content",onClick:ae,children:(s==="mal"?A.slice(0,1):A).map((t,p)=>{const w=[t.AudioIntrerptn,t.interpretation,t.Interpretation,t.text,t.content,t?.interpretation_text,t?.InterpretationText].find(N=>typeof N=="string"&&N.trim().length>0)||"No interpretation available",C=typeof w=="string"?w:String(w??""),D=s==="hi"?t.explanation_no_BN||t.explanation_no_EN||p+1:s==="bn"?t.explanation_no_BNG||t.explanation_no_EN||p+1:s==="ur"?t.explanation_no||p+1:y?t.interptn_no||t.number||p+1:t.resolvedInterpretationNo||t.InterpretationNo||t.Interpretation_No||t.interptn_no||t.number||t.requestedInterpretationNo||p+1;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(s==="hi"||s==="ur")&&e.jsxs("div",{className:"mb-3 text-sm font-bold text-primary dark:text-primary-light",children:["Explanation ",D,":"]}),y&&null,e.jsx("div",{className:"text-gray-700 leading-[1.8] font-poppins dark:text-gray-300 text-sm sm:text-base",style:{fontSize:`${g}px`},dangerouslySetInnerHTML:{__html:C}})]},p)})})]}),(!A||A.length===0)&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-3",children:"Interpretation"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-sm italic flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-gray-400"}),f===114?"Interpretation data is not available for Surah An-Nas (114).":"No interpretation available for this verse."]})})]})]}),e.jsxs("div",{className:"flex justify-between gap-3 p-4 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800",children:[e.jsxs("button",{onClick:_,disabled:j<=1,className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl border transition-all duration-200 group ${j<=1?"bg-gray-50 text-gray-400 border-gray-100 dark:bg-gray-800 dark:text-gray-600 dark:border-gray-700 cursor-not-allowed":"bg-white text-gray-700 border-gray-200 hover:border-primary hover:text-primary hover:bg-primary/5 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:hover:border-primary-light dark:hover:text-primary-light"}`,children:[e.jsx(Me,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:"Prev"})]}),e.jsxs("button",{onClick:h,disabled:j>=T,className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl border transition-all duration-200 group ${j>=T?"bg-gray-50 text-gray-400 border-gray-100 dark:bg-gray-800 dark:text-gray-600 dark:border-gray-700 cursor-not-allowed":"bg-primary text-white border-primary hover:bg-primary-dark shadow-lg shadow-primary/20 dark:bg-primary dark:border-primary dark:hover:bg-primary-dark"}`,children:[e.jsx("span",{className:"text-sm font-medium",children:"Next Ayah"}),e.jsx(Be,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})]})]}),K&&ne.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-start justify-center z-[100000] pt-24 sm:pt-28 lg:pt-32 p-4 overflow-hidden",children:e.jsx("div",{className:"bg-white dark:bg-[#2A2C38] rounded-xl shadow-2xl w-full sm:w-auto sm:max-w-6xl max-w-[95vw]",children:e.jsx(lt,{selectedVerse:j,surahId:f,onClose:B,onNavigate:k})})}),l),e.jsx(xe,{toasts:W,removeToast:o})]}),l)},lt=({selectedVerse:S,surahId:n,onClose:r,onNavigate:a,onSurahChange:c})=>{const g=Qe(),s=pe(),W=Ge(),o=g.surahId||n,x=g.verseId?parseInt(g.verseId):S,{quranFont:f,fontSize:G,adjustedTranslationFontSize:j,translationLanguage:k}=Ie(),[v,ee]=m.useState(null),[$,U]=m.useState([]),[A,P]=m.useState(null),[Z,X]=m.useState(!0),[H,R]=m.useState(null),[T,te]=m.useState(0),[K,L]=m.useState(!1),{toasts:q,removeToast:F,showSuccess:J,showError:V}=je(),O=document.getElementById("modal-root")||document.body;m.useEffect(()=>{(async()=>{if(!(!x||!o))try{X(!0),R(null);const b=[k==="ta"?Xe.getWordByWordDataWithArabic(o,x).catch(async w=>await ce(o,x,"E")):k==="hi"?Je.getWordByWordDataWithArabic(o,x).catch(async w=>await ce(o,x,"E")):k==="bn"?Ye.getWordByWordDataWithArabic(o,x).catch(async w=>await ce(o,x,"E")):k==="mal"?st.getWordByWordDataWithArabic(o,x).catch(async w=>await ce(o,x,"E")):ce(o,x,k),Oe(o,x).catch(()=>[]),A?Promise.resolve(A):ue().then(w=>w.find(C=>C.number===parseInt(o))).catch(()=>null)],[t,p,d]=await Promise.all(b);ee(t),U(p||[]),P(d),te(d?.ayahs||0)}catch(b){R(b.message)}finally{X(!1)}})()},[x,o,k]);const se=()=>{x>1&&(a?a(x-1):s(`/word-by-word/${o}/${x-1}`,{state:W.state}))},oe=()=>{a?a(x+1):s(`/word-by-word/${o}/${x+1}`,{state:W.state})},h=()=>{if(r)r();else{const i=W.state?.from;s(i&&i!=="/surah/all"&&i!=="/surah"?i:`/surah/${o}`)}},_=i=>{L(!0)},I=i=>{c?c(i):a?(r(),s(`/surah/${i}?wordByWord=1`)):s(`/word-by-word/${i}/1`,{state:W.state})},B=i=>{a?a(i):s(`/word-by-word/${o}/${i}`,{state:W.state})},ae=()=>{L(!1)},y=(i=>{switch(i){case"mal":return"Malayalam";case"E":return"English";case"ta":return"Tamil";case"hi":return"Hindi";case"ur":return"Urdu";case"ar":return"Arabic";default:return"English"}})(k);return Z?ne.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm"}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:min-w-[600px] lg:min-w-[800px] max-w-4xl xl:max-w-[1073px] max-h-[85vh] sm:max-h-[90vh] flex flex-col bg-white dark:bg-gray-900 rounded-t-2xl sm:rounded-2xl shadow-2xl overflow-hidden animate-slideUp sm:animate-fadeIn",children:[e.jsx("div",{className:"flex-shrink-0 z-10 bg-white dark:bg-gray-900",children:e.jsx(we,{surahId:o,selectedVerse:x,surahInfo:A,onNavigate:a,onClose:h,onShowAyahModal:_,onSurahChange:I,onVerseChange:B,wordData:v,showSuccess:J,showError:V,translationLanguage:k})}),e.jsx("div",{className:"flex-1 flex items-center justify-center px-6 py-8 min-h-[300px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading word meanings..."})]})}),e.jsx(xe,{toasts:q,removeToast:F})]})]}),O):H?ne.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm",onClick:h}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:min-w-[600px] lg:min-w-[800px] max-w-4xl xl:max-w-[1073px] max-h-[85vh] sm:max-h-[90vh] flex flex-col bg-white dark:bg-gray-900 rounded-t-2xl sm:rounded-2xl shadow-2xl overflow-hidden animate-slideUp sm:animate-fadeIn",children:[e.jsx("div",{className:"flex-shrink-0 z-10 bg-white dark:bg-gray-900",children:e.jsx(we,{surahId:o,selectedVerse:x,surahInfo:A,onNavigate:a,onClose:h,onShowAyahModal:_,onSurahChange:I,onVerseChange:B,wordData:v,showSuccess:J,showError:V,translationLanguage:k})}),e.jsx("div",{className:"flex-1 flex items-center justify-center px-6 py-8 min-h-[300px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 dark:text-red-400 mb-2",children:"Failed to load word meanings"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:H}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors",children:"Retry"})]})}),e.jsx(xe,{toasts:q,removeToast:F})]})]}),O):ne.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm transition-opacity",onClick:h}),e.jsxs("div",{className:"relative w-full sm:w-auto sm:min-w-[600px] lg:min-w-[800px] max-w-4xl xl:max-w-[1073px] max-h-[85vh] sm:max-h-[90vh] flex flex-col bg-white dark:bg-gray-900 rounded-t-2xl sm:rounded-2xl shadow-2xl overflow-hidden animate-slideUp sm:animate-fadeIn",children:[e.jsx("div",{className:"sm:hidden w-full flex justify-center pt-3 pb-1 bg-white dark:bg-gray-900 border-b border-gray-100 dark:border-gray-800",onClick:h,children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 dark:bg-gray-600 rounded-full"})}),e.jsx("div",{className:"flex-shrink-0 z-10 bg-white dark:bg-gray-900",children:e.jsx(we,{surahId:o,selectedVerse:x,surahInfo:A,onNavigate:a,onClose:h,onShowAyahModal:_,onSurahChange:I,onVerseChange:B,wordData:v,showSuccess:J,showError:V,translationLanguage:k})}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-4 sm:py-6 overflow-y-auto flex-1 bg-gray-50/50 dark:bg-gray-900/50",children:[e.jsx("div",{className:"mb-4 sm:mb-6 text-center sm:text-left",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mb-3 gap-2",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-medium text-gray-800 dark:text-gray-200",style:{fontFamily:f,fontSize:`${G}px`},children:A?.arabic||`Surah ${o}`}),e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 dark:bg-gray-800 text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400 border border-gray-200 dark:border-gray-700",children:["Verse ",x," of ",T]})]})}),v&&e.jsx("div",{className:"text-right mb-6 sm:mb-8 border-b border-gray-200 dark:border-gray-700 pb-6",children:e.jsxs("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl dark:text-white text-gray-900 leading-[2.2] px-2 sm:px-0",style:{fontFamily:f,fontSize:`${G}px`},dir:"rtl",children:[v.text_uthmani||v.words&&v.words.map(i=>i.text_uthmani||i.text_simple).join(" ")||"Verse text not available"," "]})}),v&&v.translations&&v.translations.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsxs("h4",{className:"text-sm font-semibold uppercase tracking-wider text-primary dark:text-primary-light mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-[1px] bg-primary dark:bg-primary-light"}),"Translation"]}),e.jsx("p",{className:`text-gray-700 leading-[1.8] dark:text-gray-200 px-2 sm:px-0 ${k==="hi"?"font-hindi":k==="ur"?"font-urdu":k==="bn"?"font-bengali":k==="ta"?"font-tamil":k==="mal"?"font-malayalam":"font-poppins"}`,style:{fontSize:`${j}px`},children:v.translations[0].text})]}),v&&v.words&&v.words.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[k!=="bn"&&e.jsxs("h4",{className:"text-sm font-semibold uppercase tracking-wider text-primary dark:text-primary-light mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-[1px] bg-primary dark:bg-primary-light"}),"Word Breakdown (",y,")"]}),e.jsx("div",{className:"space-y-4",children:v.words.map((i,b)=>{const t=i.text_uthmani||i.text_simple||"",p=!!(i.translation&&i.translation.text);return t&&/^[\s()\u0660-\u0669\u06F0-\u06F9\uFD3E\uFD3F0-9]+$/.test(t)&&!p?null:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-row-reverse justify-between items-center",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl sm:text-3xl text-gray-800 dark:text-white font-arabic",style:{fontFamily:f,fontSize:`${G}px`},children:i.text_uthmani||i.text_simple||"N/A"}),i.text_simple&&i.text_uthmani!==i.text_simple&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:i.text_simple})]}),e.jsxs("div",{className:"text-left max-w-[60%]",children:[p?e.jsx("p",{className:`text-gray-700 leading-[1.6] sm:leading-[1.7] lg:leading-[1.8] dark:text-gray-200 mb-1 font-medium ${k==="hi"?"font-hindi":k==="ur"?"font-urdu":k==="bn"?"font-bengali":k==="ta"?"font-tamil":k==="mal"?"font-malayalam":"font-poppins"}`,style:{fontSize:`${j}px`},children:i.translation.text}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-1 italic",style:{fontSize:`${j}px`},children:"Translation not available"}),i.class_name&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1 uppercase tracking-wide",children:i.class_name})]})]})},b)})})]}),v&&(!v.words||v.words.length===0)&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Word Breakdown:"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm italic",children:"Word-by-word breakdown not available for this verse."})})]}),k==="mal"&&(!v||!v.words||v.words.length===0)&&$&&$.length>0&&e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsxs("h4",{className:"text-sm font-semibold uppercase tracking-wider text-primary dark:text-primary-light mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-[1px] bg-primary dark:bg-primary-light"}),"Word Breakdown (Malayalam)"]}),e.jsx("div",{className:"space-y-4",children:$.reduce((b,t,p)=>{const d=t.WordPhrase||t.text_uthmani||t.text_simple||"";return b.findIndex(C=>(C.WordPhrase||C.text_uthmani||C.text_simple)===d)===-1&&b.push({...t,originalIndex:p}),b},[]).map((b,t)=>{const p=b.WordPhrase||b.text_uthmani||b.text_simple||"",d=b.Meaning||b.translation?.text||"";return e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-row-reverse justify-between items-center",children:[e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-2xl sm:text-3xl font-arabic dark:text-white text-gray-800",style:{fontFamily:f,fontSize:`${G}px`},children:p})}),e.jsx("div",{className:"text-left max-w-[60%]",children:e.jsx("span",{className:"text-gray-700 leading-[1.6] font-poppins sm:leading-[1.7] lg:leading-[1.8] dark:text-gray-200 font-malayalam font-medium",style:{fontSize:`${j}px`},children:d})})]})},`${p}-${t}`)})})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex justify-between gap-3 p-4 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 z-10",children:[e.jsxs("button",{onClick:se,disabled:x<=1,className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl border transition-all duration-200 group ${x<=1?"bg-gray-50 text-gray-400 border-gray-100 dark:bg-gray-800 dark:text-gray-600 dark:border-gray-700 cursor-not-allowed":"bg-white text-gray-700 border-gray-200 hover:border-primary hover:text-primary hover:bg-primary/5 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:hover:border-primary-light dark:hover:text-primary-light"}`,children:[e.jsx(Me,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:"Prev"})]}),e.jsxs("button",{onClick:oe,disabled:x>=T,className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl border transition-all duration-200 group ${x>=T?"bg-gray-50 text-gray-400 border-gray-100 dark:bg-gray-800 dark:text-gray-600 dark:border-gray-700 cursor-not-allowed":"bg-primary text-white border-primary hover:bg-primary-dark shadow-lg shadow-primary/20 dark:bg-primary dark:border-primary dark:hover:bg-primary-dark"}`,children:[e.jsx("span",{className:"text-sm font-medium",children:"Next Ayah"}),e.jsx(Be,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})]}),K&&e.jsx(it,{surahId:o,verseId:x,onClose:ae}),e.jsx(xe,{toasts:q,removeToast:F})]})]}),O)};export{it as A,lt as W};
