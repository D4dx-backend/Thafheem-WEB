import{ag as i,ae as h,ak as o,af as d}from"./index-pxHnjHjD.js";class l{constructor(){this.cache=new Map,this.requestQueue=new Map}generateCacheKey(e,t={}){const s=Object.keys(t).sort().map(a=>`${a}=${t[a]}`).join("&");return`${e}${s?`?${s}`:""}`}isCacheValid(e){return Date.now()-e<i}getCachedData(e){const t=this.cache.get(e);return t&&this.isCacheValid(t.timestamp)?t.data:(t&&this.cache.delete(e),null)}setCachedData(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}async makeRequest(e,t={},s={}){const a=this.generateCacheKey(e,t),n=this.getCachedData(a);if(n)return n;if(this.requestQueue.has(a))return this.requestQueue.get(a);const u=this._makeActualRequest(e,t,s);this.requestQueue.set(a,u);try{const r=await u;return this.setCachedData(a,r),r}finally{this.requestQueue.delete(a)}}async _makeActualRequest(e,t={},s={}){const a=h||`${o}/api/v1`,n=e.startsWith("/")?e:`/${e}`,u=new URL(`${a}${n}`);Object.keys(t).forEach(c=>{t[c]!==void 0&&t[c]!==null&&u.searchParams.append(c,t[c])});const r=await fetch(u.toString(),{method:"GET",headers:{"Content-Type":"application/json",...s.headers},...s});if(!r.ok){const c=await r.text();throw new Error(`API request failed: ${r.status} ${r.statusText} - ${c}`)}return await r.json()}async getTranslation(e,t,s){return this.makeRequest(`/${e}/translation/${t}/${s}`)}async getSurahTranslations(e,t){return this.makeRequest(`/${e}/surah/${t}`)}async getInterpretation(e,t,s,a=null){const n=a?{explanationNo:a}:{};return this.makeRequest(`/${e}/interpretation/${t}/${s}`,n)}async getWordByWord(e,t,s){return this.makeRequest(`/${e}/word-by-word/${t}/${s}`)}async getUrduFootnote(e){return this.makeRequest(`/urdu/footnote/${e}`)}async checkLanguageHealth(e){return this.makeRequest(`/${e}/health`)}clearCache(){this.cache.clear(),this.requestQueue.clear()}getCacheStats(){return{size:this.cache.size,queueSize:this.requestQueue.size,enabled:d,ttl:i}}}const m=new l;export{m as a};
